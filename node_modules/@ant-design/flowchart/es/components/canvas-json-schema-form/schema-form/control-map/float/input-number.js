import React, { useState, useEffect, useRef, useCallback } from 'react';
import { InputNumber as AInputNumber } from 'antd';
function transformValue(val) {
    var result = Number(val);
    return Number.isNaN(result) ? undefined : result;
}
export var InputNumber = function (props) {
    var disabled = props.disabled, placeholder = props.placeholder, value = props.value, onChange = props.onChange;
    var _a = useState(transformValue(value)), innerValue = _a[0], setInnerValue = _a[1];
    var mountedRef = useRef(false);
    useEffect(function () {
        if (!mountedRef.current) {
            mountedRef.current = true;
        }
        setInnerValue(transformValue(value));
    }, [value]);
    var onValueChange = useCallback(function (nextValue) {
        setInnerValue(nextValue);
        if (typeof onChange === 'function') {
            if (nextValue === undefined) {
                onChange('');
            }
            else if (typeof transformValue(nextValue) === 'number') {
                onChange(transformValue(nextValue));
            }
        }
    }, [onChange]);
    return (React.createElement(AInputNumber, { style: { width: '100%' }, size: "small", placeholder: placeholder, value: innerValue, onChange: onValueChange, disabled: disabled }));
};
