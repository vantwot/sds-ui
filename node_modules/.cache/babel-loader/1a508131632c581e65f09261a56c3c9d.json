{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { mix, isString } from '@antv/util';\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\nregisterNode('modelRect', {\n  // 自定义节点时的配置\n  options: {\n    size: [185, 70],\n    style: {\n      radius: 5,\n      stroke: '#69c0ff',\n      fill: '#ffffff',\n      lineWidth: Global.defaultNode.style.lineWidth,\n      fillOpacity: 1\n    },\n    // 文本样式配置\n    labelCfg: {\n      style: {\n        fill: '#595959',\n        fontSize: 14,\n        fontFamily: Global.windowFontFamily\n      },\n      offset: 30 // 距离左侧的 offset，没有设置 y 轴上移动的配置\n\n    },\n    descriptionCfg: {\n      style: {\n        fontSize: 12,\n        fill: '#bfbfbf',\n        fontFamily: Global.windowFontFamily\n      },\n      paddingTop: 0\n    },\n    preRect: {\n      show: true,\n      width: 4,\n      fill: '#40a9ff',\n      radius: 2\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: 10,\n      lineWidth: 1,\n      fill: '#72CC4A',\n      stroke: '#72CC4A'\n    },\n    // 节点中icon配置\n    logoIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: 0\n    },\n    // 节点中表示状态的icon配置\n    stateIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: -5\n    },\n    // 连接点，默认为左右\n    // anchorPoints: [{ x: 0, y: 0.5 }, { x: 1, y: 0.5 }]\n    anchorPoints: [[0, 0.5], [1, 0.5]]\n  },\n  shapeType: 'modelRect',\n  drawShape: function drawShape(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).preRect,\n        preRect = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = group.addShape('rect', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    group['shapeMap'][this.type + \"-keyShape\"] = keyShape;\n\n    var preRectShow = preRect.show,\n        preRectStyle = __rest(preRect, [\"show\"]);\n\n    if (preRectShow) {\n      group['shapeMap']['pre-rect'] = group.addShape('rect', {\n        attrs: __assign({\n          x: -width / 2,\n          y: -height / 2,\n          height: height\n        }, preRectStyle),\n        className: 'pre-rect',\n        name: 'pre-rect',\n        draggable: true\n      });\n    }\n\n    this.drawLogoIcon(cfg, group);\n    this.drawStateIcon(cfg, group);\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制模型矩形左边的logo图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLogoIcon: function drawLogoIcon(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).logoIcon,\n        logoIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (logoIcon.show) {\n      var w = logoIcon.width,\n          h = logoIcon.height,\n          x = logoIcon.x,\n          y = logoIcon.y,\n          offset = logoIcon.offset,\n          text = logoIcon.text,\n          logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\", \"text\"]);\n\n      if (text) {\n        group['shapeMap']['rect-logo-icon'] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, logoIconStyle),\n          className: 'rect-logo-icon',\n          name: 'rect-logo-icon',\n          draggable: true\n        });\n      } else {\n        group['shapeMap']['rect-logo-icon'] = group.addShape('image', {\n          attrs: __assign(__assign({}, logoIconStyle), {\n            x: x || -width / 2 + w + offset,\n            y: y || -h / 2,\n            width: w,\n            height: h\n          }),\n          className: 'rect-logo-icon',\n          name: 'rect-logo-icon',\n          draggable: true\n        });\n      }\n    }\n  },\n\n  /**\n   * 绘制模型矩形右边的状态图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawStateIcon: function drawStateIcon(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).stateIcon,\n        stateIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (stateIcon.show) {\n      var w = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          offset = stateIcon.offset,\n          text = stateIcon.text,\n          iconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\", \"text\"]);\n\n      if (text) {\n        group['shapeMap']['rect-state-icon'] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, iconStyle),\n          className: 'rect-state-icon',\n          name: 'rect-state-icon',\n          draggable: true\n        });\n      } else {\n        group['shapeMap']['rect-state-icon'] = group.addShape('image', {\n          attrs: __assign(__assign({}, iconStyle), {\n            x: x || width / 2 - w + offset,\n            y: y || -h / 2,\n            width: w,\n            height: h\n          }),\n          className: 'rect-state-icon',\n          name: 'rect-state-icon',\n          draggable: true\n        });\n      }\n    }\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        bottom = linkPoints.bottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"bottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (left) {\n      // left circle\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: -width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    if (right) {\n      // right circle\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    if (top) {\n      // top circle\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: -height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    if (bottom) {\n      // bottom circle\n      group['shapeMap']['link-point-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-bottom',\n        name: 'link-point-bottom',\n        isAnchorPoint: true\n      });\n    }\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var _a = this.getOptions(cfg),\n        _b = _a.labelCfg,\n        labelCfg = _b === void 0 ? {} : _b,\n        _c = _a.logoIcon,\n        logoIcon = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var label = null;\n    var show = logoIcon.show,\n        w = logoIcon.width;\n    var offsetX = -width / 2 + labelCfg.offset;\n\n    if (show) {\n      offsetX = -width / 2 + w + labelCfg.offset;\n    }\n\n    var fontStyle = labelCfg.style;\n    var descriptionStyle = descriptionCfg.style,\n        descriptionPaddingTop = descriptionCfg.paddingTop;\n\n    if (isString(cfg.description)) {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: -5,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group['shapeMap']['text-shape'] = label;\n      group['shapeMap']['rect-description'] = group.addShape('text', {\n        attrs: __assign(__assign({}, descriptionStyle), {\n          x: offsetX,\n          y: 17 + (descriptionPaddingTop || 0),\n          text: cfg.description\n        }),\n        className: 'rect-description',\n        name: 'rect-description',\n        draggable: true\n      });\n    } else {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: 7,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group['shapeMap']['text-shape'] = label;\n    }\n\n    return label;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = (this.mergeStyle || this.getOptions(cfg)).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖默认的stroke属性\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var size = this.getSize(cfg);\n    var width = style.width || size[0];\n    var height = style.height || size[1];\n\n    var styles = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var _a = this.mergeStyle || this.getOptions(cfg),\n        _b = _a.style,\n        style = _b === void 0 ? {} : _b,\n        _c = _a.labelCfg,\n        labelCfg = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign(__assign({}, style), {\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }));\n    var group = item.getContainer();\n    var logoIconShape = group['shapeMap']['rect-logo-icon'] || group.find(function (element) {\n      return element.get('className') === 'rect-logo-icon';\n    });\n    var currentLogoIconAttr = logoIconShape ? logoIconShape.attr() : {};\n    var logoIcon = mix({}, currentLogoIconAttr, cfg.logoIcon);\n    var w = logoIcon.width;\n\n    if (w === undefined) {\n      w = this.options.logoIcon.width;\n    }\n\n    var show = cfg.logoIcon ? cfg.logoIcon.show : undefined;\n    var offset = labelCfg.offset;\n    var offsetX = -width / 2 + w + offset;\n\n    if (!show && show !== undefined) {\n      offsetX = -width / 2 + offset;\n    }\n\n    var label = group['shapeMap']['node-label'] || group.find(function (element) {\n      return element.get('className') === 'node-label';\n    });\n    var description = group['shapeMap']['rect-description'] || group.find(function (element) {\n      return element.get('className') === 'rect-description';\n    });\n\n    if (cfg.label) {\n      if (!label) {\n        group['shapeMap']['node-label'] = group.addShape('text', {\n          attrs: __assign(__assign({}, labelCfg.style), {\n            x: offsetX,\n            y: cfg.description ? -5 : 7,\n            text: cfg.label\n          }),\n          className: 'node-label',\n          name: 'node-label',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.labelCfg ? cfg.labelCfg.style : {};\n        var labelStyle = mix({}, label.attr(), cfgStyle);\n        if (cfg.label) labelStyle.text = cfg.label;\n        labelStyle.x = offsetX;\n        if (isString(cfg.description)) labelStyle.y = -5;\n\n        if (description) {\n          description.resetMatrix();\n          description.attr({\n            x: offsetX\n          });\n        }\n\n        label.resetMatrix();\n        label.attr(labelStyle);\n      }\n    }\n\n    if (isString(cfg.description)) {\n      var paddingTop = descriptionCfg.paddingTop;\n\n      if (!description) {\n        group['shapeMap']['rect-description'] = group.addShape('text', {\n          attrs: __assign(__assign({}, descriptionCfg.style), {\n            x: offsetX,\n            y: 17 + (paddingTop || 0),\n            text: cfg.description\n          }),\n          className: 'rect-description',\n          name: 'rect-description',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.descriptionCfg ? cfg.descriptionCfg.style : {};\n        var descriptionStyle = mix({}, description.attr(), cfgStyle);\n        if (isString(cfg.description)) descriptionStyle.text = cfg.description;\n        descriptionStyle.x = offsetX;\n        description.resetMatrix();\n        description.attr(__assign(__assign({}, descriptionStyle), {\n          y: 17 + (paddingTop || 0)\n        }));\n      }\n    }\n\n    var preRectShape = group['shapeMap']['pre-rect'] || group.find(function (element) {\n      return element.get('className') === 'pre-rect';\n    });\n\n    if (preRectShape && !preRectShape.destroyed) {\n      var preRect = mix({}, preRectShape.attr(), cfg.preRect);\n      preRectShape.attr(__assign(__assign({}, preRect), {\n        x: -width / 2,\n        y: -height / 2,\n        height: height\n      }));\n    }\n\n    if (logoIconShape && !logoIconShape.destroyed) {\n      if (!show && show !== undefined) {\n        logoIconShape.remove();\n        delete group['shapeMap']['pre-rect'];\n      } else {\n        var logoW = logoIcon.width,\n            h = logoIcon.height,\n            x = logoIcon.x,\n            y = logoIcon.y,\n            logoOffset = logoIcon.offset,\n            logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n        logoIconShape.attr(__assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + logoW + logoOffset,\n          y: y || -h / 2,\n          width: logoW,\n          height: h\n        }));\n      }\n    } else if (show) {\n      this.drawLogoIcon(cfg, group);\n    }\n\n    var stateIconShape = group['shapeMap']['rect-state-icon'] || group.find(function (element) {\n      return element.get('className') === 'rect-state-icon';\n    });\n    var currentStateIconAttr = stateIconShape ? stateIconShape.attr() : {};\n    var stateIcon = mix({}, currentStateIconAttr, cfg.stateIcon);\n\n    if (stateIconShape) {\n      if (!stateIcon.show && stateIcon.show !== undefined) {\n        stateIconShape.remove();\n        delete group['shapeMap']['rect-state-icon'];\n      }\n\n      var stateW = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          stateOffset = stateIcon.offset,\n          stateIconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      stateIconShape.attr(__assign(__assign({}, stateIconStyle), {\n        x: x || width / 2 - stateW + stateOffset,\n        y: y || -h / 2,\n        width: stateW,\n        height: h\n      }));\n    } else if (stateIcon.show) {\n      this.drawStateIcon(cfg, group);\n    }\n\n    this.updateLinkPoints(cfg, group);\n  }\n}, 'single-node');","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@antv/g6-element/es/nodes/modelRect.js"],"names":["__assign","__rest","mix","isString","registerNode","BaseGlobal","Global","options","size","style","radius","stroke","fill","lineWidth","defaultNode","fillOpacity","labelCfg","fontSize","fontFamily","windowFontFamily","offset","descriptionCfg","paddingTop","preRect","show","width","linkPoints","top","right","bottom","left","logoIcon","x","y","img","height","stateIcon","anchorPoints","shapeType","drawShape","cfg","group","_a","mergeStyle","getOptions","getShapeStyle","getSize","keyShape","addShape","attrs","className","type","name","draggable","preRectShow","preRectStyle","drawLogoIcon","drawStateIcon","drawLinkPoints","w","h","text","logoIconStyle","textBaseline","textAlign","iconStyle","markSize","markR","r","markStyle","isAnchorPoint","drawLabel","_b","_c","_d","label","offsetX","fontStyle","descriptionStyle","descriptionPaddingTop","description","defaultStyle","strokeStyle","color","styles","update","item","get","attr","getContainer","logoIconShape","find","element","currentLogoIconAttr","undefined","cfgStyle","labelStyle","resetMatrix","preRectShape","destroyed","remove","logoW","logoOffset","stateIconShape","currentStateIconAttr","stateW","stateOffset","stateIconStyle","updateLinkPoints"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,MAAnB,QAAiC,OAAjC;AACA,SAASC,GAAT,EAAcC,QAAd,QAA8B,YAA9B;AACA,SAASC,YAAT,EAAuBC,UAAU,IAAIC,MAArC,QAAmD,eAAnD;AACAF,YAAY,CAAC,WAAD,EAAc;AACxB;AACAG,EAAAA,OAAO,EAAE;AACPC,IAAAA,IAAI,EAAE,CAAC,GAAD,EAAM,EAAN,CADC;AAEPC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAE,CADH;AAELC,MAAAA,MAAM,EAAE,SAFH;AAGLC,MAAAA,IAAI,EAAE,SAHD;AAILC,MAAAA,SAAS,EAAEP,MAAM,CAACQ,WAAP,CAAmBL,KAAnB,CAAyBI,SAJ/B;AAKLE,MAAAA,WAAW,EAAE;AALR,KAFA;AASP;AACAC,IAAAA,QAAQ,EAAE;AACRP,MAAAA,KAAK,EAAE;AACLG,QAAAA,IAAI,EAAE,SADD;AAELK,QAAAA,QAAQ,EAAE,EAFL;AAGLC,QAAAA,UAAU,EAAEZ,MAAM,CAACa;AAHd,OADC;AAMRC,MAAAA,MAAM,EAAE,EANA,CAMG;;AANH,KAVH;AAmBPC,IAAAA,cAAc,EAAE;AACdZ,MAAAA,KAAK,EAAE;AACLQ,QAAAA,QAAQ,EAAE,EADL;AAELL,QAAAA,IAAI,EAAE,SAFD;AAGLM,QAAAA,UAAU,EAAEZ,MAAM,CAACa;AAHd,OADO;AAMdG,MAAAA,UAAU,EAAE;AANE,KAnBT;AA2BPC,IAAAA,OAAO,EAAE;AACPC,MAAAA,IAAI,EAAE,IADC;AAEPC,MAAAA,KAAK,EAAE,CAFA;AAGPb,MAAAA,IAAI,EAAE,SAHC;AAIPF,MAAAA,MAAM,EAAE;AAJD,KA3BF;AAiCP;AACAgB,IAAAA,UAAU,EAAE;AACVC,MAAAA,GAAG,EAAE,KADK;AAEVC,MAAAA,KAAK,EAAE,KAFG;AAGVC,MAAAA,MAAM,EAAE,KAHE;AAIVC,MAAAA,IAAI,EAAE,KAJI;AAKV;AACAtB,MAAAA,IAAI,EAAE,EANI;AAOVK,MAAAA,SAAS,EAAE,CAPD;AAQVD,MAAAA,IAAI,EAAE,SARI;AASVD,MAAAA,MAAM,EAAE;AATE,KAlCL;AA6CP;AACAoB,IAAAA,QAAQ,EAAE;AACR;AACAP,MAAAA,IAAI,EAAE,IAFE;AAGRQ,MAAAA,CAAC,EAAE,CAHK;AAIRC,MAAAA,CAAC,EAAE,CAJK;AAKR;AACAC,MAAAA,GAAG,EAAE,yFANG;AAORT,MAAAA,KAAK,EAAE,EAPC;AAQRU,MAAAA,MAAM,EAAE,EARA;AASR;AACAf,MAAAA,MAAM,EAAE;AAVA,KA9CH;AA0DP;AACAgB,IAAAA,SAAS,EAAE;AACT;AACAZ,MAAAA,IAAI,EAAE,IAFG;AAGTQ,MAAAA,CAAC,EAAE,CAHM;AAITC,MAAAA,CAAC,EAAE,CAJM;AAKT;AACAC,MAAAA,GAAG,EAAE,yFANI;AAOTT,MAAAA,KAAK,EAAE,EAPE;AAQTU,MAAAA,MAAM,EAAE,EARC;AAST;AACAf,MAAAA,MAAM,EAAE,CAAC;AAVA,KA3DJ;AAuEP;AACA;AACAiB,IAAAA,YAAY,EAAE,CAAC,CAAC,CAAD,EAAI,GAAJ,CAAD,EAAW,CAAC,CAAD,EAAI,GAAJ,CAAX;AAzEP,GAFe;AA6ExBC,EAAAA,SAAS,EAAE,WA7Ea;AA8ExBC,EAAAA,SAAS,EAAE,SAASA,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;AACxC,QAAIC,EAAE,GAAG,CAAC,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAApB,EAA0CjB,OAAnD;AAAA,QACIA,OAAO,GAAGmB,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADnC;AAEA,QAAIjC,KAAK,GAAG,KAAKoC,aAAL,CAAmBL,GAAnB,CAAZ;AACA,QAAIhC,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;AACA,QAAI2B,MAAM,GAAG3B,IAAI,CAAC,CAAD,CAAjB;AACA,QAAIuC,QAAQ,GAAGN,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AACpCC,MAAAA,KAAK,EAAExC,KAD6B;AAEpCyC,MAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,WAFa;AAGpCC,MAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,WAHkB;AAIpCE,MAAAA,SAAS,EAAE;AAJyB,KAAvB,CAAf;AAMAZ,IAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,KAAKU,IAAL,GAAY,WAA9B,IAA6CJ,QAA7C;;AAEA,QAAIO,WAAW,GAAG/B,OAAO,CAACC,IAA1B;AAAA,QACI+B,YAAY,GAAGtD,MAAM,CAACsB,OAAD,EAAU,CAAC,MAAD,CAAV,CADzB;;AAGA,QAAI+B,WAAJ,EAAiB;AACfb,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,UAAlB,IAAgCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AACrDC,QAAAA,KAAK,EAAEjD,QAAQ,CAAC;AACdgC,UAAAA,CAAC,EAAE,CAACP,KAAD,GAAS,CADE;AAEdQ,UAAAA,CAAC,EAAE,CAACE,MAAD,GAAU,CAFC;AAGdA,UAAAA,MAAM,EAAEA;AAHM,SAAD,EAIZoB,YAJY,CADsC;AAMrDL,QAAAA,SAAS,EAAE,UAN0C;AAOrDE,QAAAA,IAAI,EAAE,UAP+C;AAQrDC,QAAAA,SAAS,EAAE;AAR0C,OAAvB,CAAhC;AAUD;;AAED,SAAKG,YAAL,CAAkBhB,GAAlB,EAAuBC,KAAvB;AACA,SAAKgB,aAAL,CAAmBjB,GAAnB,EAAwBC,KAAxB;AACA,SAAKiB,cAAL,CAAoBlB,GAApB,EAAyBC,KAAzB;AACA,WAAOM,QAAP;AACD,GAjHuB;;AAmHxB;AACF;AACA;AACA;AACA;AACES,EAAAA,YAAY,EAAE,SAASA,YAAT,CAAsBhB,GAAtB,EAA2BC,KAA3B,EAAkC;AAC9C,QAAIC,EAAE,GAAG,CAAC,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAApB,EAA0CT,QAAnD;AAAA,QACIA,QAAQ,GAAGW,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADpC;AAEA,QAAIlC,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;;AAEA,QAAIuB,QAAQ,CAACP,IAAb,EAAmB;AACjB,UAAImC,CAAC,GAAG5B,QAAQ,CAACN,KAAjB;AAAA,UACImC,CAAC,GAAG7B,QAAQ,CAACI,MADjB;AAAA,UAEIH,CAAC,GAAGD,QAAQ,CAACC,CAFjB;AAAA,UAGIC,CAAC,GAAGF,QAAQ,CAACE,CAHjB;AAAA,UAIIb,MAAM,GAAGW,QAAQ,CAACX,MAJtB;AAAA,UAKIyC,IAAI,GAAG9B,QAAQ,CAAC8B,IALpB;AAAA,UAMIC,aAAa,GAAG7D,MAAM,CAAC8B,QAAD,EAAW,CAAC,OAAD,EAAU,QAAV,EAAoB,GAApB,EAAyB,GAAzB,EAA8B,QAA9B,EAAwC,MAAxC,CAAX,CAN1B;;AAQA,UAAI8B,IAAJ,EAAU;AACRpB,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,gBAAlB,IAAsCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC3DC,UAAAA,KAAK,EAAEjD,QAAQ,CAAC;AACdgC,YAAAA,CAAC,EAAE,CADW;AAEdC,YAAAA,CAAC,EAAE,CAFW;AAGdhB,YAAAA,QAAQ,EAAE,EAHI;AAIdL,YAAAA,IAAI,EAAE,MAJQ;AAKdD,YAAAA,MAAM,EAAE,MALM;AAMdoD,YAAAA,YAAY,EAAE,QANA;AAOdC,YAAAA,SAAS,EAAE;AAPG,WAAD,EAQZF,aARY,CAD4C;AAU3DZ,UAAAA,SAAS,EAAE,gBAVgD;AAW3DE,UAAAA,IAAI,EAAE,gBAXqD;AAY3DC,UAAAA,SAAS,EAAE;AAZgD,SAAvB,CAAtC;AAcD,OAfD,MAeO;AACLZ,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,gBAAlB,IAAsCA,KAAK,CAACO,QAAN,CAAe,OAAf,EAAwB;AAC5DC,UAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK8D,aAAL,CAAT,EAA8B;AAC3C9B,YAAAA,CAAC,EAAEA,CAAC,IAAI,CAACP,KAAD,GAAS,CAAT,GAAakC,CAAb,GAAiBvC,MADkB;AAE3Ca,YAAAA,CAAC,EAAEA,CAAC,IAAI,CAAC2B,CAAD,GAAK,CAF8B;AAG3CnC,YAAAA,KAAK,EAAEkC,CAHoC;AAI3CxB,YAAAA,MAAM,EAAEyB;AAJmC,WAA9B,CAD6C;AAO5DV,UAAAA,SAAS,EAAE,gBAPiD;AAQ5DE,UAAAA,IAAI,EAAE,gBARsD;AAS5DC,UAAAA,SAAS,EAAE;AATiD,SAAxB,CAAtC;AAWD;AACF;AACF,GApKuB;;AAsKxB;AACF;AACA;AACA;AACA;AACEI,EAAAA,aAAa,EAAE,SAASA,aAAT,CAAuBjB,GAAvB,EAA4BC,KAA5B,EAAmC;AAChD,QAAIC,EAAE,GAAG,CAAC,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAApB,EAA0CJ,SAAnD;AAAA,QACIA,SAAS,GAAGM,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADrC;AAEA,QAAIlC,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;;AAEA,QAAI4B,SAAS,CAACZ,IAAd,EAAoB;AAClB,UAAImC,CAAC,GAAGvB,SAAS,CAACX,KAAlB;AAAA,UACImC,CAAC,GAAGxB,SAAS,CAACD,MADlB;AAAA,UAEIH,CAAC,GAAGI,SAAS,CAACJ,CAFlB;AAAA,UAGIC,CAAC,GAAGG,SAAS,CAACH,CAHlB;AAAA,UAIIb,MAAM,GAAGgB,SAAS,CAAChB,MAJvB;AAAA,UAKIyC,IAAI,GAAGzB,SAAS,CAACyB,IALrB;AAAA,UAMII,SAAS,GAAGhE,MAAM,CAACmC,SAAD,EAAY,CAAC,OAAD,EAAU,QAAV,EAAoB,GAApB,EAAyB,GAAzB,EAA8B,QAA9B,EAAwC,MAAxC,CAAZ,CANtB;;AAQA,UAAIyB,IAAJ,EAAU;AACRpB,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,iBAAlB,IAAuCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC5DC,UAAAA,KAAK,EAAEjD,QAAQ,CAAC;AACdgC,YAAAA,CAAC,EAAE,CADW;AAEdC,YAAAA,CAAC,EAAE,CAFW;AAGdhB,YAAAA,QAAQ,EAAE,EAHI;AAIdL,YAAAA,IAAI,EAAE,MAJQ;AAKdD,YAAAA,MAAM,EAAE,MALM;AAMdoD,YAAAA,YAAY,EAAE,QANA;AAOdC,YAAAA,SAAS,EAAE;AAPG,WAAD,EAQZC,SARY,CAD6C;AAU5Df,UAAAA,SAAS,EAAE,iBAViD;AAW5DE,UAAAA,IAAI,EAAE,iBAXsD;AAY5DC,UAAAA,SAAS,EAAE;AAZiD,SAAvB,CAAvC;AAcD,OAfD,MAeO;AACLZ,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,iBAAlB,IAAuCA,KAAK,CAACO,QAAN,CAAe,OAAf,EAAwB;AAC7DC,UAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKiE,SAAL,CAAT,EAA0B;AACvCjC,YAAAA,CAAC,EAAEA,CAAC,IAAIP,KAAK,GAAG,CAAR,GAAYkC,CAAZ,GAAgBvC,MADe;AAEvCa,YAAAA,CAAC,EAAEA,CAAC,IAAI,CAAC2B,CAAD,GAAK,CAF0B;AAGvCnC,YAAAA,KAAK,EAAEkC,CAHgC;AAIvCxB,YAAAA,MAAM,EAAEyB;AAJ+B,WAA1B,CAD8C;AAO7DV,UAAAA,SAAS,EAAE,iBAPkD;AAQ7DE,UAAAA,IAAI,EAAE,iBARuD;AAS7DC,UAAAA,SAAS,EAAE;AATkD,SAAxB,CAAvC;AAWD;AACF;AACF,GAvNuB;;AAyNxB;AACF;AACA;AACA;AACA;AACEK,EAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBlB,GAAxB,EAA6BC,KAA7B,EAAoC;AAClD,QAAIC,EAAE,GAAG,CAAC,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAApB,EAA0Cd,UAAnD;AAAA,QACIA,UAAU,GAAGgB,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADtC;;AAGA,QAAIf,GAAG,GAAGD,UAAU,CAACC,GAArB;AAAA,QACIG,IAAI,GAAGJ,UAAU,CAACI,IADtB;AAAA,QAEIF,KAAK,GAAGF,UAAU,CAACE,KAFvB;AAAA,QAGIC,MAAM,GAAGH,UAAU,CAACG,MAHxB;AAAA,QAIIqC,QAAQ,GAAGxC,UAAU,CAAClB,IAJ1B;AAAA,QAKI2D,KAAK,GAAGzC,UAAU,CAAC0C,CALvB;AAAA,QAMIC,SAAS,GAAGpE,MAAM,CAACyB,UAAD,EAAa,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyB,QAAzB,EAAmC,MAAnC,EAA2C,GAA3C,CAAb,CANtB;;AAQA,QAAIlB,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;AACA,QAAI2B,MAAM,GAAG3B,IAAI,CAAC,CAAD,CAAjB;;AAEA,QAAIsB,IAAJ,EAAU;AACR;AACAW,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,iBAAlB,IAAuCA,KAAK,CAACO,QAAN,CAAe,QAAf,EAAyB;AAC9DC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKqE,SAAL,CAAT,EAA0B;AACvCrC,UAAAA,CAAC,EAAE,CAACP,KAAD,GAAS,CAD2B;AAEvCQ,UAAAA,CAAC,EAAE,CAFoC;AAGvCmC,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CAD+C;AAM9DjB,QAAAA,SAAS,EAAE,iBANmD;AAO9DE,QAAAA,IAAI,EAAE,iBAPwD;AAQ9DkB,QAAAA,aAAa,EAAE;AAR+C,OAAzB,CAAvC;AAUD;;AAED,QAAI1C,KAAJ,EAAW;AACT;AACAa,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,kBAAlB,IAAwCA,KAAK,CAACO,QAAN,CAAe,QAAf,EAAyB;AAC/DC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKqE,SAAL,CAAT,EAA0B;AACvCrC,UAAAA,CAAC,EAAEP,KAAK,GAAG,CAD4B;AAEvCQ,UAAAA,CAAC,EAAE,CAFoC;AAGvCmC,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADgD;AAM/DjB,QAAAA,SAAS,EAAE,kBANoD;AAO/DE,QAAAA,IAAI,EAAE,kBAPyD;AAQ/DkB,QAAAA,aAAa,EAAE;AARgD,OAAzB,CAAxC;AAUD;;AAED,QAAI3C,GAAJ,EAAS;AACP;AACAc,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,gBAAlB,IAAsCA,KAAK,CAACO,QAAN,CAAe,QAAf,EAAyB;AAC7DC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKqE,SAAL,CAAT,EAA0B;AACvCrC,UAAAA,CAAC,EAAE,CADoC;AAEvCC,UAAAA,CAAC,EAAE,CAACE,MAAD,GAAU,CAF0B;AAGvCiC,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CAD8C;AAM7DjB,QAAAA,SAAS,EAAE,gBANkD;AAO7DE,QAAAA,IAAI,EAAE,gBAPuD;AAQ7DkB,QAAAA,aAAa,EAAE;AAR8C,OAAzB,CAAtC;AAUD;;AAED,QAAIzC,MAAJ,EAAY;AACV;AACAY,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,mBAAlB,IAAyCA,KAAK,CAACO,QAAN,CAAe,QAAf,EAAyB;AAChEC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKqE,SAAL,CAAT,EAA0B;AACvCrC,UAAAA,CAAC,EAAE,CADoC;AAEvCC,UAAAA,CAAC,EAAEE,MAAM,GAAG,CAF2B;AAGvCiC,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADiD;AAMhEjB,QAAAA,SAAS,EAAE,mBANqD;AAOhEE,QAAAA,IAAI,EAAE,mBAP0D;AAQhEkB,QAAAA,aAAa,EAAE;AARiD,OAAzB,CAAzC;AAUD;AACF,GArSuB;AAsSxBC,EAAAA,SAAS,EAAE,SAASA,SAAT,CAAmB/B,GAAnB,EAAwBC,KAAxB,EAA+B;AACxC,QAAIC,EAAE,GAAG,KAAKE,UAAL,CAAgBJ,GAAhB,CAAT;AAAA,QACIgC,EAAE,GAAG9B,EAAE,CAAC1B,QADZ;AAAA,QAEIA,QAAQ,GAAGwD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAFpC;AAAA,QAGIC,EAAE,GAAG/B,EAAE,CAACX,QAHZ;AAAA,QAIIA,QAAQ,GAAG0C,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAJpC;AAAA,QAKIC,EAAE,GAAGhC,EAAE,CAACrB,cALZ;AAAA,QAMIA,cAAc,GAAGqD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAN1C;;AAQA,QAAIlE,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;AACA,QAAImE,KAAK,GAAG,IAAZ;AACA,QAAInD,IAAI,GAAGO,QAAQ,CAACP,IAApB;AAAA,QACImC,CAAC,GAAG5B,QAAQ,CAACN,KADjB;AAEA,QAAImD,OAAO,GAAG,CAACnD,KAAD,GAAS,CAAT,GAAaT,QAAQ,CAACI,MAApC;;AAEA,QAAII,IAAJ,EAAU;AACRoD,MAAAA,OAAO,GAAG,CAACnD,KAAD,GAAS,CAAT,GAAakC,CAAb,GAAiB3C,QAAQ,CAACI,MAApC;AACD;;AAED,QAAIyD,SAAS,GAAG7D,QAAQ,CAACP,KAAzB;AACA,QAAIqE,gBAAgB,GAAGzD,cAAc,CAACZ,KAAtC;AAAA,QACIsE,qBAAqB,GAAG1D,cAAc,CAACC,UAD3C;;AAGA,QAAInB,QAAQ,CAACqC,GAAG,CAACwC,WAAL,CAAZ,EAA+B;AAC7BL,MAAAA,KAAK,GAAGlC,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC7BC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK6E,SAAL,CAAT,EAA0B;AACvC7C,UAAAA,CAAC,EAAE4C,OADoC;AAEvC3C,UAAAA,CAAC,EAAE,CAAC,CAFmC;AAGvC4B,UAAAA,IAAI,EAAErB,GAAG,CAACmC;AAH6B,SAA1B,CADc;AAM7BzB,QAAAA,SAAS,EAAE,YANkB;AAO7BE,QAAAA,IAAI,EAAE,YAPuB;AAQ7BC,QAAAA,SAAS,EAAE;AARkB,OAAvB,CAAR;AAUAZ,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,YAAlB,IAAkCkC,KAAlC;AACAlC,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,kBAAlB,IAAwCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC7DC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK8E,gBAAL,CAAT,EAAiC;AAC9C9C,UAAAA,CAAC,EAAE4C,OAD2C;AAE9C3C,UAAAA,CAAC,EAAE,MAAM8C,qBAAqB,IAAI,CAA/B,CAF2C;AAG9ClB,UAAAA,IAAI,EAAErB,GAAG,CAACwC;AAHoC,SAAjC,CAD8C;AAM7D9B,QAAAA,SAAS,EAAE,kBANkD;AAO7DE,QAAAA,IAAI,EAAE,kBAPuD;AAQ7DC,QAAAA,SAAS,EAAE;AARkD,OAAvB,CAAxC;AAUD,KAtBD,MAsBO;AACLsB,MAAAA,KAAK,GAAGlC,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC7BC,QAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK6E,SAAL,CAAT,EAA0B;AACvC7C,UAAAA,CAAC,EAAE4C,OADoC;AAEvC3C,UAAAA,CAAC,EAAE,CAFoC;AAGvC4B,UAAAA,IAAI,EAAErB,GAAG,CAACmC;AAH6B,SAA1B,CADc;AAM7BzB,QAAAA,SAAS,EAAE,YANkB;AAO7BE,QAAAA,IAAI,EAAE,YAPuB;AAQ7BC,QAAAA,SAAS,EAAE;AARkB,OAAvB,CAAR;AAUAZ,MAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,YAAlB,IAAkCkC,KAAlC;AACD;;AAED,WAAOA,KAAP;AACD,GAnWuB;;AAqWxB;AACF;AACA;AACA;AACA;AACE9B,EAAAA,aAAa,EAAE,SAASA,aAAT,CAAuBL,GAAvB,EAA4B;AACzC,QAAIyC,YAAY,GAAG,CAAC,KAAKtC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAApB,EAA0C/B,KAA7D;AACA,QAAIyE,WAAW,GAAG;AAChBvE,MAAAA,MAAM,EAAE6B,GAAG,CAAC2C;AADI,KAAlB,CAFyC,CAItC;;AAEH,QAAI1E,KAAK,GAAGP,GAAG,CAAC,EAAD,EAAK+E,YAAL,EAAmBC,WAAnB,CAAf;AACA,QAAI1E,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGhB,KAAK,CAACgB,KAAN,IAAejB,IAAI,CAAC,CAAD,CAA/B;AACA,QAAI2B,MAAM,GAAG1B,KAAK,CAAC0B,MAAN,IAAgB3B,IAAI,CAAC,CAAD,CAAjC;;AAEA,QAAI4E,MAAM,GAAGpF,QAAQ,CAAC;AACpBgC,MAAAA,CAAC,EAAE,CAACP,KAAD,GAAS,CADQ;AAEpBQ,MAAAA,CAAC,EAAE,CAACE,MAAD,GAAU,CAFO;AAGpBV,MAAAA,KAAK,EAAEA,KAHa;AAIpBU,MAAAA,MAAM,EAAEA;AAJY,KAAD,EAKlB1B,KALkB,CAArB;;AAOA,WAAO2E,MAAP;AACD,GA7XuB;AA8XxBC,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB7C,GAAhB,EAAqB8C,IAArB,EAA2B;AACjC,QAAI5C,EAAE,GAAG,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBJ,GAAhB,CAA5B;AAAA,QACIgC,EAAE,GAAG9B,EAAE,CAACjC,KADZ;AAAA,QAEIA,KAAK,GAAG+D,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAFjC;AAAA,QAGIC,EAAE,GAAG/B,EAAE,CAAC1B,QAHZ;AAAA,QAIIA,QAAQ,GAAGyD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAJpC;AAAA,QAKIC,EAAE,GAAGhC,EAAE,CAACrB,cALZ;AAAA,QAMIA,cAAc,GAAGqD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAN1C;;AAQA,QAAIlE,IAAI,GAAG,KAAKsC,OAAL,CAAaN,GAAb,CAAX;AACA,QAAIf,KAAK,GAAGjB,IAAI,CAAC,CAAD,CAAhB;AACA,QAAI2B,MAAM,GAAG3B,IAAI,CAAC,CAAD,CAAjB;AACA,QAAIuC,QAAQ,GAAGuC,IAAI,CAACC,GAAL,CAAS,UAAT,CAAf;AACAxC,IAAAA,QAAQ,CAACyC,IAAT,CAAcxF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKS,KAAL,CAAT,EAAsB;AAC1CuB,MAAAA,CAAC,EAAE,CAACP,KAAD,GAAS,CAD8B;AAE1CQ,MAAAA,CAAC,EAAE,CAACE,MAAD,GAAU,CAF6B;AAG1CV,MAAAA,KAAK,EAAEA,KAHmC;AAI1CU,MAAAA,MAAM,EAAEA;AAJkC,KAAtB,CAAtB;AAMA,QAAIM,KAAK,GAAG6C,IAAI,CAACG,YAAL,EAAZ;AACA,QAAIC,aAAa,GAAGjD,KAAK,CAAC,UAAD,CAAL,CAAkB,gBAAlB,KAAuCA,KAAK,CAACkD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AACvF,aAAOA,OAAO,CAACL,GAAR,CAAY,WAAZ,MAA6B,gBAApC;AACD,KAF0D,CAA3D;AAGA,QAAIM,mBAAmB,GAAGH,aAAa,GAAGA,aAAa,CAACF,IAAd,EAAH,GAA0B,EAAjE;AACA,QAAIzD,QAAQ,GAAG7B,GAAG,CAAC,EAAD,EAAK2F,mBAAL,EAA0BrD,GAAG,CAACT,QAA9B,CAAlB;AACA,QAAI4B,CAAC,GAAG5B,QAAQ,CAACN,KAAjB;;AAEA,QAAIkC,CAAC,KAAKmC,SAAV,EAAqB;AACnBnC,MAAAA,CAAC,GAAG,KAAKpD,OAAL,CAAawB,QAAb,CAAsBN,KAA1B;AACD;;AAED,QAAID,IAAI,GAAGgB,GAAG,CAACT,QAAJ,GAAeS,GAAG,CAACT,QAAJ,CAAaP,IAA5B,GAAmCsE,SAA9C;AACA,QAAI1E,MAAM,GAAGJ,QAAQ,CAACI,MAAtB;AACA,QAAIwD,OAAO,GAAG,CAACnD,KAAD,GAAS,CAAT,GAAakC,CAAb,GAAiBvC,MAA/B;;AAEA,QAAI,CAACI,IAAD,IAASA,IAAI,KAAKsE,SAAtB,EAAiC;AAC/BlB,MAAAA,OAAO,GAAG,CAACnD,KAAD,GAAS,CAAT,GAAaL,MAAvB;AACD;;AAED,QAAIuD,KAAK,GAAGlC,KAAK,CAAC,UAAD,CAAL,CAAkB,YAAlB,KAAmCA,KAAK,CAACkD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC3E,aAAOA,OAAO,CAACL,GAAR,CAAY,WAAZ,MAA6B,YAApC;AACD,KAF8C,CAA/C;AAGA,QAAIP,WAAW,GAAGvC,KAAK,CAAC,UAAD,CAAL,CAAkB,kBAAlB,KAAyCA,KAAK,CAACkD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AACvF,aAAOA,OAAO,CAACL,GAAR,CAAY,WAAZ,MAA6B,kBAApC;AACD,KAF0D,CAA3D;;AAIA,QAAI/C,GAAG,CAACmC,KAAR,EAAe;AACb,UAAI,CAACA,KAAL,EAAY;AACVlC,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,YAAlB,IAAkCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AACvDC,UAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKgB,QAAQ,CAACP,KAAd,CAAT,EAA+B;AAC5CuB,YAAAA,CAAC,EAAE4C,OADyC;AAE5C3C,YAAAA,CAAC,EAAEO,GAAG,CAACwC,WAAJ,GAAkB,CAAC,CAAnB,GAAuB,CAFkB;AAG5CnB,YAAAA,IAAI,EAAErB,GAAG,CAACmC;AAHkC,WAA/B,CADwC;AAMvDzB,UAAAA,SAAS,EAAE,YAN4C;AAOvDE,UAAAA,IAAI,EAAE,YAPiD;AAQvDC,UAAAA,SAAS,EAAE;AAR4C,SAAvB,CAAlC;AAUD,OAXD,MAWO;AACL,YAAI0C,QAAQ,GAAGvD,GAAG,CAACxB,QAAJ,GAAewB,GAAG,CAACxB,QAAJ,CAAaP,KAA5B,GAAoC,EAAnD;AACA,YAAIuF,UAAU,GAAG9F,GAAG,CAAC,EAAD,EAAKyE,KAAK,CAACa,IAAN,EAAL,EAAmBO,QAAnB,CAApB;AACA,YAAIvD,GAAG,CAACmC,KAAR,EAAeqB,UAAU,CAACnC,IAAX,GAAkBrB,GAAG,CAACmC,KAAtB;AACfqB,QAAAA,UAAU,CAAChE,CAAX,GAAe4C,OAAf;AACA,YAAIzE,QAAQ,CAACqC,GAAG,CAACwC,WAAL,CAAZ,EAA+BgB,UAAU,CAAC/D,CAAX,GAAe,CAAC,CAAhB;;AAE/B,YAAI+C,WAAJ,EAAiB;AACfA,UAAAA,WAAW,CAACiB,WAAZ;AACAjB,UAAAA,WAAW,CAACQ,IAAZ,CAAiB;AACfxD,YAAAA,CAAC,EAAE4C;AADY,WAAjB;AAGD;;AAEDD,QAAAA,KAAK,CAACsB,WAAN;AACAtB,QAAAA,KAAK,CAACa,IAAN,CAAWQ,UAAX;AACD;AACF;;AAED,QAAI7F,QAAQ,CAACqC,GAAG,CAACwC,WAAL,CAAZ,EAA+B;AAC7B,UAAI1D,UAAU,GAAGD,cAAc,CAACC,UAAhC;;AAEA,UAAI,CAAC0D,WAAL,EAAkB;AAChBvC,QAAAA,KAAK,CAAC,UAAD,CAAL,CAAkB,kBAAlB,IAAwCA,KAAK,CAACO,QAAN,CAAe,MAAf,EAAuB;AAC7DC,UAAAA,KAAK,EAAEjD,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKqB,cAAc,CAACZ,KAApB,CAAT,EAAqC;AAClDuB,YAAAA,CAAC,EAAE4C,OAD+C;AAElD3C,YAAAA,CAAC,EAAE,MAAMX,UAAU,IAAI,CAApB,CAF+C;AAGlDuC,YAAAA,IAAI,EAAErB,GAAG,CAACwC;AAHwC,WAArC,CAD8C;AAM7D9B,UAAAA,SAAS,EAAE,kBANkD;AAO7DE,UAAAA,IAAI,EAAE,kBAPuD;AAQ7DC,UAAAA,SAAS,EAAE;AARkD,SAAvB,CAAxC;AAUD,OAXD,MAWO;AACL,YAAI0C,QAAQ,GAAGvD,GAAG,CAACnB,cAAJ,GAAqBmB,GAAG,CAACnB,cAAJ,CAAmBZ,KAAxC,GAAgD,EAA/D;AACA,YAAIqE,gBAAgB,GAAG5E,GAAG,CAAC,EAAD,EAAK8E,WAAW,CAACQ,IAAZ,EAAL,EAAyBO,QAAzB,CAA1B;AACA,YAAI5F,QAAQ,CAACqC,GAAG,CAACwC,WAAL,CAAZ,EAA+BF,gBAAgB,CAACjB,IAAjB,GAAwBrB,GAAG,CAACwC,WAA5B;AAC/BF,QAAAA,gBAAgB,CAAC9C,CAAjB,GAAqB4C,OAArB;AACAI,QAAAA,WAAW,CAACiB,WAAZ;AACAjB,QAAAA,WAAW,CAACQ,IAAZ,CAAiBxF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK8E,gBAAL,CAAT,EAAiC;AACxD7C,UAAAA,CAAC,EAAE,MAAMX,UAAU,IAAI,CAApB;AADqD,SAAjC,CAAzB;AAGD;AACF;;AAED,QAAI4E,YAAY,GAAGzD,KAAK,CAAC,UAAD,CAAL,CAAkB,UAAlB,KAAiCA,KAAK,CAACkD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAChF,aAAOA,OAAO,CAACL,GAAR,CAAY,WAAZ,MAA6B,UAApC;AACD,KAFmD,CAApD;;AAIA,QAAIW,YAAY,IAAI,CAACA,YAAY,CAACC,SAAlC,EAA6C;AAC3C,UAAI5E,OAAO,GAAGrB,GAAG,CAAC,EAAD,EAAKgG,YAAY,CAACV,IAAb,EAAL,EAA0BhD,GAAG,CAACjB,OAA9B,CAAjB;AACA2E,MAAAA,YAAY,CAACV,IAAb,CAAkBxF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKuB,OAAL,CAAT,EAAwB;AAChDS,QAAAA,CAAC,EAAE,CAACP,KAAD,GAAS,CADoC;AAEhDQ,QAAAA,CAAC,EAAE,CAACE,MAAD,GAAU,CAFmC;AAGhDA,QAAAA,MAAM,EAAEA;AAHwC,OAAxB,CAA1B;AAKD;;AAED,QAAIuD,aAAa,IAAI,CAACA,aAAa,CAACS,SAApC,EAA+C;AAC7C,UAAI,CAAC3E,IAAD,IAASA,IAAI,KAAKsE,SAAtB,EAAiC;AAC/BJ,QAAAA,aAAa,CAACU,MAAd;AACA,eAAO3D,KAAK,CAAC,UAAD,CAAL,CAAkB,UAAlB,CAAP;AACD,OAHD,MAGO;AACL,YAAI4D,KAAK,GAAGtE,QAAQ,CAACN,KAArB;AAAA,YACImC,CAAC,GAAG7B,QAAQ,CAACI,MADjB;AAAA,YAEIH,CAAC,GAAGD,QAAQ,CAACC,CAFjB;AAAA,YAGIC,CAAC,GAAGF,QAAQ,CAACE,CAHjB;AAAA,YAIIqE,UAAU,GAAGvE,QAAQ,CAACX,MAJ1B;AAAA,YAKI0C,aAAa,GAAG7D,MAAM,CAAC8B,QAAD,EAAW,CAAC,OAAD,EAAU,QAAV,EAAoB,GAApB,EAAyB,GAAzB,EAA8B,QAA9B,CAAX,CAL1B;;AAOA2D,QAAAA,aAAa,CAACF,IAAd,CAAmBxF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK8D,aAAL,CAAT,EAA8B;AACvD9B,UAAAA,CAAC,EAAEA,CAAC,IAAI,CAACP,KAAD,GAAS,CAAT,GAAa4E,KAAb,GAAqBC,UAD0B;AAEvDrE,UAAAA,CAAC,EAAEA,CAAC,IAAI,CAAC2B,CAAD,GAAK,CAF0C;AAGvDnC,UAAAA,KAAK,EAAE4E,KAHgD;AAIvDlE,UAAAA,MAAM,EAAEyB;AAJ+C,SAA9B,CAA3B;AAMD;AACF,KAnBD,MAmBO,IAAIpC,IAAJ,EAAU;AACf,WAAKgC,YAAL,CAAkBhB,GAAlB,EAAuBC,KAAvB;AACD;;AAED,QAAI8D,cAAc,GAAG9D,KAAK,CAAC,UAAD,CAAL,CAAkB,iBAAlB,KAAwCA,KAAK,CAACkD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AACzF,aAAOA,OAAO,CAACL,GAAR,CAAY,WAAZ,MAA6B,iBAApC;AACD,KAF4D,CAA7D;AAGA,QAAIiB,oBAAoB,GAAGD,cAAc,GAAGA,cAAc,CAACf,IAAf,EAAH,GAA2B,EAApE;AACA,QAAIpD,SAAS,GAAGlC,GAAG,CAAC,EAAD,EAAKsG,oBAAL,EAA2BhE,GAAG,CAACJ,SAA/B,CAAnB;;AAEA,QAAImE,cAAJ,EAAoB;AAClB,UAAI,CAACnE,SAAS,CAACZ,IAAX,IAAmBY,SAAS,CAACZ,IAAV,KAAmBsE,SAA1C,EAAqD;AACnDS,QAAAA,cAAc,CAACH,MAAf;AACA,eAAO3D,KAAK,CAAC,UAAD,CAAL,CAAkB,iBAAlB,CAAP;AACD;;AAED,UAAIgE,MAAM,GAAGrE,SAAS,CAACX,KAAvB;AAAA,UACImC,CAAC,GAAGxB,SAAS,CAACD,MADlB;AAAA,UAEIH,CAAC,GAAGI,SAAS,CAACJ,CAFlB;AAAA,UAGIC,CAAC,GAAGG,SAAS,CAACH,CAHlB;AAAA,UAIIyE,WAAW,GAAGtE,SAAS,CAAChB,MAJ5B;AAAA,UAKIuF,cAAc,GAAG1G,MAAM,CAACmC,SAAD,EAAY,CAAC,OAAD,EAAU,QAAV,EAAoB,GAApB,EAAyB,GAAzB,EAA8B,QAA9B,CAAZ,CAL3B;;AAOAmE,MAAAA,cAAc,CAACf,IAAf,CAAoBxF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2G,cAAL,CAAT,EAA+B;AACzD3E,QAAAA,CAAC,EAAEA,CAAC,IAAIP,KAAK,GAAG,CAAR,GAAYgF,MAAZ,GAAqBC,WAD4B;AAEzDzE,QAAAA,CAAC,EAAEA,CAAC,IAAI,CAAC2B,CAAD,GAAK,CAF4C;AAGzDnC,QAAAA,KAAK,EAAEgF,MAHkD;AAIzDtE,QAAAA,MAAM,EAAEyB;AAJiD,OAA/B,CAA5B;AAMD,KAnBD,MAmBO,IAAIxB,SAAS,CAACZ,IAAd,EAAoB;AACzB,WAAKiC,aAAL,CAAmBjB,GAAnB,EAAwBC,KAAxB;AACD;;AAED,SAAKmE,gBAAL,CAAsBpE,GAAtB,EAA2BC,KAA3B;AACD;AAviBuB,CAAd,EAwiBT,aAxiBS,CAAZ","sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport { mix, isString } from '@antv/util';\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\nregisterNode('modelRect', {\n  // 自定义节点时的配置\n  options: {\n    size: [185, 70],\n    style: {\n      radius: 5,\n      stroke: '#69c0ff',\n      fill: '#ffffff',\n      lineWidth: Global.defaultNode.style.lineWidth,\n      fillOpacity: 1\n    },\n    // 文本样式配置\n    labelCfg: {\n      style: {\n        fill: '#595959',\n        fontSize: 14,\n        fontFamily: Global.windowFontFamily\n      },\n      offset: 30 // 距离左侧的 offset，没有设置 y 轴上移动的配置\n\n    },\n    descriptionCfg: {\n      style: {\n        fontSize: 12,\n        fill: '#bfbfbf',\n        fontFamily: Global.windowFontFamily\n      },\n      paddingTop: 0\n    },\n    preRect: {\n      show: true,\n      width: 4,\n      fill: '#40a9ff',\n      radius: 2\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: 10,\n      lineWidth: 1,\n      fill: '#72CC4A',\n      stroke: '#72CC4A'\n    },\n    // 节点中icon配置\n    logoIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: 0\n    },\n    // 节点中表示状态的icon配置\n    stateIcon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: true,\n      x: 0,\n      y: 0,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg',\n      width: 16,\n      height: 16,\n      // 用于调整图标的左右位置\n      offset: -5\n    },\n    // 连接点，默认为左右\n    // anchorPoints: [{ x: 0, y: 0.5 }, { x: 1, y: 0.5 }]\n    anchorPoints: [[0, 0.5], [1, 0.5]]\n  },\n  shapeType: 'modelRect',\n  drawShape: function drawShape(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).preRect,\n        preRect = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = group.addShape('rect', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    group['shapeMap'][this.type + \"-keyShape\"] = keyShape;\n\n    var preRectShow = preRect.show,\n        preRectStyle = __rest(preRect, [\"show\"]);\n\n    if (preRectShow) {\n      group['shapeMap']['pre-rect'] = group.addShape('rect', {\n        attrs: __assign({\n          x: -width / 2,\n          y: -height / 2,\n          height: height\n        }, preRectStyle),\n        className: 'pre-rect',\n        name: 'pre-rect',\n        draggable: true\n      });\n    }\n\n    this.drawLogoIcon(cfg, group);\n    this.drawStateIcon(cfg, group);\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制模型矩形左边的logo图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLogoIcon: function drawLogoIcon(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).logoIcon,\n        logoIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (logoIcon.show) {\n      var w = logoIcon.width,\n          h = logoIcon.height,\n          x = logoIcon.x,\n          y = logoIcon.y,\n          offset = logoIcon.offset,\n          text = logoIcon.text,\n          logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\", \"text\"]);\n\n      if (text) {\n        group['shapeMap']['rect-logo-icon'] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, logoIconStyle),\n          className: 'rect-logo-icon',\n          name: 'rect-logo-icon',\n          draggable: true\n        });\n      } else {\n        group['shapeMap']['rect-logo-icon'] = group.addShape('image', {\n          attrs: __assign(__assign({}, logoIconStyle), {\n            x: x || -width / 2 + w + offset,\n            y: y || -h / 2,\n            width: w,\n            height: h\n          }),\n          className: 'rect-logo-icon',\n          name: 'rect-logo-icon',\n          draggable: true\n        });\n      }\n    }\n  },\n\n  /**\n   * 绘制模型矩形右边的状态图标\n   * @param {Object} cfg 数据配置项\n   * @param {Group} group Group实例\n   */\n  drawStateIcon: function drawStateIcon(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).stateIcon,\n        stateIcon = _a === void 0 ? {} : _a;\n    var size = this.getSize(cfg);\n    var width = size[0];\n\n    if (stateIcon.show) {\n      var w = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          offset = stateIcon.offset,\n          text = stateIcon.text,\n          iconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\", \"text\"]);\n\n      if (text) {\n        group['shapeMap']['rect-state-icon'] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, iconStyle),\n          className: 'rect-state-icon',\n          name: 'rect-state-icon',\n          draggable: true\n        });\n      } else {\n        group['shapeMap']['rect-state-icon'] = group.addShape('image', {\n          attrs: __assign(__assign({}, iconStyle), {\n            x: x || width / 2 - w + offset,\n            y: y || -h / 2,\n            width: w,\n            height: h\n          }),\n          className: 'rect-state-icon',\n          name: 'rect-state-icon',\n          draggable: true\n        });\n      }\n    }\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        bottom = linkPoints.bottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"bottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (left) {\n      // left circle\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: -width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    if (right) {\n      // right circle\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: width / 2,\n          y: 0,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    if (top) {\n      // top circle\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: -height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    if (bottom) {\n      // bottom circle\n      group['shapeMap']['link-point-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: 0,\n          y: height / 2,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-bottom',\n        name: 'link-point-bottom',\n        isAnchorPoint: true\n      });\n    }\n  },\n  drawLabel: function drawLabel(cfg, group) {\n    var _a = this.getOptions(cfg),\n        _b = _a.labelCfg,\n        labelCfg = _b === void 0 ? {} : _b,\n        _c = _a.logoIcon,\n        logoIcon = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var label = null;\n    var show = logoIcon.show,\n        w = logoIcon.width;\n    var offsetX = -width / 2 + labelCfg.offset;\n\n    if (show) {\n      offsetX = -width / 2 + w + labelCfg.offset;\n    }\n\n    var fontStyle = labelCfg.style;\n    var descriptionStyle = descriptionCfg.style,\n        descriptionPaddingTop = descriptionCfg.paddingTop;\n\n    if (isString(cfg.description)) {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: -5,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group['shapeMap']['text-shape'] = label;\n      group['shapeMap']['rect-description'] = group.addShape('text', {\n        attrs: __assign(__assign({}, descriptionStyle), {\n          x: offsetX,\n          y: 17 + (descriptionPaddingTop || 0),\n          text: cfg.description\n        }),\n        className: 'rect-description',\n        name: 'rect-description',\n        draggable: true\n      });\n    } else {\n      label = group.addShape('text', {\n        attrs: __assign(__assign({}, fontStyle), {\n          x: offsetX,\n          y: 7,\n          text: cfg.label\n        }),\n        className: 'text-shape',\n        name: 'text-shape',\n        draggable: true\n      });\n      group['shapeMap']['text-shape'] = label;\n    }\n\n    return label;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = (this.mergeStyle || this.getOptions(cfg)).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖默认的stroke属性\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var size = this.getSize(cfg);\n    var width = style.width || size[0];\n    var height = style.height || size[1];\n\n    var styles = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var _a = this.mergeStyle || this.getOptions(cfg),\n        _b = _a.style,\n        style = _b === void 0 ? {} : _b,\n        _c = _a.labelCfg,\n        labelCfg = _c === void 0 ? {} : _c,\n        _d = _a.descriptionCfg,\n        descriptionCfg = _d === void 0 ? {} : _d;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign(__assign({}, style), {\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height\n    }));\n    var group = item.getContainer();\n    var logoIconShape = group['shapeMap']['rect-logo-icon'] || group.find(function (element) {\n      return element.get('className') === 'rect-logo-icon';\n    });\n    var currentLogoIconAttr = logoIconShape ? logoIconShape.attr() : {};\n    var logoIcon = mix({}, currentLogoIconAttr, cfg.logoIcon);\n    var w = logoIcon.width;\n\n    if (w === undefined) {\n      w = this.options.logoIcon.width;\n    }\n\n    var show = cfg.logoIcon ? cfg.logoIcon.show : undefined;\n    var offset = labelCfg.offset;\n    var offsetX = -width / 2 + w + offset;\n\n    if (!show && show !== undefined) {\n      offsetX = -width / 2 + offset;\n    }\n\n    var label = group['shapeMap']['node-label'] || group.find(function (element) {\n      return element.get('className') === 'node-label';\n    });\n    var description = group['shapeMap']['rect-description'] || group.find(function (element) {\n      return element.get('className') === 'rect-description';\n    });\n\n    if (cfg.label) {\n      if (!label) {\n        group['shapeMap']['node-label'] = group.addShape('text', {\n          attrs: __assign(__assign({}, labelCfg.style), {\n            x: offsetX,\n            y: cfg.description ? -5 : 7,\n            text: cfg.label\n          }),\n          className: 'node-label',\n          name: 'node-label',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.labelCfg ? cfg.labelCfg.style : {};\n        var labelStyle = mix({}, label.attr(), cfgStyle);\n        if (cfg.label) labelStyle.text = cfg.label;\n        labelStyle.x = offsetX;\n        if (isString(cfg.description)) labelStyle.y = -5;\n\n        if (description) {\n          description.resetMatrix();\n          description.attr({\n            x: offsetX\n          });\n        }\n\n        label.resetMatrix();\n        label.attr(labelStyle);\n      }\n    }\n\n    if (isString(cfg.description)) {\n      var paddingTop = descriptionCfg.paddingTop;\n\n      if (!description) {\n        group['shapeMap']['rect-description'] = group.addShape('text', {\n          attrs: __assign(__assign({}, descriptionCfg.style), {\n            x: offsetX,\n            y: 17 + (paddingTop || 0),\n            text: cfg.description\n          }),\n          className: 'rect-description',\n          name: 'rect-description',\n          draggable: true\n        });\n      } else {\n        var cfgStyle = cfg.descriptionCfg ? cfg.descriptionCfg.style : {};\n        var descriptionStyle = mix({}, description.attr(), cfgStyle);\n        if (isString(cfg.description)) descriptionStyle.text = cfg.description;\n        descriptionStyle.x = offsetX;\n        description.resetMatrix();\n        description.attr(__assign(__assign({}, descriptionStyle), {\n          y: 17 + (paddingTop || 0)\n        }));\n      }\n    }\n\n    var preRectShape = group['shapeMap']['pre-rect'] || group.find(function (element) {\n      return element.get('className') === 'pre-rect';\n    });\n\n    if (preRectShape && !preRectShape.destroyed) {\n      var preRect = mix({}, preRectShape.attr(), cfg.preRect);\n      preRectShape.attr(__assign(__assign({}, preRect), {\n        x: -width / 2,\n        y: -height / 2,\n        height: height\n      }));\n    }\n\n    if (logoIconShape && !logoIconShape.destroyed) {\n      if (!show && show !== undefined) {\n        logoIconShape.remove();\n        delete group['shapeMap']['pre-rect'];\n      } else {\n        var logoW = logoIcon.width,\n            h = logoIcon.height,\n            x = logoIcon.x,\n            y = logoIcon.y,\n            logoOffset = logoIcon.offset,\n            logoIconStyle = __rest(logoIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n        logoIconShape.attr(__assign(__assign({}, logoIconStyle), {\n          x: x || -width / 2 + logoW + logoOffset,\n          y: y || -h / 2,\n          width: logoW,\n          height: h\n        }));\n      }\n    } else if (show) {\n      this.drawLogoIcon(cfg, group);\n    }\n\n    var stateIconShape = group['shapeMap']['rect-state-icon'] || group.find(function (element) {\n      return element.get('className') === 'rect-state-icon';\n    });\n    var currentStateIconAttr = stateIconShape ? stateIconShape.attr() : {};\n    var stateIcon = mix({}, currentStateIconAttr, cfg.stateIcon);\n\n    if (stateIconShape) {\n      if (!stateIcon.show && stateIcon.show !== undefined) {\n        stateIconShape.remove();\n        delete group['shapeMap']['rect-state-icon'];\n      }\n\n      var stateW = stateIcon.width,\n          h = stateIcon.height,\n          x = stateIcon.x,\n          y = stateIcon.y,\n          stateOffset = stateIcon.offset,\n          stateIconStyle = __rest(stateIcon, [\"width\", \"height\", \"x\", \"y\", \"offset\"]);\n\n      stateIconShape.attr(__assign(__assign({}, stateIconStyle), {\n        x: x || width / 2 - stateW + stateOffset,\n        y: y || -h / 2,\n        width: stateW,\n        height: h\n      }));\n    } else if (stateIcon.show) {\n      this.drawStateIcon(cfg, group);\n    }\n\n    this.updateLinkPoints(cfg, group);\n  }\n}, 'single-node');"]},"metadata":{},"sourceType":"module"}