{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport rewind from '@mapbox/geojson-rewind';\nexport default function json(data, cfg) {\n  var x = cfg.x,\n      y = cfg.y,\n      x1 = cfg.x1,\n      y1 = cfg.y1,\n      coordinates = cfg.coordinates;\n  var resultData = [];\n  data.forEach(function (col, featureIndex) {\n    var coords = [];\n\n    if (x && y) {\n      coords = [parseFloat(col[x]), parseFloat(col[y])];\n    }\n\n    if (x && y && x1 && y1) {\n      var from = [parseFloat(col[x]), parseFloat(col[y])];\n      var to = [parseFloat(col[x1]), parseFloat(col[y1])];\n      coords = [from, to];\n    }\n\n    if (coordinates) {\n      var type = 'Polygon';\n\n      if (!Array.isArray(coordinates[0])) {\n        type = 'Point';\n      }\n\n      if (Array.isArray(coordinates[0]) && !Array.isArray(coordinates[0][0])) {\n        type = 'LineString';\n      }\n\n      var geometry = {\n        type: type,\n        coordinates: _toConsumableArray(col[coordinates])\n      };\n      rewind(geometry, true);\n      coords = geometry.coordinates;\n    }\n\n    var dataItem = _objectSpread(_objectSpread({}, col), {}, {\n      _id: featureIndex,\n      coordinates: coords\n    });\n\n    resultData.push(dataItem);\n  });\n  return {\n    dataArray: resultData\n  };\n}\nexport var defaultData = [{\n  lng1: 100,\n  lat1: 30.0,\n  lng2: 130,\n  lat2: 30\n}];\nexport var defaultParser = {\n  parser: {\n    type: 'json',\n    x: 'lng1',\n    y: 'lat1',\n    x1: 'lng2',\n    y1: 'lat2'\n  }\n};","map":{"version":3,"sources":["../../src/parser/json.ts"],"names":["x","y","x1","y1","coordinates","cfg","resultData","data","coords","parseFloat","col","from","to","type","Array","geometry","rewind","dataItem","_id","dataArray","defaultData","lng1","lat1","lng2","lat2","defaultParser","parser"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport {\n  IJsonData,\n  IJsonItem,\n  IParseDataItem,\n  IParserCfg,\n  IParserData,\n} from '@antv/l7-core';\n// @ts-ignore\nimport rewind from '@mapbox/geojson-rewind';\nexport default function json(data: IJsonData, cfg: IParserCfg): IParserData {\n  const { x, y, x1, y1, coordinates } = cfg;\n  const resultData: IParseDataItem[] = [];\n  data.forEach((col: IJsonItem, featureIndex: number) => {\n    let coords = [];\n    if (x && y) {\n      coords = [parseFloat(col[x]), parseFloat(col[y])];\n    } // 点数据\n    if (x && y && x1 && y1) {\n      const from = [parseFloat(col[x]), parseFloat(col[y])];\n      const to = [parseFloat(col[x1]), parseFloat(col[y1])];\n      coords = [from, to];\n    }\n    if (coordinates) {\n      let type = 'Polygon';\n      if (!Array.isArray(coordinates[0])) {\n        type = 'Point';\n      }\n      if (Array.isArray(coordinates[0]) && !Array.isArray(coordinates[0][0])) {\n        type = 'LineString';\n      }\n      const geometry = {\n        type,\n        coordinates: [...col[coordinates]],\n      };\n      rewind(geometry, true);\n      coords = geometry.coordinates;\n    }\n    const dataItem = {\n      ...col,\n      _id: featureIndex,\n      coordinates: coords,\n    };\n    resultData.push(dataItem);\n  });\n  return {\n    dataArray: resultData,\n  };\n}\n\n// TODO: 提供默认数据和解析器\nexport const defaultData = [\n  {\n    lng1: 100,\n    lat1: 30.0,\n    lng2: 130,\n    lat2: 30,\n  },\n];\n\nexport const defaultParser = {\n  parser: {\n    type: 'json',\n    x: 'lng1',\n    y: 'lat1',\n    x1: 'lng2',\n    y1: 'lat2',\n  },\n};\n"]},"metadata":{},"sourceType":"module"}