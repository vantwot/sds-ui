{"ast":null,"code":"import _regeneratorRuntime from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _classCallCheck from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { singleton } from 'mana-syringe';\nimport { DisposableCollection, Disposable, XFlowEdgeCommands } from '@antv/xflow-core';\nimport { IHookContribution } from '@antv/xflow-core';\nimport { NsAddEdgeEvent } from '../../config-graph';\nimport { getProps } from '../../utils';\n/**\n * 内置的hook contribution\n * 处理 config上的runtime的注册项\n */\n\nvar FlowHooksContribution = function FlowHooksContribution() {\n  var _this = this;\n\n  _classCallCheck(this, FlowHooksContribution);\n\n  this.toDispose = new DisposableCollection();\n\n  this.registerHookHub = function () {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", Disposable.create(function () {}));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n  };\n\n  this.registerHook = function (hooks) {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _this2 = this;\n\n      var toDispose, disposables;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              toDispose = new DisposableCollection();\n              disposables = [hooks.afterGraphInit.registerHook({\n                name: 'call add edge to replace temp edge',\n                handler: function handler(handlerArgs) {\n                  return __awaiter(_this2, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                    var _this3 = this;\n\n                    var commandService, graph;\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            commandService = handlerArgs.commandService, graph = handlerArgs.graph;\n                            graph.on(NsAddEdgeEvent.EVENT_NAME, function (args) {\n                              return __awaiter(_this3, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                                var edge, edgeConfig, config, onAddEdge;\n                                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                                  while (1) {\n                                    switch (_context2.prev = _context2.next) {\n                                      case 0:\n                                        edge = args.edge, edgeConfig = __rest(args, [\"edge\"]);\n                                        config = {\n                                          edgeConfig: Object.assign(Object.assign({}, edgeConfig), {\n                                            // renderKey: FLOWCHART_EDGE, // 暂不支持\n                                            source: {\n                                              cell: edgeConfig.source,\n                                              port: edgeConfig.sourcePortId\n                                            },\n                                            target: {\n                                              cell: edgeConfig.target,\n                                              port: edgeConfig.targetPortId\n                                            },\n                                            zIndex: 1,\n                                            attrs: {\n                                              line: {\n                                                stroke: '#A2B1C3',\n                                                targetMarker: {\n                                                  name: 'block',\n                                                  width: 12,\n                                                  height: 8\n                                                },\n                                                strokeDasharray: '5 5',\n                                                strokeWidth: 1\n                                              }\n                                            },\n                                            data: Object.assign({}, edgeConfig)\n                                          })\n                                        };\n                                        _context2.next = 4;\n                                        return commandService.executeCommand(XFlowEdgeCommands.ADD_EDGE.id, config);\n\n                                      case 4:\n                                        onAddEdge = getProps('onAddEdge');\n\n                                        if (typeof onAddEdge === 'function') {\n                                          onAddEdge(config);\n                                        }\n\n                                        args.edge.remove();\n\n                                      case 7:\n                                      case \"end\":\n                                        return _context2.stop();\n                                    }\n                                  }\n                                }, _callee2);\n                              }));\n                            });\n\n                          case 2:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3);\n                  }));\n                }\n              })];\n              toDispose.pushAll(disposables);\n              return _context4.abrupt(\"return\", Disposable.create(function () {}));\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n  };\n};\n\nFlowHooksContribution = __decorate([singleton({\n  contrib: IHookContribution\n})], FlowHooksContribution);\nexport { FlowHooksContribution };","map":{"version":3,"sources":["../../../../src/flowchart-canvas/extension/contributions/flow.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { singleton } from 'mana-syringe';\nimport { DisposableCollection, Disposable, XFlowEdgeCommands } from '@antv/xflow-core';\nimport { IHookContribution } from '@antv/xflow-core';\nimport { NsAddEdgeEvent } from '../../config-graph';\nimport { getProps } from '../../utils';\n/**\n * 内置的hook contribution\n * 处理 config上的runtime的注册项\n */\nlet FlowHooksContribution = class FlowHooksContribution {\n    constructor() {\n        this.toDispose = new DisposableCollection();\n        this.registerHookHub = () => __awaiter(this, void 0, void 0, function* () {\n            return Disposable.create(() => { });\n        });\n        this.registerHook = (hooks) => __awaiter(this, void 0, void 0, function* () {\n            const toDispose = new DisposableCollection();\n            const disposables = [\n                hooks.afterGraphInit.registerHook({\n                    name: 'call add edge to replace temp edge',\n                    handler: (handlerArgs) => __awaiter(this, void 0, void 0, function* () {\n                        const { commandService, graph } = handlerArgs;\n                        graph.on(NsAddEdgeEvent.EVENT_NAME, (args) => __awaiter(this, void 0, void 0, function* () {\n                            const { edge } = args, edgeConfig = __rest(args, [\"edge\"]);\n                            const config = {\n                                edgeConfig: Object.assign(Object.assign({}, edgeConfig), { \n                                    // renderKey: FLOWCHART_EDGE, // 暂不支持\n                                    source: {\n                                        cell: edgeConfig.source,\n                                        port: edgeConfig.sourcePortId,\n                                    }, target: {\n                                        cell: edgeConfig.target,\n                                        port: edgeConfig.targetPortId,\n                                    }, zIndex: 1, attrs: {\n                                        line: {\n                                            stroke: '#A2B1C3',\n                                            targetMarker: {\n                                                name: 'block',\n                                                width: 12,\n                                                height: 8,\n                                            },\n                                            strokeDasharray: '5 5',\n                                            strokeWidth: 1,\n                                        },\n                                    }, data: Object.assign({}, edgeConfig) }),\n                            };\n                            yield commandService.executeCommand(XFlowEdgeCommands.ADD_EDGE.id, config);\n                            const onAddEdge = getProps('onAddEdge');\n                            if (typeof onAddEdge === 'function') {\n                                onAddEdge(config);\n                            }\n                            args.edge.remove();\n                        }));\n                    }),\n                }),\n            ];\n            toDispose.pushAll(disposables);\n            return Disposable.create(() => { });\n        });\n    }\n};\nFlowHooksContribution = __decorate([\n    singleton({ contrib: IHookContribution })\n], FlowHooksContribution);\nexport { FlowHooksContribution };\n//# sourceMappingURL=flow.js.map"]},"metadata":{},"sourceType":"module"}