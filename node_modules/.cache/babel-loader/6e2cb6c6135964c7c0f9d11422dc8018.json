{"ast":null,"code":"import ReactDOM from 'react-dom';\nimport { get } from '@antv/util';\nimport { setStyles } from '../../utils';\nexport var createTooltip = function (_a) {\n  var graph = _a.graph,\n      container = _a.container,\n      tooltipCfg = _a.tooltipCfg,\n      nodeCfg = _a.nodeCfg;\n  var _b = nodeCfg.size,\n      size = _b === void 0 ? [120, 40] : _b;\n  var style = tooltipCfg.style,\n      show = tooltipCfg.show,\n      className = tooltipCfg.className,\n      customContent = tooltipCfg.customContent;\n  if (typeof size === 'number') size = [size, size];\n  var nodeWidth = size[0],\n      nodeHeight = size[1];\n\n  var createTooltipContainer = function (positionStyle, item) {\n    var _a;\n\n    var tooltipId = \"\".concat(graph.get('id'), \"-toolitp\");\n    var exist = document.querySelector(\"#\".concat(tooltipId));\n\n    if (exist) {\n      (_a = exist.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(exist);\n    }\n\n    if (!show || !positionStyle) {\n      return;\n    }\n\n    var defaultStyle = {\n      position: 'absolute',\n      width: \"\".concat(nodeWidth, \"px\"),\n      padding: '6px',\n      borderRadius: '2px',\n      fontSize: '24px',\n      backgroundColor: '#fff',\n      boxShadow: '0 0 3px #ccc',\n      minHeight: '40px',\n      boxSizing: 'border-box'\n    };\n    var mountPoint = document.createElement('div');\n    mountPoint.id = tooltipId;\n    mountPoint.className = className !== null && className !== void 0 ? className : 'charts-toolbar';\n    setStyles(mountPoint, defaultStyle);\n    setStyles(mountPoint, positionStyle);\n    setStyles(mountPoint, style);\n    ReactDOM.render(customContent(item), mountPoint); // @ts-ignore\n\n    container.appendChild(mountPoint);\n  };\n\n  var bindEvents = function () {\n    var currentNode = {\n      current: ''\n    };\n    graph.on('node:mousemove', function (evt) {\n      var _a, _b, _c;\n\n      if (!currentNode.current) {\n        // 这里有瑕疵，获取的 minX 不一定是最外层的容器\n        var _d = (_a = get(evt, 'shape.cfg.canvasBBox')) !== null && _a !== void 0 ? _a : {},\n            minX = _d.minX,\n            minY = _d.minY;\n\n        if (!minX) {\n          return;\n        }\n\n        var modelId = get((_b = evt.item) === null || _b === void 0 ? void 0 : _b.getModel(), 'id', '');\n\n        if (modelId) {\n          currentNode.current = modelId;\n        }\n\n        createTooltipContainer({\n          left: \"\".concat(Math.min(Math.max(minX, 0), graph.getWidth() - nodeWidth), \"px\"),\n          bottom: \"\".concat(graph.getHeight() - minY + nodeHeight, \"px\")\n        }, (_c = evt.item) === null || _c === void 0 ? void 0 : _c.getModel());\n      }\n    });\n    graph.on('node:mouseleave', function () {\n      currentNode.current = '';\n      createTooltipContainer();\n    });\n  };\n\n  bindEvents();\n};","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@ant-design/graphs/es/components/tooltip/index.js"],"names":["ReactDOM","get","setStyles","createTooltip","_a","graph","container","tooltipCfg","nodeCfg","_b","size","style","show","className","customContent","nodeWidth","nodeHeight","createTooltipContainer","positionStyle","item","tooltipId","concat","exist","document","querySelector","parentNode","removeChild","defaultStyle","position","width","padding","borderRadius","fontSize","backgroundColor","boxShadow","minHeight","boxSizing","mountPoint","createElement","id","render","appendChild","bindEvents","currentNode","current","on","evt","_c","_d","minX","minY","modelId","getModel","left","Math","min","max","getWidth","bottom","getHeight"],"mappings":"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","sourcesContent":["import ReactDOM from 'react-dom';\nimport { get } from '@antv/util';\nimport { setStyles } from '../../utils';\nexport var createTooltip = function (_a) {\n    var graph = _a.graph, container = _a.container, tooltipCfg = _a.tooltipCfg, nodeCfg = _a.nodeCfg;\n    var _b = nodeCfg.size, size = _b === void 0 ? [120, 40] : _b;\n    var style = tooltipCfg.style, show = tooltipCfg.show, className = tooltipCfg.className, customContent = tooltipCfg.customContent;\n    if (typeof size === 'number')\n        size = [size, size];\n    var nodeWidth = size[0], nodeHeight = size[1];\n    var createTooltipContainer = function (positionStyle, item) {\n        var _a;\n        var tooltipId = \"\".concat(graph.get('id'), \"-toolitp\");\n        var exist = document.querySelector(\"#\".concat(tooltipId));\n        if (exist) {\n            (_a = exist.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(exist);\n        }\n        if (!show || !positionStyle) {\n            return;\n        }\n        var defaultStyle = {\n            position: 'absolute',\n            width: \"\".concat(nodeWidth, \"px\"),\n            padding: '6px',\n            borderRadius: '2px',\n            fontSize: '24px',\n            backgroundColor: '#fff',\n            boxShadow: '0 0 3px #ccc',\n            minHeight: '40px',\n            boxSizing: 'border-box',\n        };\n        var mountPoint = document.createElement('div');\n        mountPoint.id = tooltipId;\n        mountPoint.className = className !== null && className !== void 0 ? className : 'charts-toolbar';\n        setStyles(mountPoint, defaultStyle);\n        setStyles(mountPoint, positionStyle);\n        setStyles(mountPoint, style);\n        ReactDOM.render(customContent(item), mountPoint);\n        // @ts-ignore\n        container.appendChild(mountPoint);\n    };\n    var bindEvents = function () {\n        var currentNode = {\n            current: '',\n        };\n        graph.on('node:mousemove', function (evt) {\n            var _a, _b, _c;\n            if (!currentNode.current) {\n                // 这里有瑕疵，获取的 minX 不一定是最外层的容器\n                var _d = (_a = get(evt, 'shape.cfg.canvasBBox')) !== null && _a !== void 0 ? _a : {}, minX = _d.minX, minY = _d.minY;\n                if (!minX) {\n                    return;\n                }\n                var modelId = get((_b = evt.item) === null || _b === void 0 ? void 0 : _b.getModel(), 'id', '');\n                if (modelId) {\n                    currentNode.current = modelId;\n                }\n                createTooltipContainer({\n                    left: \"\".concat(Math.min(Math.max(minX, 0), graph.getWidth() - nodeWidth), \"px\"),\n                    bottom: \"\".concat(graph.getHeight() - minY + nodeHeight, \"px\"),\n                }, (_c = evt.item) === null || _c === void 0 ? void 0 : _c.getModel());\n            }\n        });\n        graph.on('node:mouseleave', function () {\n            currentNode.current = '';\n            createTooltipContainer();\n        });\n    };\n    bindEvents();\n};\n"]},"metadata":{},"sourceType":"module"}