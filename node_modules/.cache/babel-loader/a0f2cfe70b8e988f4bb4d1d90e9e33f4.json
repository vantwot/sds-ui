{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar defaultOptions = {\n  panStep: 100,\n  bearingStep: 15,\n  pitchStep: 10\n};\n\nvar KeyboardHandler = function () {\n  function KeyboardHandler() {\n    _classCallCheck(this, KeyboardHandler);\n\n    _defineProperty(this, \"enabled\", void 0);\n\n    _defineProperty(this, \"active\", void 0);\n\n    _defineProperty(this, \"panStep\", void 0);\n\n    _defineProperty(this, \"bearingStep\", void 0);\n\n    _defineProperty(this, \"pitchStep\", void 0);\n\n    var stepOptions = defaultOptions;\n    this.panStep = stepOptions.panStep;\n    this.bearingStep = stepOptions.bearingStep;\n    this.pitchStep = stepOptions.pitchStep;\n  }\n\n  _createClass(KeyboardHandler, [{\n    key: \"reset\",\n    value: function reset() {\n      this.active = false;\n    }\n  }, {\n    key: \"keydown\",\n    value: function keydown(e) {\n      var _this = this;\n\n      if (e.altKey || e.ctrlKey || e.metaKey) {\n        return;\n      }\n\n      var zoomDir = 0;\n      var bearingDir = 0;\n      var pitchDir = 0;\n      var xDir = 0;\n      var yDir = 0;\n\n      switch (e.keyCode) {\n        case 61:\n        case 107:\n        case 171:\n        case 187:\n          zoomDir = 1;\n          break;\n\n        case 189:\n        case 109:\n        case 173:\n          zoomDir = -1;\n          break;\n\n        case 37:\n          if (e.shiftKey) {\n            bearingDir = -1;\n          } else {\n            e.preventDefault();\n            xDir = -1;\n          }\n\n          break;\n\n        case 39:\n          if (e.shiftKey) {\n            bearingDir = 1;\n          } else {\n            e.preventDefault();\n            xDir = 1;\n          }\n\n          break;\n\n        case 38:\n          if (e.shiftKey) {\n            pitchDir = 1;\n          } else {\n            e.preventDefault();\n            yDir = -1;\n          }\n\n          break;\n\n        case 40:\n          if (e.shiftKey) {\n            pitchDir = -1;\n          } else {\n            e.preventDefault();\n            yDir = 1;\n          }\n\n          break;\n\n        default:\n          return;\n      }\n\n      return {\n        cameraAnimation: function cameraAnimation(map) {\n          var zoom = map.getZoom();\n          map.easeTo({\n            duration: 300,\n            easeId: 'keyboardHandler',\n            easing: easeOut,\n            zoom: zoomDir ? Math.round(zoom) + zoomDir * (e.shiftKey ? 2 : 1) : zoom,\n            bearing: map.getBearing() + bearingDir * _this.bearingStep,\n            pitch: map.getPitch() + pitchDir * _this.pitchStep,\n            offset: [-xDir * _this.panStep, -yDir * _this.panStep],\n            center: map.getCenter()\n          }, {\n            originalEvent: e\n          });\n        }\n      };\n    }\n  }, {\n    key: \"enable\",\n    value: function enable() {\n      this.enabled = true;\n    }\n  }, {\n    key: \"disable\",\n    value: function disable() {\n      this.enabled = false;\n      this.reset();\n    }\n  }, {\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      return this.enabled;\n    }\n  }, {\n    key: \"isActive\",\n    value: function isActive() {\n      return this.active;\n    }\n  }]);\n\n  return KeyboardHandler;\n}();\n\nfunction easeOut(t) {\n  return t * (2 - t);\n}\n\nexport default KeyboardHandler;","map":{"version":3,"sources":["../../src/handler/keyboard.ts"],"names":["defaultOptions","panStep","bearingStep","pitchStep","KeyboardHandler","stepOptions","e","zoomDir","bearingDir","pitchDir","xDir","yDir","cameraAnimation","zoom","map","duration","easeId","easing","Math","bearing","pitch","offset","center","originalEvent","t"],"mappings":"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","sourcesContent":["import { EarthMap } from '../earthmap';\nimport { Map } from '../map';\n\nconst defaultOptions = {\n  panStep: 100,\n  bearingStep: 15,\n  pitchStep: 10,\n};\n\n/**\n * The `KeyboardHandler` allows the user to zoom, rotate, and pan the map using\n * the following keyboard shortcuts:\n *\n * - `=` / `+`: Increase the zoom level by 1.\n * - `Shift-=` / `Shift-+`: Increase the zoom level by 2.\n * - `-`: Decrease the zoom level by 1.\n * - `Shift--`: Decrease the zoom level by 2.\n * - Arrow keys: Pan by 100 pixels.\n * - `Shift+⇢`: Increase the rotation by 15 degrees.\n * - `Shift+⇠`: Decrease the rotation by 15 degrees.\n * - `Shift+⇡`: Increase the pitch by 10 degrees.\n * - `Shift+⇣`: Decrease the pitch by 10 degrees.\n */\nclass KeyboardHandler {\n  private enabled: boolean;\n  private active: boolean;\n  private panStep: number;\n  private bearingStep: number;\n  private pitchStep: number;\n\n  /**\n   * @private\n   */\n  constructor() {\n    const stepOptions = defaultOptions;\n    this.panStep = stepOptions.panStep;\n    this.bearingStep = stepOptions.bearingStep;\n    this.pitchStep = stepOptions.pitchStep;\n  }\n\n  public reset() {\n    this.active = false;\n  }\n\n  public keydown(e: KeyboardEvent) {\n    if (e.altKey || e.ctrlKey || e.metaKey) {\n      return;\n    }\n    let zoomDir = 0;\n    let bearingDir = 0;\n    let pitchDir = 0;\n    let xDir = 0;\n    let yDir = 0;\n\n    switch (e.keyCode) {\n      case 61:\n      case 107:\n      case 171:\n      case 187:\n        zoomDir = 1;\n        break;\n\n      case 189:\n      case 109:\n      case 173:\n        zoomDir = -1;\n        break;\n\n      case 37:\n        if (e.shiftKey) {\n          bearingDir = -1;\n        } else {\n          e.preventDefault();\n          xDir = -1;\n        }\n        break;\n\n      case 39:\n        if (e.shiftKey) {\n          bearingDir = 1;\n        } else {\n          e.preventDefault();\n          xDir = 1;\n        }\n        break;\n\n      case 38:\n        if (e.shiftKey) {\n          pitchDir = 1;\n        } else {\n          e.preventDefault();\n          yDir = -1;\n        }\n        break;\n\n      case 40:\n        if (e.shiftKey) {\n          pitchDir = -1;\n        } else {\n          e.preventDefault();\n          yDir = 1;\n        }\n        break;\n\n      default:\n        return;\n    }\n\n    return {\n      cameraAnimation: (map: Map | EarthMap) => {\n        const zoom = map.getZoom();\n        map.easeTo(\n          {\n            duration: 300,\n            easeId: 'keyboardHandler',\n            easing: easeOut,\n\n            zoom: zoomDir\n              ? Math.round(zoom) + zoomDir * (e.shiftKey ? 2 : 1)\n              : zoom,\n            bearing: map.getBearing() + bearingDir * this.bearingStep,\n            pitch: map.getPitch() + pitchDir * this.pitchStep,\n            offset: [-xDir * this.panStep, -yDir * this.panStep],\n            center: map.getCenter(),\n          },\n          { originalEvent: e },\n        );\n      },\n    };\n  }\n\n  public enable() {\n    this.enabled = true;\n  }\n\n  public disable() {\n    this.enabled = false;\n    this.reset();\n  }\n\n  public isEnabled() {\n    return this.enabled;\n  }\n\n  public isActive() {\n    return this.active;\n  }\n}\n\nfunction easeOut(t: number) {\n  return t * (2 - t);\n}\n\nexport default KeyboardHandler;\n"]},"metadata":{},"sourceType":"module"}