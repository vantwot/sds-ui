{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport G6 from '@antv/g6';\nimport { isBoolean, mix, isPlainObject, clone, each, deepMix } from '@antv/util';\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../../constants';\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker, cloneBesidesImg, setEllipsis } from '../../utils'; // 通用指标卡\n\nexport var registerIndicatorCardNode = function registerIndicatorCardNode() {\n  var defaultTitleLabelStyle = {\n    fill: '#fff',\n    fontSize: 12\n  };\n  var defaultTitleRectStyle = {\n    fill: '#40a9ff',\n    radius: [2, 2, 0, 0]\n  };\n  var defaultIconStyle = {\n    width: 12,\n    height: 12\n  };\n  var ARROWS = ['startArrow', 'endArrow'];\n  var SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: undefined,\n    fill: undefined,\n    lineAppendWidth: 1,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    x: 0,\n    y: 0,\n    r: 10,\n    width: 20,\n    height: 20,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var PATH_SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: '#000',\n    lineDash: undefined,\n    startArrow: false,\n    endArrow: false,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var SHAPES_DEFAULT_ATTRS = {\n    edge: PATH_SHAPE_DEFAULT_ATTRS,\n    node: SHAPE_DEFAULT_ATTRS\n  };\n  G6.registerNode('indicator-card', {\n    // @ts-ignore\n    draw: function draw(cfg, group) {\n      var _a, _b, _c;\n\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _d = cfg.value,\n          value = _d === void 0 ? {} : _d,\n          nodeCfg = cfg.nodeCfg,\n          markerCfg = cfg.markerCfg;\n      var _e = nodeCfg,\n          titleCfg = _e.title,\n          itemsCfg = _e.items,\n          _f = _e.label,\n          label = _f === void 0 ? {} : _f,\n          style = _e.style,\n          _g = _e.padding,\n          padding = _g === void 0 ? 0 : _g,\n          badge = _e.badge,\n          autoWidth = _e.autoWidth,\n          customContent = _e.customContent;\n      var appendPadding = getStatusBBox(badge);\n      var labelStyle = label.style;\n      var cardPadding = getCssPadding(padding);\n      var paddingArray = cardPadding.map(function (item, index) {\n        return item + appendPadding[index];\n      });\n\n      var _h = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {},\n          titleStyle = _h.style,\n          titleContainerStyle = _h.containerStyle,\n          _j = _h.autoEllipsis,\n          autoEllipsis = _j === void 0 ? true : _j;\n\n      var _k = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {},\n          itemStyle = _k.style,\n          itemContainerStyle = _k.containerStyle,\n          layout = _k.layout,\n          _l = _k.itemSpacing,\n          itemSpacing = _l === void 0 ? 4 : _l,\n          sort = _k.sort,\n          _m = _k.padding,\n          itemPadding = _m === void 0 ? [6, 0, 0] : _m;\n\n      var itemPaddingArray = getCssPadding(itemPadding);\n      var _o = value,\n          title = _o.title,\n          items = _o.items;\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置\n\n      var shapeWidth = size[0];\n      var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3]; // card box\n\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: true\n      }); // node title\n\n      var titleTextShape;\n      var itemShape;\n      var titleShape;\n\n      if (title) {\n        // title rect\n        titleShape = group.addShape('rect', {\n          attrs: __assign(__assign({\n            x: 0,\n            y: 0,\n            width: size[0],\n            height: 0\n          }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n          name: 'title-rect',\n          draggable: true\n        });\n\n        var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n\n        titleTextShape = group.addShape('text', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: paddingArray[0],\n            textBaseline: 'top',\n            text: autoEllipsis && !autoWidth ? setEllipsis(title, textStyle === null || textStyle === void 0 ? void 0 : textStyle.fontSize, contentWidth) : title\n          }, textStyle),\n          name: 'title'\n        });\n        var titleHeight_1 = (titleTextShape ? titleTextShape.getBBox() : {\n          height: size[1] / 2\n        }).height;\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n        height += titleShape.getBBox().height;\n      }\n\n      if (items) {\n        if (!titleShape) {\n          height += paddingArray[0];\n        }\n\n        itemShape = group.addShape('rect', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: height,\n            width: contentWidth,\n            height: 0\n          }, getStyle(itemContainerStyle, cfg, group)),\n          name: 'item-box',\n          draggable: true\n        });\n        height += itemPaddingArray[0];\n        var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n        var isArray_1 = Array.isArray(items);\n\n        var createRowItems_1 = function createRowItems_1(item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var rowHeight = [];\n          var valueShapeWidth = 0;\n          var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n          keys.forEach(function (key, keyIndex) {\n            var x;\n            var isIcon = key.startsWith('icon'); // sort 直接均分，简单化\n\n            if (sort || layout === 'flex') {\n              x = keyIndex * contentWidth / keys.length;\n            } else if (layout === 'follow') {\n              x = valueShapeWidth;\n            } else {\n              // layout === 'bundled'\n              // 直接均分，icon 紧随 value\n              x = key === 'text' ? 0 : contentWidth / 2;\n              x += isIcon ? valueShapeWidth : 0;\n            }\n\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign({\n                textBaseline: 'top',\n                x: startX + x,\n                y: height,\n                text: item[key],\n                img: item[key]\n              }, isIcon ? defaultIconStyle : defaultLabelStyle), getStyle(itemStyle || labelStyle, cfg, group, key)),\n              name: \"\".concat(key, \"-\").concat(index, \"-\").concat(keyIndex)\n            });\n\n            if (key === 'value' || layout === 'follow') {\n              valueShapeWidth += keyShape.getBBox().width;\n              valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n            }\n\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n\n        var createItems_1 = function createItems_1(item, index) {\n          var _a;\n\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var itemsHeight = [];\n\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3] + itemPaddingArray[3],\n              startY: height,\n              width: itemContentWidth_1\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n          }\n\n          height += Math.max.apply(Math, itemsHeight);\n\n          if (isArray_1 && index !== items.length - 1) {\n            height += defaultMargin;\n          }\n        };\n\n        if (Array.isArray(items)) {\n          items.forEach(function (item, index) {\n            createItems_1(item, index);\n          });\n        } else {\n          createItems_1(items);\n        }\n      }\n\n      var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n      itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n      var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n      var shapeHeight = items ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2] : titleHeight + itemHeight;\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n\n      if (autoWidth) {\n        var maxX = Math.max.apply(Math, __spreadArray([shapeWidth], (_a = group === null || group === void 0 ? void 0 : group.getChildren()) === null || _a === void 0 ? void 0 : _a.map(function (childrenShape) {\n          return (childrenShape.getBBox().maxX || 0) + paddingArray[1];\n        }), false));\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('width', maxX);\n        shape === null || shape === void 0 ? void 0 : shape.attr('width', maxX);\n      }\n\n      if (badge) {\n        var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n        group.addShape('rect', {\n          attrs: __assign(__assign({\n            fill: '#40a9ff'\n          }, statusConfig), getStyle(badge.style, cfg, group)),\n          name: 'status-rect'\n        });\n      } // collapse marker\n\n\n      if (markerCfg) {\n        var stateCollapsed = ((_c = (_b = group === null || group === void 0 ? void 0 : group.get('item')) === null || _b === void 0 ? void 0 : _b.getModel()) !== null && _c !== void 0 ? _c : {}).collapsed;\n\n        var _p = shape.getBBox(),\n            shapeWidth_1 = _p.width,\n            shapeHeight_1 = _p.height;\n\n        var _q = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg,\n            show = _q.show,\n            _r = _q.position,\n            position = _r === void 0 ? 'right' : _r,\n            collapsed = _q.collapsed,\n            markerStyle = _q.style;\n\n        createMarker({\n          show: show,\n          position: position,\n          collapsed: stateCollapsed !== null && stateCollapsed !== void 0 ? stateCollapsed : collapsed,\n          style: markerStyle\n        }, group, [shapeWidth_1, shapeHeight_1]);\n        shape.attr('defaultCollapsed', collapsed);\n      }\n\n      return shape;\n    },\n\n    /**\n     * 更新节点，包含文本\n     * @override\n     * @param  {Object} cfg 节点的配置项\n     * @param  {Node} node 节点\n     */\n    // @ts-ignore\n    update: undefined,\n    // @ts-ignore\n    setState: function setState(name, value, item) {\n      var _a, _b;\n\n      var shape = item.get('keyShape');\n      if (!shape || shape.destroyed) return;\n      var type = item.getType();\n      var stateName = isBoolean(value) ? name : \"\".concat(name, \":\").concat(value);\n      var itemStateStyle = item.getStateStyle(stateName); // const originStyle = item.getOriginStyle();\n      // 不允许设置一个不存在的状态\n\n      if (!itemStateStyle) {\n        return;\n      } // 要设置或取消的状态的样式\n      // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n\n\n      var styles = Object.assign({}, itemStateStyle);\n      var group = item.getContainer(); // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n\n      var keptAttrs = {\n        x: 1,\n        y: 1,\n        cx: 1,\n        cy: 1\n      };\n\n      if (value) {\n        var _loop_1 = function _loop_1(key) {\n          var _c;\n\n          var style = styles[key];\n\n          if (isPlainObject(style) && !ARROWS.includes(key)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === key;\n            });\n\n            if (subShape) {\n              subShape.attr(style);\n            }\n          } else {\n            // 非纯对象，则认为是设置到 keyShape 上面的\n            shape.attr((_c = {}, _c[key] = style, _c));\n          }\n        }; // style 为要设置的状态的样式\n\n\n        for (var key in styles) {\n          _loop_1(key);\n        }\n      } else {\n        // 所有生效的 state 的样式\n        var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n        var model = item.getModel(); // 原始样式\n\n        var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n        var keyShapeName_1 = shape.get('name'); // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n        // const keyShapeStyles = clone(shape.attr())\n\n        var shapeAttrs_1 = shape.attr();\n        var keyShapeStyles_1 = {};\n        Object.keys(shapeAttrs_1).forEach(function (key) {\n          if (key === 'img') return;\n          var attr = shapeAttrs_1[key];\n\n          if (attr && typeof attr === 'object') {\n            keyShapeStyles_1[key] = clone(attr);\n          } else {\n            keyShapeStyles_1[key] = attr;\n          }\n        }); // 已有样式 - 要取消的状态的样式\n\n        var filtetDisableStatesStyle = {};\n\n        var _loop_2 = function _loop_2(p) {\n          var style = styles[p];\n\n          if (isPlainObject(style) && !ARROWS.includes(p)) {\n            var subShape_1 = group.find(function (element) {\n              return element.get('name') === p;\n            });\n\n            if (subShape_1) {\n              var subShapeStyles_1 = clone(subShape_1.attr());\n              each(style, function (v, key) {\n                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                  delete keyShapeStyles_1[key];\n                  var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  shape.attr(key, value_1);\n                } else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                  delete subShapeStyles_1[key];\n                  var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  subShape_1.attr(key, value_2);\n                }\n              });\n              filtetDisableStatesStyle[p] = subShapeStyles_1;\n            }\n          } else {\n            if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n              delete keyShapeStyles_1[p];\n              var value_3 = originStyle_1[p] || (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) || SHAPES_DEFAULT_ATTRS[type][p];\n              shape.attr(p, value_3);\n            }\n          }\n        }; // styles 为要取消的状态的样式\n\n\n        for (var p in styles) {\n          _loop_2(p);\n        } // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n        // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n        // 否则为普通对象\n\n\n        if (!keyShapeName_1) {\n          mix(filtetDisableStatesStyle, keyShapeStyles_1);\n        } else {\n          filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n        }\n\n        for (var key in enableStatesStyle) {\n          if (keptAttrs[key]) continue;\n          var enableStyle = enableStatesStyle[key];\n\n          if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n            // 把样式属性merge到keyShape中\n            if (!keyShapeName_1) {\n              mix(originStyle_1, (_a = {}, _a[key] = enableStyle, _a));\n            } else {\n              mix(originStyle_1[keyShapeName_1], (_b = {}, _b[key] = enableStyle, _b));\n              delete originStyle_1[key];\n            }\n\n            delete enableStatesStyle[key];\n          }\n        }\n\n        var originstyles = {};\n        deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n        var keyShapeSetted = false;\n\n        var _loop_3 = function _loop_3(originKey) {\n          var _d;\n\n          var style = originstyles[originKey];\n\n          if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === originKey;\n            });\n\n            if (subShape) {\n              if (originKey === keyShapeName_1) {\n                keyShapeSetted = true;\n              }\n\n              if (originKey !== 'collapse-icon') subShape.attr(style);\n            }\n          } else if (!keyShapeSetted) {\n            var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n            shape.attr((_d = {}, _d[originKey] = value_4, _d));\n          }\n        };\n\n        for (var originKey in originstyles) {\n          _loop_3(originKey);\n        }\n      }\n    }\n  }, 'single-node');\n};","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@ant-design/graphs/es/components/flowAnalysisGraph/customItem.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","l","ar","Array","slice","concat","G6","isBoolean","mix","isPlainObject","clone","each","deepMix","defaultMargin","defaultLabelStyle","defaultCardStyle","getStyle","getCssPadding","getStatusBBox","getStatusCfg","createMarker","cloneBesidesImg","setEllipsis","registerIndicatorCardNode","defaultTitleLabelStyle","fill","fontSize","defaultTitleRectStyle","radius","defaultIconStyle","width","height","ARROWS","SHAPE_DEFAULT_ATTRS","lineWidth","stroke","undefined","lineAppendWidth","opacity","strokeOpacity","fillOpacity","x","y","r","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","PATH_SHAPE_DEFAULT_ATTRS","lineDash","startArrow","endArrow","SHAPES_DEFAULT_ATTRS","edge","node","registerNode","draw","cfg","group","_a","_b","_c","_d","value","nodeCfg","markerCfg","_e","titleCfg","title","itemsCfg","items","_f","label","style","_g","padding","badge","autoWidth","customContent","appendPadding","labelStyle","cardPadding","paddingArray","map","item","index","_h","titleStyle","titleContainerStyle","containerStyle","_j","autoEllipsis","_k","itemStyle","itemContainerStyle","layout","_l","itemSpacing","sort","_m","itemPadding","itemPaddingArray","_o","size","shapeWidth","contentWidth","cardStyle","shape","addShape","attrs","name","draggable","titleTextShape","itemShape","titleShape","textStyle","textBaseline","text","titleHeight_1","getBBox","attr","itemContentWidth_1","isArray_1","isArray","createRowItems_1","startX","rowHeight","valueShapeWidth","keys","forEach","key","keyIndex","isIcon","startsWith","keyShape","img","push","createItems_1","itemsHeight","startY","Math","max","titleHeight","itemHeight","shapeHeight","maxX","getChildren","childrenShape","statusConfig","stateCollapsed","get","getModel","collapsed","_p","shapeWidth_1","shapeHeight_1","_q","show","_r","position","markerStyle","update","setState","destroyed","type","getType","stateName","itemStateStyle","getStateStyle","styles","getContainer","keptAttrs","cx","cy","_loop_1","includes","subShape","find","element","enableStatesStyle","getCurrentStatesStyle","model","originStyle_1","getOriginStyle","keyShapeName_1","shapeAttrs_1","keyShapeStyles_1","filtetDisableStatesStyle","_loop_2","subShape_1","subShapeStyles_1","v","value_1","value_2","value_3","enableStyle","originstyles","keyShapeSetted","_loop_3","originKey","value_4"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport G6 from '@antv/g6';\nimport { isBoolean, mix, isPlainObject, clone, each, deepMix } from '@antv/util';\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../../constants';\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker, cloneBesidesImg, setEllipsis, } from '../../utils';\n// 通用指标卡\nexport var registerIndicatorCardNode = function () {\n    var defaultTitleLabelStyle = {\n        fill: '#fff',\n        fontSize: 12,\n    };\n    var defaultTitleRectStyle = {\n        fill: '#40a9ff',\n        radius: [2, 2, 0, 0],\n    };\n    var defaultIconStyle = {\n        width: 12,\n        height: 12,\n    };\n    var ARROWS = ['startArrow', 'endArrow'];\n    var SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: undefined,\n        fill: undefined,\n        lineAppendWidth: 1,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        x: 0,\n        y: 0,\n        r: 10,\n        width: 20,\n        height: 20,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var PATH_SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: '#000',\n        lineDash: undefined,\n        startArrow: false,\n        endArrow: false,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var SHAPES_DEFAULT_ATTRS = {\n        edge: PATH_SHAPE_DEFAULT_ATTRS,\n        node: SHAPE_DEFAULT_ATTRS,\n    };\n    G6.registerNode('indicator-card', {\n        // @ts-ignore\n        draw: function (cfg, group) {\n            var _a, _b, _c;\n            if (cfg === void 0) { cfg = {}; }\n            var _d = cfg.value, value = _d === void 0 ? {} : _d, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg;\n            var _e = nodeCfg, titleCfg = _e.title, itemsCfg = _e.items, _f = _e.label, label = _f === void 0 ? {} : _f, style = _e.style, _g = _e.padding, padding = _g === void 0 ? 0 : _g, badge = _e.badge, autoWidth = _e.autoWidth, customContent = _e.customContent;\n            var appendPadding = getStatusBBox(badge);\n            var labelStyle = label.style;\n            var cardPadding = getCssPadding(padding);\n            var paddingArray = cardPadding.map(function (item, index) { return item + appendPadding[index]; });\n            var _h = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {}, titleStyle = _h.style, titleContainerStyle = _h.containerStyle, _j = _h.autoEllipsis, autoEllipsis = _j === void 0 ? true : _j;\n            var _k = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {}, itemStyle = _k.style, itemContainerStyle = _k.containerStyle, layout = _k.layout, _l = _k.itemSpacing, itemSpacing = _l === void 0 ? 4 : _l, sort = _k.sort, _m = _k.padding, itemPadding = _m === void 0 ? [6, 0, 0] : _m;\n            var itemPaddingArray = getCssPadding(itemPadding);\n            var _o = value, title = _o.title, items = _o.items;\n            var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n            if (typeof size === 'number')\n                size = [size, size];\n            var height = 0; // 统计容器总高度，动态设置\n            var shapeWidth = size[0];\n            var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\n            // card box\n            var cardStyle = getStyle(style, cfg, group);\n            var shape = group.addShape('rect', {\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\n                name: 'main-box',\n                draggable: true,\n            });\n            // node title\n            var titleTextShape;\n            var itemShape;\n            var titleShape;\n            if (title) {\n                // title rect\n                titleShape = group.addShape('rect', {\n                    attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: 0 }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n                    name: 'title-rect',\n                    draggable: true,\n                });\n                var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n                titleTextShape = group.addShape('text', {\n                    attrs: __assign({ x: paddingArray[3], y: paddingArray[0], textBaseline: 'top', text: autoEllipsis && !autoWidth ? setEllipsis(title, textStyle === null || textStyle === void 0 ? void 0 : textStyle.fontSize, contentWidth) : title }, textStyle),\n                    name: 'title',\n                });\n                var titleHeight_1 = (titleTextShape ? titleTextShape.getBBox() : { height: size[1] / 2 }).height;\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n                height += titleShape.getBBox().height;\n            }\n            if (items) {\n                if (!titleShape) {\n                    height += paddingArray[0];\n                }\n                itemShape = group.addShape('rect', {\n                    attrs: __assign({ x: paddingArray[3], y: height, width: contentWidth, height: 0 }, getStyle(itemContainerStyle, cfg, group)),\n                    name: 'item-box',\n                    draggable: true,\n                });\n                height += itemPaddingArray[0];\n                var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n                var isArray_1 = Array.isArray(items);\n                var createRowItems_1 = function (item, contentWidth, startX, index) {\n                    if (index === void 0) { index = 0; }\n                    var rowHeight = [];\n                    var valueShapeWidth = 0;\n                    var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n                    keys.forEach(function (key, keyIndex) {\n                        var x;\n                        var isIcon = key.startsWith('icon');\n                        // sort 直接均分，简单化\n                        if (sort || layout === 'flex') {\n                            x = (keyIndex * contentWidth) / keys.length;\n                        }\n                        else if (layout === 'follow') {\n                            x = valueShapeWidth;\n                        }\n                        else {\n                            // layout === 'bundled'\n                            // 直接均分，icon 紧随 value\n                            x = key === 'text' ? 0 : contentWidth / 2;\n                            x += isIcon ? valueShapeWidth : 0;\n                        }\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n                            attrs: __assign(__assign({ textBaseline: 'top', x: startX + x, y: height, text: item[key], img: item[key] }, (isIcon ? defaultIconStyle : defaultLabelStyle)), getStyle(itemStyle || labelStyle, cfg, group, key)),\n                            name: \"\".concat(key, \"-\").concat(index, \"-\").concat(keyIndex),\n                        });\n                        if (key === 'value' || layout === 'follow') {\n                            valueShapeWidth += keyShape.getBBox().width;\n                            valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n                        }\n                        rowHeight.push(keyShape.getBBox().height);\n                    });\n                    return rowHeight;\n                };\n                var createItems_1 = function (item, index) {\n                    var _a;\n                    if (index === void 0) { index = 0; }\n                    var itemsHeight = [];\n                    if (customContent) {\n                        itemsHeight.push((_a = customContent(item, group, {\n                            startX: paddingArray[3] + itemPaddingArray[3],\n                            startY: height,\n                            width: itemContentWidth_1,\n                        })) !== null && _a !== void 0 ? _a : 0);\n                    }\n                    else {\n                        itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n                    }\n                    height += Math.max.apply(Math, itemsHeight);\n                    if (isArray_1 && index !== items.length - 1) {\n                        height += defaultMargin;\n                    }\n                };\n                if (Array.isArray(items)) {\n                    items.forEach(function (item, index) {\n                        createItems_1(item, index);\n                    });\n                }\n                else {\n                    createItems_1(items);\n                }\n            }\n            var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n            itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n            var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n            var shapeHeight = items\n                ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2]\n                : titleHeight + itemHeight;\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n            if (autoWidth) {\n                var maxX = Math.max.apply(Math, __spreadArray([shapeWidth], (_a = group === null || group === void 0 ? void 0 : group.getChildren()) === null || _a === void 0 ? void 0 : _a.map(function (childrenShape) {\n                    return (childrenShape.getBBox().maxX || 0) + paddingArray[1];\n                }), false));\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('width', maxX);\n                shape === null || shape === void 0 ? void 0 : shape.attr('width', maxX);\n            }\n            if (badge) {\n                var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n                group.addShape('rect', {\n                    attrs: __assign(__assign({ fill: '#40a9ff' }, statusConfig), getStyle(badge.style, cfg, group)),\n                    name: 'status-rect',\n                });\n            }\n            // collapse marker\n            if (markerCfg) {\n                var stateCollapsed = ((_c = (_b = group === null || group === void 0 ? void 0 : group.get('item')) === null || _b === void 0 ? void 0 : _b.getModel()) !== null && _c !== void 0 ? _c : {}).collapsed;\n                var _p = shape.getBBox(), shapeWidth_1 = _p.width, shapeHeight_1 = _p.height;\n                var _q = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg, show = _q.show, _r = _q.position, position = _r === void 0 ? 'right' : _r, collapsed = _q.collapsed, markerStyle = _q.style;\n                createMarker({\n                    show: show,\n                    position: position,\n                    collapsed: stateCollapsed !== null && stateCollapsed !== void 0 ? stateCollapsed : collapsed,\n                    style: markerStyle,\n                }, group, [shapeWidth_1, shapeHeight_1]);\n                shape.attr('defaultCollapsed', collapsed);\n            }\n            return shape;\n        },\n        /**\n         * 更新节点，包含文本\n         * @override\n         * @param  {Object} cfg 节点的配置项\n         * @param  {Node} node 节点\n         */\n        // @ts-ignore\n        update: undefined,\n        // @ts-ignore\n        setState: function (name, value, item) {\n            var _a, _b;\n            var shape = item.get('keyShape');\n            if (!shape || shape.destroyed)\n                return;\n            var type = item.getType();\n            var stateName = isBoolean(value) ? name : \"\".concat(name, \":\").concat(value);\n            var itemStateStyle = item.getStateStyle(stateName);\n            // const originStyle = item.getOriginStyle();\n            // 不允许设置一个不存在的状态\n            if (!itemStateStyle) {\n                return;\n            }\n            // 要设置或取消的状态的样式\n            // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n            var styles = Object.assign({}, itemStateStyle);\n            var group = item.getContainer();\n            // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n            var keptAttrs = { x: 1, y: 1, cx: 1, cy: 1 };\n            if (value) {\n                var _loop_1 = function (key) {\n                    var _c;\n                    var style = styles[key];\n                    if (isPlainObject(style) && !ARROWS.includes(key)) {\n                        var subShape = group.find(function (element) { return element.get('name') === key; });\n                        if (subShape) {\n                            subShape.attr(style);\n                        }\n                    }\n                    else {\n                        // 非纯对象，则认为是设置到 keyShape 上面的\n                        shape.attr((_c = {},\n                            _c[key] = style,\n                            _c));\n                    }\n                };\n                // style 为要设置的状态的样式\n                for (var key in styles) {\n                    _loop_1(key);\n                }\n            }\n            else {\n                // 所有生效的 state 的样式\n                var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n                var model = item.getModel();\n                // 原始样式\n                var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n                var keyShapeName_1 = shape.get('name');\n                // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n                // const keyShapeStyles = clone(shape.attr())\n                var shapeAttrs_1 = shape.attr();\n                var keyShapeStyles_1 = {};\n                Object.keys(shapeAttrs_1).forEach(function (key) {\n                    if (key === 'img')\n                        return;\n                    var attr = shapeAttrs_1[key];\n                    if (attr && typeof attr === 'object') {\n                        keyShapeStyles_1[key] = clone(attr);\n                    }\n                    else {\n                        keyShapeStyles_1[key] = attr;\n                    }\n                });\n                // 已有样式 - 要取消的状态的样式\n                var filtetDisableStatesStyle = {};\n                var _loop_2 = function (p) {\n                    var style = styles[p];\n                    if (isPlainObject(style) && !ARROWS.includes(p)) {\n                        var subShape_1 = group.find(function (element) { return element.get('name') === p; });\n                        if (subShape_1) {\n                            var subShapeStyles_1 = clone(subShape_1.attr());\n                            each(style, function (v, key) {\n                                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                                    delete keyShapeStyles_1[key];\n                                    var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    shape.attr(key, value_1);\n                                }\n                                else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                                    delete subShapeStyles_1[key];\n                                    var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    subShape_1.attr(key, value_2);\n                                }\n                            });\n                            filtetDisableStatesStyle[p] = subShapeStyles_1;\n                        }\n                    }\n                    else {\n                        if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n                            delete keyShapeStyles_1[p];\n                            var value_3 = originStyle_1[p] ||\n                                (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) ||\n                                SHAPES_DEFAULT_ATTRS[type][p];\n                            shape.attr(p, value_3);\n                        }\n                    }\n                };\n                // styles 为要取消的状态的样式\n                for (var p in styles) {\n                    _loop_2(p);\n                }\n                // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n                // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n                // 否则为普通对象\n                if (!keyShapeName_1) {\n                    mix(filtetDisableStatesStyle, keyShapeStyles_1);\n                }\n                else {\n                    filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n                }\n                for (var key in enableStatesStyle) {\n                    if (keptAttrs[key])\n                        continue;\n                    var enableStyle = enableStatesStyle[key];\n                    if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n                        // 把样式属性merge到keyShape中\n                        if (!keyShapeName_1) {\n                            mix(originStyle_1, (_a = {},\n                                _a[key] = enableStyle,\n                                _a));\n                        }\n                        else {\n                            mix(originStyle_1[keyShapeName_1], (_b = {},\n                                _b[key] = enableStyle,\n                                _b));\n                            delete originStyle_1[key];\n                        }\n                        delete enableStatesStyle[key];\n                    }\n                }\n                var originstyles = {};\n                deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n                var keyShapeSetted = false;\n                var _loop_3 = function (originKey) {\n                    var _d;\n                    var style = originstyles[originKey];\n                    if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n                        var subShape = group.find(function (element) { return element.get('name') === originKey; });\n                        if (subShape) {\n                            if (originKey === keyShapeName_1) {\n                                keyShapeSetted = true;\n                            }\n                            if (originKey !== 'collapse-icon')\n                                subShape.attr(style);\n                        }\n                    }\n                    else if (!keyShapeSetted) {\n                        var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n                        shape.attr((_d = {},\n                            _d[originKey] = value_4,\n                            _d));\n                    }\n                };\n                for (var originKey in originstyles) {\n                    _loop_3(originKey);\n                }\n            }\n        },\n    }, 'single-node');\n};\n"]},"metadata":{},"sourceType":"module"}