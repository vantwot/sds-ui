{"ast":null,"code":"import React, { useState, useRef, memo } from 'react';\nimport { useXFlowApp } from '@antv/xflow-core';\nimport { render } from 'react-dom';\nimport { Button } from 'antd';\nimport { SketchPicker } from 'react-color';\nimport { PREFIX } from '../constants';\n\nconst ColorPicker = props => {\n  const {\n    label,\n    value = '',\n    onChange\n  } = props;\n  const [show, setShow] = useState(false);\n  const colorRef = useRef(value);\n  const {\n    graphProvider\n  } = useXFlowApp();\n  const graphConfig = useRef();\n  graphProvider.getGraphOptions().then(x6GraphConfig => {\n    graphConfig.current = x6GraphConfig;\n  });\n\n  const PickContainer = () => {\n    return React.createElement(\"div\", {\n      className: `${PREFIX}-popover`\n    }, React.createElement(SketchPicker, {\n      style: {\n        width: '100%'\n      },\n      onChange: color => {\n        colorRef.current = color.hex;\n      }\n    }), React.createElement(\"div\", {\n      className: \"foolter\"\n    }, React.createElement(Button, {\n      onClick: () => {\n        setShow(false);\n      }\n    }, \"\\u53D6\\u6D88\"), React.createElement(Button, {\n      type: \"primary\",\n      onClick: () => {\n        onChange === null || onChange === void 0 ? void 0 : onChange(colorRef.current);\n        setShow(false);\n      }\n    }, \"\\u786E\\u8BA4\")));\n  };\n  /**  react-color mouseOver 和上层事件冲突，不得已为之，非 DI 环境应该不存在，后续改进 */\n\n\n  const CreatePickColorContainer = visible => {\n    var _a;\n\n    const container = ((_a = graphConfig.current) === null || _a === void 0 ? void 0 : _a.graphContainer) || document.body;\n    const exist = document.querySelector(`#${PREFIX}-pick-color-container`);\n\n    if (exist) {\n      container.removeChild(exist);\n    }\n\n    if (!visible) {\n      return;\n    }\n\n    const div = document.createElement('div');\n    div.id = `${PREFIX}-pick-color-container`;\n    div.className = `${PREFIX}-pick-color-container`;\n    render(React.createElement(PickContainer, null), div);\n    container.appendChild(div);\n  };\n\n  return React.createElement(\"div\", {\n    className: \"group\"\n  }, label && React.createElement(\"label\", null, label), React.createElement(\"div\", {\n    className: `${PREFIX}-color-container`,\n    onClick: () => {\n      setShow(true);\n    }\n  }, React.createElement(\"div\", {\n    className: `${PREFIX}-color`,\n    style: {\n      backgroundColor: value,\n      height: '100%'\n    }\n  })), CreatePickColorContainer(show));\n};\n\nexport default memo(ColorPicker, (pre, next) => {\n  return pre.label === next.label && pre.value === next.value;\n});","map":{"version":3,"sources":["../../../../../src/flowchart-editor-panel/control-map-service/components/fields/color.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React, { useState, useRef, memo } from 'react';\nimport { useXFlowApp } from '@antv/xflow-core';\nimport { render } from 'react-dom';\nimport { Button } from 'antd';\nimport { SketchPicker } from 'react-color';\nimport { PREFIX } from '../constants';\nconst ColorPicker = props => {\n    const { label, value = '', onChange } = props;\n    const [show, setShow] = useState(false);\n    const colorRef = useRef(value);\n    const { graphProvider } = useXFlowApp();\n    const graphConfig = useRef();\n    graphProvider.getGraphOptions().then(x6GraphConfig => {\n        graphConfig.current = x6GraphConfig;\n    });\n    const PickContainer = () => {\n        return (React.createElement(\"div\", { className: `${PREFIX}-popover` },\n            React.createElement(SketchPicker, { style: {\n                    width: '100%',\n                }, onChange: color => {\n                    colorRef.current = color.hex;\n                } }),\n            React.createElement(\"div\", { className: \"foolter\" },\n                React.createElement(Button, { onClick: () => {\n                        setShow(false);\n                    } }, \"\\u53D6\\u6D88\"),\n                React.createElement(Button, { type: \"primary\", onClick: () => {\n                        onChange === null || onChange === void 0 ? void 0 : onChange(colorRef.current);\n                        setShow(false);\n                    } }, \"\\u786E\\u8BA4\"))));\n    };\n    /**  react-color mouseOver 和上层事件冲突，不得已为之，非 DI 环境应该不存在，后续改进 */\n    const CreatePickColorContainer = (visible) => {\n        var _a;\n        const container = ((_a = graphConfig.current) === null || _a === void 0 ? void 0 : _a.graphContainer) || document.body;\n        const exist = document.querySelector(`#${PREFIX}-pick-color-container`);\n        if (exist) {\n            container.removeChild(exist);\n        }\n        if (!visible) {\n            return;\n        }\n        const div = document.createElement('div');\n        div.id = `${PREFIX}-pick-color-container`;\n        div.className = `${PREFIX}-pick-color-container`;\n        render(React.createElement(PickContainer, null), div);\n        container.appendChild(div);\n    };\n    return (React.createElement(\"div\", { className: \"group\" },\n        label && React.createElement(\"label\", null, label),\n        React.createElement(\"div\", { className: `${PREFIX}-color-container`, onClick: () => {\n                setShow(true);\n            } },\n            React.createElement(\"div\", { className: `${PREFIX}-color`, style: {\n                    backgroundColor: value,\n                    height: '100%',\n                } })),\n        CreatePickColorContainer(show)));\n};\nexport default memo(ColorPicker, (pre, next) => {\n    return pre.label === next.label && pre.value === next.value;\n});\n//# sourceMappingURL=color.js.map"]},"metadata":{},"sourceType":"module"}