{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport G6 from '@antv/g6';\nimport { isNumber, isObject, isString, clone } from '@antv/util';\nimport { defaultMinimapCfg, defaultNodeSize, defaultCardStyle, prefix } from '../constants'; // 类型检测\n\nexport var isType = function isType(value, type) {\n  var toString = {}.toString;\n  return toString.call(value) === \"[object \".concat(type, \"]\");\n};\nexport var Log = window.console;\nexport var getType = function getType(n) {\n  return Object.prototype.toString.call(n).slice(8, -1);\n};\n/**\n * 深克隆\n * @param source 要深克隆的目标对象\n */\n\nexport var deepClone = function deepClone(source) {\n  if (!source) {\n    return source;\n  } // @ts-ignore\n\n\n  var target = new source.constructor();\n\n  for (var key in source) {\n    if (source.hasOwnProperty(key)) {\n      target[key] = getType(source[key]) === 'Object' || getType(source[key]) === 'Array' ? deepClone(source[key]) : source[key];\n    }\n  }\n\n  return target;\n};\nexport var getGraphSize = function getGraphSize(width, height, container) {\n  var CANVAS_WIDTH;\n  var CANVAS_HEIGHT;\n\n  if (container && container.current) {\n    CANVAS_WIDTH = container.current.offsetWidth;\n    CANVAS_HEIGHT = container.current.offsetHeight || 500;\n  }\n\n  if (!width && !CANVAS_WIDTH || !height && !CANVAS_HEIGHT) {\n    Log.warn('请为 Graph 指定 width 与 height！否则将使用默认值 500 * 500');\n    return [500, 500];\n  }\n\n  return [width || CANVAS_WIDTH || 500, height || CANVAS_HEIGHT || 500];\n};\n\nvar EventData =\n/** @class */\nfunction () {\n  function EventData(data) {\n    data && this.setData(data);\n  }\n\n  EventData.prototype.getData = function () {\n    return this.data;\n  };\n\n  EventData.prototype.setData = function (data) {\n    this.data = data;\n  };\n\n  return EventData;\n}(); // 展开&折叠事件\n\n\nexport var bindDefaultEvents = function bindDefaultEvents(graph, level, getChildren) {\n  var onClick = function onClick(e) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var item, _a, collapsed, g_currentPath_1, _b, children, g_parentId_1, g_level_1, id_1, appendChildren, appendChildrenData, currentData;\n\n      var _c;\n\n      return __generator(this, function (_d) {\n        switch (_d.label) {\n          case 0:\n            item = e.item;\n            if (!(e.target.get('name') === 'collapse-icon')) return [3\n            /*break*/\n            , 3];\n            _a = item.getModel(), collapsed = _a.collapsed, g_currentPath_1 = _a.g_currentPath, _b = _a.children, children = _b === void 0 ? [] : _b, g_parentId_1 = _a.g_parentId, g_level_1 = _a.g_level, id_1 = _a.id;\n            appendChildren = level && !children.length && getChildrenData(graph.get('eventData').getData(), g_currentPath_1);\n            if (!(getChildren && !((_c = children) === null || _c === void 0 ? void 0 : _c.length) && !(appendChildren === null || appendChildren === void 0 ? void 0 : appendChildren.length))) return [3\n            /*break*/\n            , 2];\n            createLoading();\n            return [4\n            /*yield*/\n            , getChildren(item.getModel())];\n\n          case 1:\n            appendChildrenData = _d.sent();\n\n            if (appendChildrenData) {\n              appendChildrenData = appendChildrenData.map(function (t, index) {\n                var _a;\n\n                return __assign((_a = {}, _a[\"\".concat(prefix, \"_level\")] = g_level_1 + 1, _a[\"\".concat(prefix, \"_parentId\")] = \"\".concat(g_parentId_1, \"-\").concat(id_1), _a[\"\".concat(prefix, \"_currentPath\")] = \"\".concat(g_currentPath_1, \"-\").concat(index), _a), t);\n              });\n              setLevelData(graph, appendChildrenData, g_currentPath_1);\n            }\n\n            appendChildren = appendChildrenData;\n            closeLoading();\n            _d.label = 2;\n\n          case 2:\n            if ((appendChildren === null || appendChildren === void 0 ? void 0 : appendChildren.length) > 0) {\n              currentData = setParentChildren(graph.get('data'), g_currentPath_1, appendChildren);\n              graph.changeData(currentData);\n\n              if (graph.get('fitCenter')) {\n                graph.fitCenter();\n                graph.stopAnimate(); // 二次布局使用动画效果较差\n              }\n            } else {\n              graph.updateItem(item, {\n                collapsed: !collapsed\n              });\n              graph.layout();\n            }\n\n            _d.label = 3;\n\n          case 3:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  graph.on('node:click', function (e) {\n    onClick(e);\n  });\n  graph.on('node:touchstart', function (e) {\n    onClick(e);\n  });\n};\nexport var renderGraph = function renderGraph(graph, data, level) {\n  var originData = deepClone(data);\n  var tagData = originData;\n\n  if (level) {\n    tagData = setTag(data);\n    originData = getLevelData(tagData, level);\n  }\n\n  graph.data(originData);\n  graph.set('eventData', new EventData(tagData));\n  graph.render(); // 关闭局部刷新，各种 bug\n\n  graph.get('canvas').set('localRefresh', false);\n};\nvar grapgMinmapMaps = {};\nexport var processMinimap = function processMinimap(cfg, graph) {\n  if (cfg === void 0) {\n    cfg = {};\n  }\n\n  var graphId = graph === null || graph === void 0 ? void 0 : graph.get('id');\n\n  if (!graph || graph.destroyed) {\n    grapgMinmapMaps[graphId] = null;\n    return;\n  }\n\n  if ((!cfg || !cfg.show) && grapgMinmapMaps[graphId]) {\n    var pluginMinimap = graph.get('plugins')[0];\n\n    if (pluginMinimap) {\n      graph.removePlugin(pluginMinimap);\n    }\n\n    grapgMinmapMaps[graphId] = null;\n  }\n\n  if (cfg.show && !grapgMinmapMaps[graphId]) {\n    var curMminimapCfg = Object.assign(defaultMinimapCfg, cfg);\n    var minimap = new G6.Minimap(__assign(__assign({}, curMminimapCfg), {\n      id: graphId\n    }));\n    graph.addPlugin(minimap);\n    grapgMinmapMaps[graphId] = minimap;\n    return minimap;\n  }\n\n  return null;\n};\n\nvar getUuid = function getUuid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}; // 同一页面存在多 graph 时需要指定 graphId\n\n\nexport var getGraphId = function getGraphId(graph) {\n  if (graph.current) {\n    return graph.current;\n  }\n\n  graph.current = \"graph-\".concat(getUuid());\n  return graph.current;\n};\nexport var getMarkerPosition = function getMarkerPosition(direction, size) {\n  if (direction === void 0) {\n    direction = 'right';\n  }\n\n  var width = size[0],\n      height = size[1];\n  var x = 0;\n  var y = 0;\n\n  switch (direction) {\n    case 'top':\n      x = width / 2;\n      y = 0;\n      break;\n\n    case 'right':\n      x = width;\n      y = height / 2;\n      break;\n\n    case 'bottom':\n      x = width / 2;\n      y = height;\n      break;\n\n    case 'left':\n      x = 0;\n      y = height / 2;\n      break;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n};\nexport var bindSourceMapCollapseEvents = function bindSourceMapCollapseEvents(graph) {\n  var onClick = function onClick(e) {\n    var _a;\n\n    var controlData = graph.get('eventData').getData();\n\n    if (e.target.get('name') === 'collapse-icon') {\n      var item = e.item;\n      var collapsed = item.getModel().collapsed;\n\n      if (!isType(collapsed, 'Boolean')) {\n        // @ts-ignore\n        collapsed = (_a = item._cfg.group.getChildren().find(function (item) {\n          return item.get('name') === 'main-box';\n        })) === null || _a === void 0 ? void 0 : _a.attr('defaultCollapsed');\n      } // @ts-ignore\n\n\n      var marker = e.item._cfg.group.getChildren().find(function (item) {\n        return item.cfg.type === 'marker';\n      });\n\n      var _b = (controlData !== null && controlData !== void 0 ? controlData : {}).edges,\n          fullEdges_1 = _b === void 0 ? [] : _b;\n      var nodeId = item.getModel().id;\n      var targetNodeIds_1 = [];\n      var updateItems_1 = [];\n      var updateIds_1 = [];\n\n      var getLinkedId_1 = function getLinkedId_1(currentId) {\n        fullEdges_1.forEach(function (edge) {\n          var source = edge.source,\n              target = edge.target;\n\n          if (source === currentId) {\n            targetNodeIds_1.push(target);\n            getLinkedId_1(target);\n          }\n        });\n      };\n\n      getLinkedId_1(nodeId);\n\n      if (!collapsed) {\n        // collapse\n        graph.findAll('node', function (node) {\n          return targetNodeIds_1.includes(node.get('id'));\n        }).forEach(function (node) {\n          return graph.hideItem(node);\n        });\n        controlData.nodes.forEach(function (node) {\n          var _a = node.collapsedLevel,\n              collapsedLevel = _a === void 0 ? 0 : _a,\n              id = node.id;\n\n          if (targetNodeIds_1.includes(id)) {\n            node.collapsedLevel = collapsedLevel + 1;\n          }\n        });\n      } else {\n        // expand\n        graph.findAll('node', function (node) {\n          var collapsedLevel = controlData.nodes.find(function (item) {\n            return item.id === node.get('id');\n          }).collapsedLevel;\n          return targetNodeIds_1.includes(node.get('id')) && (!collapsedLevel || collapsedLevel < 2);\n        }).forEach(function (node) {\n          return graph.showItem(node);\n        });\n        controlData.nodes.forEach(function (node) {\n          var _a = node.collapsedLevel,\n              collapsedLevel = _a === void 0 ? 0 : _a,\n              id = node.id;\n\n          if (targetNodeIds_1.includes(id)) {\n            node.collapsedLevel = collapsedLevel - 1;\n          }\n        });\n      }\n\n      fullEdges_1.forEach(function (edge) {\n        var source = edge.source,\n            target = edge.target;\n\n        if (targetNodeIds_1.includes(target)) {\n          updateIds_1.push(source);\n        }\n      });\n      updateIds_1 = Array.from(new Set(updateIds_1));\n      updateIds_1.forEach(function (id) {\n        updateItems_1.push(graph.find('node', function (node) {\n          return node.get('id') === id;\n        }));\n      });\n      updateItems_1.forEach(function (nodeItem) {\n        graph.updateItem(nodeItem, {\n          collapsed: !nodeItem.getModel().collapsed\n        });\n        graph.refreshItem(nodeItem);\n      });\n    }\n  };\n\n  graph.on('node:click', function (e) {\n    onClick(e);\n  });\n  graph.on('node:touchstart', function (e) {\n    onClick(e);\n  });\n};\n/**\n * padding | margin 按 CSS 规则转换\n */\n\nexport var getCssPadding = function getCssPadding(padding) {\n  if (typeof padding === 'number') {\n    return [padding, padding, padding, padding];\n  }\n\n  var result = [];\n\n  switch (padding.length) {\n    case 1:\n      result = [padding[0], padding[0], padding[0], padding[0]];\n      break;\n\n    case 2:\n      result = [padding[0], padding[1], padding[0], padding[1]];\n      break;\n\n    case 3:\n      result = [padding[0], padding[1], padding[2], padding[1]];\n      break;\n\n    case 4:\n      result = padding;\n      break;\n\n    default:\n      break;\n  }\n\n  return result;\n}; // 默认箭头样式\n\nexport var getArrowCfg = function getArrowCfg(arrowCfg, edge) {\n  if (!arrowCfg) {\n    return;\n  }\n\n  if (typeof arrowCfg === 'object' && (arrowCfg === null || arrowCfg === void 0 ? void 0 : arrowCfg.show) === false) {\n    return;\n  }\n\n  var cfg = typeof arrowCfg === 'function' ? arrowCfg(edge) : arrowCfg;\n  var _a = cfg.type,\n      type = _a === void 0 ? 'vee' : _a,\n      _b = cfg.d,\n      d = _b === void 0 ? 0 : _b,\n      _c = cfg.size,\n      size = _c === void 0 ? 10 : _c;\n  return __assign({\n    path: G6.Arrow[type](size, size, d),\n    fill: '#ccc',\n    d: d\n  }, cfg);\n}; // 交互\n\nexport var bindStateEvents = function bindStateEvents(graph, cfg) {\n  var _a = cfg !== null && cfg !== void 0 ? cfg : {},\n      _b = _a.nodeCfg,\n      nodeCfg = _b === void 0 ? {} : _b,\n      _c = _a.edgeCfg,\n      edgeCfg = _c === void 0 ? {} : _c;\n\n  var nodeStateStyles = nodeCfg.nodeStateStyles;\n  var edgeStateStyles = edgeCfg.edgeStateStyles;\n  /**\n   * 存储交互状态\n   * id: [[endActive, endDefalut], [startActive, startDefalut]]\n   */\n\n  var statusCache = {};\n\n  var updateArrowFill = function updateArrowFill(item, endArrowFill, stratArrowFill) {\n    graph.updateItem(item, {\n      style: {\n        endArrow: !!endArrowFill && {\n          fill: endArrowFill\n        },\n        startArrow: !!stratArrowFill && {\n          fill: stratArrowFill\n        }\n      }\n    });\n  };\n\n  var setState = function setState(item, name, status) {\n    var _a, _b, _c;\n\n    status ? item.toFront() : item.toBack();\n\n    var _d = (_a = item.getModel().style) !== null && _a !== void 0 ? _a : {},\n        endArrow = _d.endArrow,\n        startArrow = _d.startArrow;\n\n    if (endArrow || startArrow) {\n      if (!statusCache[item.getID()]) {\n        // @ts-ignore\n        var endArrowFill = (endArrow !== null && endArrow !== void 0 ? endArrow : {}).fill; // @ts-ignore\n\n        var startArrowFill = (startArrow !== null && startArrow !== void 0 ? startArrow : {}).fill;\n        var hoverStatus = (_c = (_b = item.getModel().style) === null || _b === void 0 ? void 0 : _b[name]) === null || _c === void 0 ? void 0 : _c.stroke;\n        statusCache[item.getID()] = [[hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : endArrowFill, endArrowFill], [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : startArrowFill, startArrowFill]];\n      }\n\n      var fill = statusCache[item.getID()];\n      updateArrowFill(item, endArrow && fill[0][status ? 0 : 1], startArrow && fill[1][status ? 0 : 1]);\n    }\n\n    graph.setItemState(item, name, status);\n  };\n\n  var getRelationItems = function getRelationItems(currentItem, name, status, type) {\n    var relationItems = type === 'node' ? graph.findAll('edge', function (edge) {\n      return edge.getSource() === currentItem || edge.getTarget() === currentItem;\n    }) : graph.findAll('node', function (node) {\n      return currentItem.getSource().get('id') === node.get('id') || currentItem.getTarget().get('id') === node.get('id');\n    });\n    var highlightItems = [currentItem].concat(relationItems);\n    highlightItems.forEach(function (item) {\n      setState(item, name, status);\n    });\n  };\n\n  if (nodeStateStyles) {\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', true, 'node');\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', false, 'node');\n    });\n  }\n\n  if (edgeStateStyles) {\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', true, 'edge');\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', false, 'edge');\n    });\n  }\n}; // 统一处理 config，支持回调\n\nexport var getStyle = function getStyle(source, cfg, item, current) {\n  if (typeof source === 'function') {\n    return source(cfg, item, current);\n  }\n\n  return source || {};\n}; // 统一处理 config，支持回调\n\nexport var getCommonConfig = function getCommonConfig(cfg, item, graph) {\n  if (typeof cfg === 'function') {\n    return cfg(item, graph);\n  }\n\n  return cfg;\n};\nexport var getSize = function getSize(size) {\n  if (Array.isArray(size)) {\n    return size;\n  }\n\n  return size ? [size, size] : defaultNodeSize;\n}; // status bar 的默认宽度\n\nvar DefaultStatusBarWidth = 4;\n/**\n * card status 对布局的影响，直接加到 padding 中\n */\n\nexport var getStatusBBox = function getStatusBBox(cfg) {\n  if (!cfg) {\n    return [0, 0, 0, 0];\n  }\n\n  var _a = cfg.size,\n      size = _a === void 0 ? [] : _a,\n      _b = cfg.position,\n      position = _b === void 0 ? 'left' : _b;\n\n  var _c = getSize(size),\n      width = _c[0],\n      height = _c[1];\n\n  var appendPadding = [];\n\n  switch (position) {\n    case 'top':\n      appendPadding.push(height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0, 0, 0);\n      break;\n\n    case 'right':\n      appendPadding.push(0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth, 0, 0);\n      break;\n\n    case 'bottom':\n      appendPadding.push(0, 0, height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0);\n      break;\n\n    case 'left':\n      appendPadding.push(0, 0, 0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth);\n      break;\n  }\n\n  return appendPadding;\n};\nexport var getStatusCfg = function getStatusCfg(cfg, cardSize) {\n  var _a = cfg !== null && cfg !== void 0 ? cfg : {},\n      _b = _a.size,\n      size = _b === void 0 ? [] : _b,\n      _c = _a.position,\n      position = _c === void 0 ? 'left' : _c;\n\n  var _d = getSize(size),\n      width = _d[0],\n      height = _d[1];\n\n  var cardWidth = cardSize[0],\n      cardHeight = cardSize[1];\n  var x = 0;\n  var y = 0;\n  var w = 0;\n  var h = 0;\n\n  switch (position) {\n    case 'top':\n      x = 0;\n      y = 0;\n      w = width !== null && width !== void 0 ? width : cardWidth;\n      h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n      break;\n\n    case 'left':\n      x = 0;\n      y = 0;\n      w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n      h = height !== null && height !== void 0 ? height : cardHeight;\n      break;\n\n    case 'right':\n      x = cardWidth - (isNumber(width) ? width : DefaultStatusBarWidth);\n      y = 0;\n      w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n      h = height !== null && height !== void 0 ? height : cardHeight;\n      break;\n\n    case 'bottom':\n      x = 0;\n      y = cardHeight - (isNumber(height) ? height : DefaultStatusBarWidth);\n      w = width !== null && width !== void 0 ? width : cardWidth;\n      h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n      break;\n  }\n\n  return {\n    x: x,\n    y: y,\n    width: w,\n    height: h\n  };\n};\nexport var createMarker = function createMarker(cfg, group, size) {\n  var show = cfg.show,\n      position = cfg.position,\n      collapsed = cfg.collapsed,\n      style = cfg.style;\n\n  if (show) {\n    group.addShape('marker', {\n      attrs: __assign(__assign(__assign({}, getMarkerPosition(position, size)), {\n        r: 6,\n        cursor: 'pointer',\n        symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse,\n        stroke: defaultCardStyle.stroke,\n        lineWidth: 1,\n        fill: '#fff'\n      }), style),\n      defaultCollapsed: false,\n      name: 'collapse-icon'\n    });\n  }\n};\nexport var cloneBesidesImg = function cloneBesidesImg(obj) {\n  var clonedObj = {};\n  Object.keys(obj).forEach(function (key1) {\n    var obj2 = obj[key1];\n\n    if (isObject(obj2)) {\n      var clonedObj2_1 = {};\n      Object.keys(obj2).forEach(function (key2) {\n        var v = obj2[key2];\n        if (key2 === 'img' && !isString(v)) return;\n        clonedObj2_1[key2] = clone(v);\n      });\n      clonedObj[key1] = clonedObj2_1;\n    } else {\n      clonedObj[key1] = clone(obj2);\n    }\n  });\n  return clonedObj;\n};\nexport var setStyles = function setStyles(container, style) {\n  if (style === void 0) {\n    style = {};\n  }\n\n  var keys = Object.keys(style);\n  keys.forEach(function (key) {\n    container.style[key] = style[key];\n  });\n};\n/**\n * 对数据进行打标，加上 level 和  parentId\n */\n\nexport var setTag = function setTag(data, level, parentId, path) {\n  var _a;\n\n  if (level === void 0) {\n    level = 0;\n  }\n\n  if (parentId === void 0) {\n    parentId = '';\n  }\n\n  if (path === void 0) {\n    path = '';\n  }\n\n  var id = data.id,\n      _b = data.children,\n      children = _b === void 0 ? [] : _b;\n  return __assign(__assign((_a = {}, _a[\"\".concat(prefix, \"_level\")] = level, _a[\"\".concat(prefix, \"_parentId\")] = parentId, _a[\"\".concat(prefix, \"_currentPath\")] = path, _a), data), {\n    children: children === null || children === void 0 ? void 0 : children.map(function (item, index) {\n      return setTag(item, level + 1, parentId ? \"\".concat(parentId, \"-\").concat(id) : id, \"\".concat(path, \"-\").concat(index));\n    })\n  });\n};\n/**\n * 根据 level 获取相关数据\n */\n\nexport var getLevelData = function getLevelData(data, level) {\n  var _a = data.children,\n      children = _a === void 0 ? [] : _a,\n      _b = data.g_level,\n      g_level = _b === void 0 ? 0 : _b;\n\n  if (level <= 0) {\n    return data;\n  }\n\n  return __assign(__assign({}, data), {\n    children: g_level + 1 < level ? children === null || children === void 0 ? void 0 : children.map(function (item) {\n      return getLevelData(item, level);\n    }) : []\n  });\n};\n/**\n * 挂载异步数据到全局 data\n */\n\nexport var setLevelData = function setLevelData(graph, data, currentPath) {\n  var currentData = graph.get('eventData').getData(); // 打标时已经做了编码，这直接取值即可\n\n  var path = currentPath.split('-');\n  path.shift(); // 根节点没有 path\n\n  var current = currentData;\n  path.forEach(function (childrenIndex) {\n    current = current.children[Number(childrenIndex)];\n  });\n  current.children = data;\n};\n/**\n * get children\n * 获取相关路径下的一级节点\n */\n\nexport var getChildrenData = function getChildrenData(data, currentPath) {\n  // 打标时已经做了编码，这直接取值即可\n  var path = currentPath.split('-');\n  path.shift(); // 根节点没有 path\n\n  var current = data;\n  path.forEach(function (childrenIndex) {\n    current = current.children[Number(childrenIndex)];\n  });\n\n  if (!(current === null || current === void 0 ? void 0 : current.children)) {\n    return [];\n  }\n\n  return current.children.map(function (item) {\n    return __assign(__assign({}, item), {\n      children: []\n    });\n  });\n};\n/**\n * 将查询到的节点挂载到当前图数据上\n */\n\nexport var setParentChildren = function setParentChildren(parendData, currentPath, children) {\n  var path = currentPath.split('-');\n  path.shift();\n  var current = parendData;\n  path.forEach(function (childrenIndex) {\n    current = current.children[Number(childrenIndex)];\n  });\n  current.children = children;\n  return parendData;\n};\n/** 超出省略 */\n\nexport var setEllipsis = function setEllipsis(text, fontSize, contentWidth) {\n  if (fontSize === void 0) {\n    fontSize = 12;\n  }\n\n  if (contentWidth === void 0) {\n    contentWidth = 120;\n  }\n\n  var size = isNumber(fontSize) ? fontSize : Number(fontSize.replace('px', ''));\n  var maxWords = Math.floor(contentWidth / size);\n\n  if (text.length <= maxWords) {\n    return text;\n  }\n\n  return text.slice(0, maxWords - 1) + '...';\n};\n/** 开启加载动画， 不支持同时存在多个 */\n\nexport var createLoading = function createLoading() {\n  var container = document.createElement('div');\n  container.className = \"\".concat(prefix, \"-antd-loading\");\n  var styles = {\n    position: 'fixed',\n    left: '0',\n    top: '0',\n    width: '100vw',\n    height: '100vh',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'rgba(0,0,0, 0.25)',\n    color: '#fff',\n    fontSize: '16px',\n    zIndex: 999\n  };\n  var span = document.createElement('span');\n  span.innerText = 'loading...';\n  setStyles(container, styles);\n  container.appendChild(span);\n  document.body.appendChild(container);\n};\n/** 关闭加载动画 */\n\nexport var closeLoading = function closeLoading() {\n  var hideContainer = document.getElementsByClassName(\"\".concat(prefix, \"-antd-loading\"));\n  Array.from(hideContainer).forEach(function (el) {\n    document.body.removeChild(el);\n  });\n};","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@ant-design/graphs/es/utils/index.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","G6","isNumber","isObject","isString","clone","defaultMinimapCfg","defaultNodeSize","defaultCardStyle","prefix","isType","type","toString","concat","Log","window","console","getType","slice","deepClone","source","target","constructor","key","getGraphSize","width","height","container","CANVAS_WIDTH","CANVAS_HEIGHT","current","offsetWidth","offsetHeight","warn","EventData","data","setData","getData","bindDefaultEvents","graph","level","getChildren","onClick","item","_a","collapsed","g_currentPath_1","_b","children","g_parentId_1","g_level_1","id_1","appendChildren","appendChildrenData","currentData","_c","_d","get","getModel","g_currentPath","g_parentId","g_level","id","getChildrenData","createLoading","map","index","setLevelData","closeLoading","setParentChildren","changeData","fitCenter","stopAnimate","updateItem","layout","on","renderGraph","originData","tagData","setTag","getLevelData","set","render","grapgMinmapMaps","processMinimap","cfg","graphId","destroyed","show","pluginMinimap","removePlugin","curMminimapCfg","minimap","Minimap","addPlugin","getUuid","replace","c","r","Math","random","getGraphId","getMarkerPosition","direction","size","x","bindSourceMapCollapseEvents","controlData","_cfg","group","find","attr","marker","edges","fullEdges_1","nodeId","targetNodeIds_1","updateItems_1","updateIds_1","getLinkedId_1","currentId","forEach","edge","findAll","node","includes","hideItem","nodes","collapsedLevel","showItem","Array","from","Set","nodeItem","refreshItem","getCssPadding","padding","getArrowCfg","arrowCfg","d","path","Arrow","fill","bindStateEvents","nodeCfg","edgeCfg","nodeStateStyles","edgeStateStyles","statusCache","updateArrowFill","endArrowFill","stratArrowFill","style","endArrow","startArrow","setState","name","status","toFront","toBack","getID","startArrowFill","hoverStatus","stroke","setItemState","getRelationItems","currentItem","relationItems","getSource","getTarget","highlightItems","evt","getStyle","getCommonConfig","getSize","isArray","DefaultStatusBarWidth","getStatusBBox","position","appendPadding","getStatusCfg","cardSize","cardWidth","cardHeight","w","h","createMarker","addShape","attrs","cursor","symbol","Marker","expand","collapse","lineWidth","defaultCollapsed","cloneBesidesImg","obj","clonedObj","keys","key1","obj2","clonedObj2_1","key2","setStyles","parentId","currentPath","split","shift","childrenIndex","Number","parendData","setEllipsis","text","fontSize","contentWidth","maxWords","floor","document","createElement","className","styles","left","top","display","alignItems","justifyContent","background","color","zIndex","span","innerText","appendChild","hideContainer","getElementsByClassName","el","removeChild"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport G6 from '@antv/g6';\nimport { isNumber, isObject, isString, clone } from '@antv/util';\nimport { defaultMinimapCfg, defaultNodeSize, defaultCardStyle, prefix } from '../constants';\n// 类型检测\nexport var isType = function (value, type) {\n    var toString = {}.toString;\n    return toString.call(value) === \"[object \".concat(type, \"]\");\n};\nexport var Log = window.console;\nexport var getType = function (n) {\n    return Object.prototype.toString.call(n).slice(8, -1);\n};\n/**\n * 深克隆\n * @param source 要深克隆的目标对象\n */\nexport var deepClone = function (source) {\n    if (!source) {\n        return source;\n    }\n    // @ts-ignore\n    var target = new source.constructor();\n    for (var key in source) {\n        if (source.hasOwnProperty(key)) {\n            target[key] =\n                getType(source[key]) === 'Object' || getType(source[key]) === 'Array' ? deepClone(source[key]) : source[key];\n        }\n    }\n    return target;\n};\nexport var getGraphSize = function (width, height, container) {\n    var CANVAS_WIDTH;\n    var CANVAS_HEIGHT;\n    if (container && container.current) {\n        CANVAS_WIDTH = container.current.offsetWidth;\n        CANVAS_HEIGHT = container.current.offsetHeight || 500;\n    }\n    if ((!width && !CANVAS_WIDTH) || (!height && !CANVAS_HEIGHT)) {\n        Log.warn('请为 Graph 指定 width 与 height！否则将使用默认值 500 * 500');\n        return [500, 500];\n    }\n    return [width || CANVAS_WIDTH || 500, height || CANVAS_HEIGHT || 500];\n};\nvar EventData = /** @class */ (function () {\n    function EventData(data) {\n        data && this.setData(data);\n    }\n    EventData.prototype.getData = function () {\n        return this.data;\n    };\n    EventData.prototype.setData = function (data) {\n        this.data = data;\n    };\n    return EventData;\n}());\n// 展开&折叠事件\nexport var bindDefaultEvents = function (graph, level, getChildren) {\n    var onClick = function (e) { return __awaiter(void 0, void 0, void 0, function () {\n        var item, _a, collapsed, g_currentPath_1, _b, children, g_parentId_1, g_level_1, id_1, appendChildren, appendChildrenData, currentData;\n        var _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    item = e.item;\n                    if (!(e.target.get('name') === 'collapse-icon')) return [3 /*break*/, 3];\n                    _a = item.getModel(), collapsed = _a.collapsed, g_currentPath_1 = _a.g_currentPath, _b = _a.children, children = _b === void 0 ? [] : _b, g_parentId_1 = _a.g_parentId, g_level_1 = _a.g_level, id_1 = _a.id;\n                    appendChildren = level &&\n                        !children.length &&\n                        getChildrenData(graph.get('eventData').getData(), g_currentPath_1);\n                    if (!(getChildren && !((_c = children) === null || _c === void 0 ? void 0 : _c.length) && !(appendChildren === null || appendChildren === void 0 ? void 0 : appendChildren.length))) return [3 /*break*/, 2];\n                    createLoading();\n                    return [4 /*yield*/, getChildren(item.getModel())];\n                case 1:\n                    appendChildrenData = _d.sent();\n                    if (appendChildrenData) {\n                        appendChildrenData = appendChildrenData.map(function (t, index) {\n                            var _a;\n                            return __assign((_a = {}, _a[\"\".concat(prefix, \"_level\")] = g_level_1 + 1, _a[\"\".concat(prefix, \"_parentId\")] = \"\".concat(g_parentId_1, \"-\").concat(id_1), _a[\"\".concat(prefix, \"_currentPath\")] = \"\".concat(g_currentPath_1, \"-\").concat(index), _a), t);\n                        });\n                        setLevelData(graph, appendChildrenData, g_currentPath_1);\n                    }\n                    appendChildren = appendChildrenData;\n                    closeLoading();\n                    _d.label = 2;\n                case 2:\n                    if ((appendChildren === null || appendChildren === void 0 ? void 0 : appendChildren.length) > 0) {\n                        currentData = setParentChildren(graph.get('data'), g_currentPath_1, appendChildren);\n                        graph.changeData(currentData);\n                        if (graph.get('fitCenter')) {\n                            graph.fitCenter();\n                            graph.stopAnimate(); // 二次布局使用动画效果较差\n                        }\n                    }\n                    else {\n                        graph.updateItem(item, {\n                            collapsed: !collapsed,\n                        });\n                        graph.layout();\n                    }\n                    _d.label = 3;\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n    graph.on('node:click', function (e) {\n        onClick(e);\n    });\n    graph.on('node:touchstart', function (e) {\n        onClick(e);\n    });\n};\nexport var renderGraph = function (graph, data, level) {\n    var originData = deepClone(data);\n    var tagData = originData;\n    if (level) {\n        tagData = setTag(data);\n        originData = getLevelData(tagData, level);\n    }\n    graph.data(originData);\n    graph.set('eventData', new EventData(tagData));\n    graph.render();\n    // 关闭局部刷新，各种 bug\n    graph.get('canvas').set('localRefresh', false);\n};\nvar grapgMinmapMaps = {};\nexport var processMinimap = function (cfg, graph) {\n    if (cfg === void 0) { cfg = {}; }\n    var graphId = graph === null || graph === void 0 ? void 0 : graph.get('id');\n    if (!graph || graph.destroyed) {\n        grapgMinmapMaps[graphId] = null;\n        return;\n    }\n    if ((!cfg || !cfg.show) && grapgMinmapMaps[graphId]) {\n        var pluginMinimap = graph.get('plugins')[0];\n        if (pluginMinimap) {\n            graph.removePlugin(pluginMinimap);\n        }\n        grapgMinmapMaps[graphId] = null;\n    }\n    if (cfg.show && !grapgMinmapMaps[graphId]) {\n        var curMminimapCfg = Object.assign(defaultMinimapCfg, cfg);\n        var minimap = new G6.Minimap(__assign(__assign({}, curMminimapCfg), { id: graphId }));\n        graph.addPlugin(minimap);\n        grapgMinmapMaps[graphId] = minimap;\n        return minimap;\n    }\n    return null;\n};\nvar getUuid = function () {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (Math.random() * 16) | 0;\n        var v = c == 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n};\n// 同一页面存在多 graph 时需要指定 graphId\nexport var getGraphId = function (graph) {\n    if (graph.current) {\n        return graph.current;\n    }\n    graph.current = \"graph-\".concat(getUuid());\n    return graph.current;\n};\nexport var getMarkerPosition = function (direction, size) {\n    if (direction === void 0) { direction = 'right'; }\n    var width = size[0], height = size[1];\n    var x = 0;\n    var y = 0;\n    switch (direction) {\n        case 'top':\n            x = width / 2;\n            y = 0;\n            break;\n        case 'right':\n            x = width;\n            y = height / 2;\n            break;\n        case 'bottom':\n            x = width / 2;\n            y = height;\n            break;\n        case 'left':\n            x = 0;\n            y = height / 2;\n            break;\n    }\n    return { x: x, y: y };\n};\nexport var bindSourceMapCollapseEvents = function (graph) {\n    var onClick = function (e) {\n        var _a;\n        var controlData = graph.get('eventData').getData();\n        if (e.target.get('name') === 'collapse-icon') {\n            var item = e.item;\n            var collapsed = item.getModel().collapsed;\n            if (!isType(collapsed, 'Boolean')) {\n                // @ts-ignore\n                collapsed = (_a = item._cfg.group\n                    .getChildren()\n                    .find(function (item) { return item.get('name') === 'main-box'; })) === null || _a === void 0 ? void 0 : _a.attr('defaultCollapsed');\n            }\n            // @ts-ignore\n            var marker = e.item._cfg.group.getChildren().find(function (item) { return item.cfg.type === 'marker'; });\n            var _b = (controlData !== null && controlData !== void 0 ? controlData : {}).edges, fullEdges_1 = _b === void 0 ? [] : _b;\n            var nodeId = item.getModel().id;\n            var targetNodeIds_1 = [];\n            var updateItems_1 = [];\n            var updateIds_1 = [];\n            var getLinkedId_1 = function (currentId) {\n                fullEdges_1.forEach(function (edge) {\n                    var source = edge.source, target = edge.target;\n                    if (source === currentId) {\n                        targetNodeIds_1.push(target);\n                        getLinkedId_1(target);\n                    }\n                });\n            };\n            getLinkedId_1(nodeId);\n            if (!collapsed) {\n                // collapse\n                graph.findAll('node', function (node) { return targetNodeIds_1.includes(node.get('id')); }).forEach(function (node) { return graph.hideItem(node); });\n                controlData.nodes.forEach(function (node) {\n                    var _a = node.collapsedLevel, collapsedLevel = _a === void 0 ? 0 : _a, id = node.id;\n                    if (targetNodeIds_1.includes(id)) {\n                        node.collapsedLevel = collapsedLevel + 1;\n                    }\n                });\n            }\n            else {\n                // expand\n                graph\n                    .findAll('node', function (node) {\n                    var collapsedLevel = controlData.nodes.find(function (item) { return item.id === node.get('id'); }).collapsedLevel;\n                    return targetNodeIds_1.includes(node.get('id')) && (!collapsedLevel || collapsedLevel < 2);\n                })\n                    .forEach(function (node) { return graph.showItem(node); });\n                controlData.nodes.forEach(function (node) {\n                    var _a = node.collapsedLevel, collapsedLevel = _a === void 0 ? 0 : _a, id = node.id;\n                    if (targetNodeIds_1.includes(id)) {\n                        node.collapsedLevel = collapsedLevel - 1;\n                    }\n                });\n            }\n            fullEdges_1.forEach(function (edge) {\n                var source = edge.source, target = edge.target;\n                if (targetNodeIds_1.includes(target)) {\n                    updateIds_1.push(source);\n                }\n            });\n            updateIds_1 = Array.from(new Set(updateIds_1));\n            updateIds_1.forEach(function (id) {\n                updateItems_1.push(graph.find('node', function (node) { return node.get('id') === id; }));\n            });\n            updateItems_1.forEach(function (nodeItem) {\n                graph.updateItem(nodeItem, {\n                    collapsed: !nodeItem.getModel().collapsed,\n                });\n                graph.refreshItem(nodeItem);\n            });\n        }\n    };\n    graph.on('node:click', function (e) {\n        onClick(e);\n    });\n    graph.on('node:touchstart', function (e) {\n        onClick(e);\n    });\n};\n/**\n * padding | margin 按 CSS 规则转换\n */\nexport var getCssPadding = function (padding) {\n    if (typeof padding === 'number') {\n        return [padding, padding, padding, padding];\n    }\n    var result = [];\n    switch (padding.length) {\n        case 1:\n            result = [padding[0], padding[0], padding[0], padding[0]];\n            break;\n        case 2:\n            result = [padding[0], padding[1], padding[0], padding[1]];\n            break;\n        case 3:\n            result = [padding[0], padding[1], padding[2], padding[1]];\n            break;\n        case 4:\n            result = padding;\n            break;\n        default:\n            break;\n    }\n    return result;\n};\n// 默认箭头样式\nexport var getArrowCfg = function (arrowCfg, edge) {\n    if (!arrowCfg) {\n        return;\n    }\n    if (typeof arrowCfg === 'object' && (arrowCfg === null || arrowCfg === void 0 ? void 0 : arrowCfg.show) === false) {\n        return;\n    }\n    var cfg = typeof arrowCfg === 'function' ? arrowCfg(edge) : arrowCfg;\n    var _a = cfg.type, type = _a === void 0 ? 'vee' : _a, _b = cfg.d, d = _b === void 0 ? 0 : _b, _c = cfg.size, size = _c === void 0 ? 10 : _c;\n    return __assign({ path: G6.Arrow[type](size, size, d), fill: '#ccc', d: d }, cfg);\n};\n// 交互\nexport var bindStateEvents = function (graph, cfg) {\n    var _a = cfg !== null && cfg !== void 0 ? cfg : {}, _b = _a.nodeCfg, nodeCfg = _b === void 0 ? {} : _b, _c = _a.edgeCfg, edgeCfg = _c === void 0 ? {} : _c;\n    var nodeStateStyles = nodeCfg.nodeStateStyles;\n    var edgeStateStyles = edgeCfg.edgeStateStyles;\n    /**\n     * 存储交互状态\n     * id: [[endActive, endDefalut], [startActive, startDefalut]]\n     */\n    var statusCache = {};\n    var updateArrowFill = function (item, endArrowFill, stratArrowFill) {\n        graph.updateItem(item, {\n            style: {\n                endArrow: !!endArrowFill && {\n                    fill: endArrowFill,\n                },\n                startArrow: !!stratArrowFill && {\n                    fill: stratArrowFill,\n                },\n            },\n        });\n    };\n    var setState = function (item, name, status) {\n        var _a, _b, _c;\n        status ? item.toFront() : item.toBack();\n        var _d = (_a = item.getModel().style) !== null && _a !== void 0 ? _a : {}, endArrow = _d.endArrow, startArrow = _d.startArrow;\n        if (endArrow || startArrow) {\n            if (!statusCache[item.getID()]) {\n                // @ts-ignore\n                var endArrowFill = (endArrow !== null && endArrow !== void 0 ? endArrow : {}).fill;\n                // @ts-ignore\n                var startArrowFill = (startArrow !== null && startArrow !== void 0 ? startArrow : {}).fill;\n                var hoverStatus = (_c = (_b = item.getModel().style) === null || _b === void 0 ? void 0 : _b[name]) === null || _c === void 0 ? void 0 : _c.stroke;\n                statusCache[item.getID()] = [\n                    [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : endArrowFill, endArrowFill],\n                    [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : startArrowFill, startArrowFill],\n                ];\n            }\n            var fill = statusCache[item.getID()];\n            updateArrowFill(item, endArrow && fill[0][status ? 0 : 1], startArrow && fill[1][status ? 0 : 1]);\n        }\n        graph.setItemState(item, name, status);\n    };\n    var getRelationItems = function (currentItem, name, status, type) {\n        var relationItems = type === 'node'\n            ? graph.findAll('edge', function (edge) { return edge.getSource() === currentItem || edge.getTarget() === currentItem; })\n            : graph.findAll('node', function (node) {\n                return currentItem.getSource().get('id') === node.get('id') ||\n                    currentItem.getTarget().get('id') === node.get('id');\n            });\n        var highlightItems = [currentItem].concat(relationItems);\n        highlightItems.forEach(function (item) {\n            setState(item, name, status);\n        });\n    };\n    if (nodeStateStyles) {\n        graph.on('node:mouseenter', function (evt) {\n            var item = evt.item;\n            getRelationItems(item, 'hover', true, 'node');\n        });\n        graph.on('node:mouseleave', function (evt) {\n            var item = evt.item;\n            getRelationItems(item, 'hover', false, 'node');\n        });\n    }\n    if (edgeStateStyles) {\n        graph.on('edge:mouseenter', function (evt) {\n            var item = evt.item;\n            getRelationItems(item, 'hover', true, 'edge');\n        });\n        graph.on('edge:mouseleave', function (evt) {\n            var item = evt.item;\n            getRelationItems(item, 'hover', false, 'edge');\n        });\n    }\n};\n// 统一处理 config，支持回调\nexport var getStyle = function (source, cfg, item, current) {\n    if (typeof source === 'function') {\n        return source(cfg, item, current);\n    }\n    return source || {};\n};\n// 统一处理 config，支持回调\nexport var getCommonConfig = function (cfg, item, graph) {\n    if (typeof cfg === 'function') {\n        return cfg(item, graph);\n    }\n    return cfg;\n};\nexport var getSize = function (size) {\n    if (Array.isArray(size)) {\n        return size;\n    }\n    return size ? [size, size] : defaultNodeSize;\n};\n// status bar 的默认宽度\nvar DefaultStatusBarWidth = 4;\n/**\n * card status 对布局的影响，直接加到 padding 中\n */\nexport var getStatusBBox = function (cfg) {\n    if (!cfg) {\n        return [0, 0, 0, 0];\n    }\n    var _a = cfg.size, size = _a === void 0 ? [] : _a, _b = cfg.position, position = _b === void 0 ? 'left' : _b;\n    var _c = getSize(size), width = _c[0], height = _c[1];\n    var appendPadding = [];\n    switch (position) {\n        case 'top':\n            appendPadding.push(height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0, 0, 0);\n            break;\n        case 'right':\n            appendPadding.push(0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth, 0, 0);\n            break;\n        case 'bottom':\n            appendPadding.push(0, 0, height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0);\n            break;\n        case 'left':\n            appendPadding.push(0, 0, 0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth);\n            break;\n    }\n    return appendPadding;\n};\nexport var getStatusCfg = function (cfg, cardSize) {\n    var _a = cfg !== null && cfg !== void 0 ? cfg : {}, _b = _a.size, size = _b === void 0 ? [] : _b, _c = _a.position, position = _c === void 0 ? 'left' : _c;\n    var _d = getSize(size), width = _d[0], height = _d[1];\n    var cardWidth = cardSize[0], cardHeight = cardSize[1];\n    var x = 0;\n    var y = 0;\n    var w = 0;\n    var h = 0;\n    switch (position) {\n        case 'top':\n            x = 0;\n            y = 0;\n            w = width !== null && width !== void 0 ? width : cardWidth;\n            h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n            break;\n        case 'left':\n            x = 0;\n            y = 0;\n            w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n            h = height !== null && height !== void 0 ? height : cardHeight;\n            break;\n        case 'right':\n            x = cardWidth - (isNumber(width) ? width : DefaultStatusBarWidth);\n            y = 0;\n            w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n            h = height !== null && height !== void 0 ? height : cardHeight;\n            break;\n        case 'bottom':\n            x = 0;\n            y = cardHeight - (isNumber(height) ? height : DefaultStatusBarWidth);\n            w = width !== null && width !== void 0 ? width : cardWidth;\n            h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n            break;\n    }\n    return {\n        x: x,\n        y: y,\n        width: w,\n        height: h,\n    };\n};\nexport var createMarker = function (cfg, group, size) {\n    var show = cfg.show, position = cfg.position, collapsed = cfg.collapsed, style = cfg.style;\n    if (show) {\n        group.addShape('marker', {\n            attrs: __assign(__assign(__assign({}, getMarkerPosition(position, size)), { r: 6, cursor: 'pointer', symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse, stroke: defaultCardStyle.stroke, lineWidth: 1, fill: '#fff' }), style),\n            defaultCollapsed: false,\n            name: 'collapse-icon',\n        });\n    }\n};\nexport var cloneBesidesImg = function (obj) {\n    var clonedObj = {};\n    Object.keys(obj).forEach(function (key1) {\n        var obj2 = obj[key1];\n        if (isObject(obj2)) {\n            var clonedObj2_1 = {};\n            Object.keys(obj2).forEach(function (key2) {\n                var v = obj2[key2];\n                if (key2 === 'img' && !isString(v))\n                    return;\n                clonedObj2_1[key2] = clone(v);\n            });\n            clonedObj[key1] = clonedObj2_1;\n        }\n        else {\n            clonedObj[key1] = clone(obj2);\n        }\n    });\n    return clonedObj;\n};\nexport var setStyles = function (container, style) {\n    if (style === void 0) { style = {}; }\n    var keys = Object.keys(style);\n    keys.forEach(function (key) {\n        container.style[key] = style[key];\n    });\n};\n/**\n * 对数据进行打标，加上 level 和  parentId\n */\nexport var setTag = function (data, level, parentId, path) {\n    var _a;\n    if (level === void 0) { level = 0; }\n    if (parentId === void 0) { parentId = ''; }\n    if (path === void 0) { path = ''; }\n    var id = data.id, _b = data.children, children = _b === void 0 ? [] : _b;\n    return __assign(__assign((_a = {}, _a[\"\".concat(prefix, \"_level\")] = level, _a[\"\".concat(prefix, \"_parentId\")] = parentId, _a[\"\".concat(prefix, \"_currentPath\")] = path, _a), data), { children: children === null || children === void 0 ? void 0 : children.map(function (item, index) {\n            return setTag(item, level + 1, parentId ? \"\".concat(parentId, \"-\").concat(id) : id, \"\".concat(path, \"-\").concat(index));\n        }) });\n};\n/**\n * 根据 level 获取相关数据\n */\nexport var getLevelData = function (data, level) {\n    var _a = data.children, children = _a === void 0 ? [] : _a, _b = data.g_level, g_level = _b === void 0 ? 0 : _b;\n    if (level <= 0) {\n        return data;\n    }\n    return __assign(__assign({}, data), { children: g_level + 1 < level\n            ? children === null || children === void 0 ? void 0 : children.map(function (item) {\n                return getLevelData(item, level);\n            })\n            : [] });\n};\n/**\n * 挂载异步数据到全局 data\n */\nexport var setLevelData = function (graph, data, currentPath) {\n    var currentData = graph.get('eventData').getData();\n    // 打标时已经做了编码，这直接取值即可\n    var path = currentPath.split('-');\n    path.shift(); // 根节点没有 path\n    var current = currentData;\n    path.forEach(function (childrenIndex) {\n        current = current.children[Number(childrenIndex)];\n    });\n    current.children = data;\n};\n/**\n * get children\n * 获取相关路径下的一级节点\n */\nexport var getChildrenData = function (data, currentPath) {\n    // 打标时已经做了编码，这直接取值即可\n    var path = currentPath.split('-');\n    path.shift(); // 根节点没有 path\n    var current = data;\n    path.forEach(function (childrenIndex) {\n        current = current.children[Number(childrenIndex)];\n    });\n    if (!(current === null || current === void 0 ? void 0 : current.children)) {\n        return [];\n    }\n    return current.children.map(function (item) { return (__assign(__assign({}, item), { children: [] })); });\n};\n/**\n * 将查询到的节点挂载到当前图数据上\n */\nexport var setParentChildren = function (parendData, currentPath, children) {\n    var path = currentPath.split('-');\n    path.shift();\n    var current = parendData;\n    path.forEach(function (childrenIndex) {\n        current = current.children[Number(childrenIndex)];\n    });\n    current.children = children;\n    return parendData;\n};\n/** 超出省略 */\nexport var setEllipsis = function (text, fontSize, contentWidth) {\n    if (fontSize === void 0) { fontSize = 12; }\n    if (contentWidth === void 0) { contentWidth = 120; }\n    var size = isNumber(fontSize) ? fontSize : Number(fontSize.replace('px', ''));\n    var maxWords = Math.floor(contentWidth / size);\n    if (text.length <= maxWords) {\n        return text;\n    }\n    return text.slice(0, maxWords - 1) + '...';\n};\n/** 开启加载动画， 不支持同时存在多个 */\nexport var createLoading = function () {\n    var container = document.createElement('div');\n    container.className = \"\".concat(prefix, \"-antd-loading\");\n    var styles = {\n        position: 'fixed',\n        left: '0',\n        top: '0',\n        width: '100vw',\n        height: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'rgba(0,0,0, 0.25)',\n        color: '#fff',\n        fontSize: '16px',\n        zIndex: 999,\n    };\n    var span = document.createElement('span');\n    span.innerText = 'loading...';\n    setStyles(container, styles);\n    container.appendChild(span);\n    document.body.appendChild(container);\n};\n/** 关闭加载动画 */\nexport var closeLoading = function () {\n    var hideContainer = document.getElementsByClassName(\"\".concat(prefix, \"-antd-loading\"));\n    Array.from(hideContainer).forEach(function (el) {\n        document.body.removeChild(el);\n    });\n};\n"]},"metadata":{},"sourceType":"module"}