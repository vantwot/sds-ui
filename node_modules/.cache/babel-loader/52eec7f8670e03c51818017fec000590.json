{"ast":null,"code":"import _regeneratorRuntime from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _classCallCheck from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport classnames from 'classnames';\nimport { IHookContribution, ManaSyringe } from '@antv/xflow-core';\nimport { IGraphProvider } from '@antv/xflow-core';\nimport { ACTIVE_NODE_PORT, NsPortEvent } from '../interface';\nimport { DisposableCollection, IModelContribution, Disposable } from '@antv/xflow-core';\n/**\n * 内置的hook contribution\n * 处理 config上的runtime的注册项\n */\n\nvar NodePortTooltipContribution = /*#__PURE__*/function () {\n  function NodePortTooltipContribution() {\n    var _this = this;\n\n    _classCallCheck(this, NodePortTooltipContribution);\n\n    this.toDispose = new DisposableCollection();\n    /** 获取画布实例 */\n\n    this.getGraphInstance = function () {\n      return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var graphInstance, graphConfig;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.graphProvider.getGraphInstance();\n\n              case 2:\n                graphInstance = _context.sent;\n                _context.next = 5;\n                return this.graphProvider.getGraphOptions();\n\n              case 5:\n                graphConfig = _context.sent;\n                return _context.abrupt(\"return\", {\n                  graph: graphInstance,\n                  config: graphConfig\n                });\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    };\n    /** 获取GraphOptions */\n\n\n    this.getPortRenderConfig = function () {\n      var dagOptions = {\n        onPortRendered: function onPortRendered(portRenderedArgs) {\n          var _a, _b;\n          /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n\n\n          var graph = this;\n          var port = portRenderedArgs.port,\n              node = portRenderedArgs.node;\n          var contentSelectors = portRenderedArgs.contentSelectors;\n          var portContainer = contentSelectors && contentSelectors['xflow-port-group'];\n\n          if (portContainer instanceof Element) {\n            portContainer.setAttribute('class', classnames('xflow-port-group', {\n              connected: port.connected && port.group !== 'out',\n              groupPort: ((_a = node) === null || _a === void 0 ? void 0 : _a.isGroup) && ((_b = node) === null || _b === void 0 ? void 0 : _b.isGroup())\n            }));\n            portContainer.addEventListener('mouseenter', function (e) {\n              var eventArgs = {\n                e: e,\n                portId: port.id,\n                nodeId: node.id,\n                portData: port,\n                nodeData: node.getData(),\n                tooltip: port.tooltip,\n                placement: port.group\n              };\n              graph.trigger(NsPortEvent.MOUSE_ENTER, eventArgs);\n            });\n            portContainer.addEventListener('mouseleave', function (e) {\n              var eventArgs = {\n                e: e,\n                portId: port.id,\n                nodeId: node.id,\n                portData: port,\n                nodeData: node.getData(),\n                tooltip: port.tooltip,\n                placement: port.group\n              };\n              graph.trigger(NsPortEvent.MOUSE_LEAVE, eventArgs);\n            });\n          }\n        }\n      };\n      return dagOptions;\n    };\n\n    this.registerHookHub = function () {\n      return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", Disposable.create(function () {}));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    };\n\n    this.registerHook = function (hooks) {\n      return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var _this2 = this;\n\n        var toDispose, disposables;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                toDispose = new DisposableCollection();\n                disposables = [hooks.graphOptions.registerHook({\n                  name: 'add onPortRendered options ',\n                  handler: function handler(args) {\n                    return __awaiter(_this2, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                        while (1) {\n                          switch (_context3.prev = _context3.next) {\n                            case 0:\n                              Object.assign(args, this.getPortRenderConfig());\n\n                            case 1:\n                            case \"end\":\n                              return _context3.stop();\n                          }\n                        }\n                      }, _callee3, this);\n                    }));\n                  }\n                })];\n                toDispose.pushAll(disposables);\n                return _context4.abrupt(\"return\", Disposable.create(function () {}));\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n    };\n  }\n\n  _createClass(NodePortTooltipContribution, [{\n    key: \"registerModel\",\n    value: function registerModel(registry) {\n      var _this3 = this;\n\n      registry.registerModel({\n        id: ACTIVE_NODE_PORT.id,\n        watchChange: function watchChange(self) {\n          return __awaiter(_this3, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n            var _yield$this$getGraphI, graph, config, calcPosition, onMouseEnter, onMouseLeave;\n\n            return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n              while (1) {\n                switch (_context5.prev = _context5.next) {\n                  case 0:\n                    _context5.next = 2;\n                    return this.getGraphInstance();\n\n                  case 2:\n                    _yield$this$getGraphI = _context5.sent;\n                    graph = _yield$this$getGraphI.graph;\n                    config = _yield$this$getGraphI.config;\n\n                    calcPosition = function calcPosition(e) {\n                      var _e$target$getBounding = e.target.getBoundingClientRect(),\n                          x = _e$target$getBounding.x,\n                          y = _e$target$getBounding.y,\n                          width = _e$target$getBounding.width,\n                          height = _e$target$getBounding.height;\n\n                      var clientRect = config.rootContainer.getBoundingClientRect();\n                      var position = {\n                        x: x - ((clientRect === null || clientRect === void 0 ? void 0 : clientRect.x) || 0) + width / 2,\n                        y: y - ((clientRect === null || clientRect === void 0 ? void 0 : clientRect.y) || 0) + height / 2\n                      };\n                      return position;\n                    };\n\n                    onMouseEnter = function onMouseEnter(args) {\n                      self.setValue(Object.assign(Object.assign({}, args), {\n                        position: calcPosition(args.e)\n                      }));\n                    };\n\n                    onMouseLeave = function onMouseLeave() {\n                      self.setValue(null);\n                    };\n                    /** 绑定事件 */\n\n\n                    graph.on(NsPortEvent.MOUSE_ENTER, onMouseEnter);\n                    graph.on(NsPortEvent.MOUSE_LEAVE, onMouseLeave);\n                    graph.on('cell:mouseleave', onMouseLeave);\n                    return _context5.abrupt(\"return\", Disposable.create(function () {\n                      /** 解除绑定 */\n                      graph.off(NsPortEvent.MOUSE_ENTER, onMouseEnter);\n                      graph.off(NsPortEvent.MOUSE_LEAVE, onMouseLeave);\n                    }));\n\n                  case 12:\n                  case \"end\":\n                    return _context5.stop();\n                }\n              }\n            }, _callee5, this);\n          }));\n        }\n      });\n    }\n  }]);\n\n  return NodePortTooltipContribution;\n}();\n\n__decorate([ManaSyringe.inject(IGraphProvider), __metadata(\"design:type\", Object)], NodePortTooltipContribution.prototype, \"graphProvider\", void 0);\n\nNodePortTooltipContribution = __decorate([ManaSyringe.singleton({\n  contrib: [IHookContribution, IModelContribution]\n})], NodePortTooltipContribution);\nexport { NodePortTooltipContribution };","map":{"version":3,"sources":["../../../src/canvas-node-port-tooltip/contributions/node-port.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,OAAO,UAAP,MAAuB,YAAvB;AACA,SAAS,iBAAT,EAA4B,WAA5B,QAA+C,kBAA/C;AACA,SAAS,cAAT,QAA+B,kBAA/B;AACA,SAAS,gBAAT,EAA2B,WAA3B,QAA8C,cAA9C;AACA,SAAS,oBAAT,EAA+B,kBAA/B,EAAmD,UAAnD,QAAqE,kBAArE;AAEA;;;AAGG;;AAEH,IAAa,2BAAb;AAAA,yCAAA;AAAA;;AAAA;;AAEE,SAAA,SAAA,GAAY,IAAI,oBAAJ,EAAZ;AAKA;;AACA,SAAA,gBAAA,GAAmB;AAAA,aAAW,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACN,uBAAM,KAAK,aAAL,CAAmB,gBAAnB,EAAN;;AADM;AACtB,gBAAA,aADsB;AAAA;AAER,uBAAM,KAAK,aAAL,CAAmB,eAAnB,EAAN;;AAFQ;AAEtB,gBAAA,WAFsB;AAAA,iDAGrB;AAAE,kBAAA,KAAK,EAAE,aAAT;AAAwB,kBAAA,MAAM,EAAE;AAAhC,iBAHqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA,EAAX;AAAA,KAAnB;AAMA;;;AACA,SAAA,mBAAA,GAAsB,YAAK;AACzB,UAAM,UAAU,GAAkB;AAChC,QAAA,cADgC,0BACjB,gBADiB,EACD;;AAC7B;;;AACA,cAAM,KAAK,GAAG,IAAd;AACA,cAAQ,IAAR,GAAuB,gBAAvB,CAAQ,IAAR;AAAA,cAAc,IAAd,GAAuB,gBAAvB,CAAc,IAAd;AACA,cAAQ,gBAAR,GAA6B,gBAA7B,CAAQ,gBAAR;AACA,cAAM,aAAa,GAAG,gBAAgB,IAAI,gBAAgB,CAAC,kBAAD,CAA1D;;AACA,cAAI,aAAa,YAAY,OAA7B,EAAsC;AACpC,YAAA,aAAa,CAAC,YAAd,CACE,OADF,EAEE,UAAU,CAAC,kBAAD,EAAqB;AAC7B,cAAA,SAAS,EAAG,IAAY,CAAC,SAAb,IAA0B,IAAI,CAAC,KAAL,KAAe,KADxB;AAE7B,cAAA,SAAS,EAAE,CAAA,CAAA,EAAA,GAAC,IAAD,MAAa,IAAb,IAAa,EAAA,KAAA,KAAA,CAAb,GAAa,KAAA,CAAb,GAAa,EAAA,CAAE,OAAf,MAA0B,CAAA,EAAA,GAAC,IAAD,MAAa,IAAb,IAAa,EAAA,KAAA,KAAA,CAAb,GAAa,KAAA,CAAb,GAAa,EAAA,CAAE,OAAF,EAAvC;AAFkB,aAArB,CAFZ;AAOA,YAAA,aAAa,CAAC,gBAAd,CAA+B,YAA/B,EAA6C,UAAA,CAAC,EAAG;AAC/C,kBAAM,SAAS,GAA2B;AACxC,gBAAA,CAAC,EAAE,CADqC;AAExC,gBAAA,MAAM,EAAE,IAAI,CAAC,EAF2B;AAGxC,gBAAA,MAAM,EAAE,IAAI,CAAC,EAH2B;AAIxC,gBAAA,QAAQ,EAAE,IAJ8B;AAKxC,gBAAA,QAAQ,EAAE,IAAI,CAAC,OAAL,EAL8B;AAMxC,gBAAA,OAAO,EAAG,IAA4B,CAAC,OANC;AAOxC,gBAAA,SAAS,EAAE,IAAI,CAAC;AAPwB,eAA1C;AASA,cAAA,KAAK,CAAC,OAAN,CAAc,WAAW,CAAC,WAA1B,EAAuC,SAAvC;AACD,aAXD;AAYA,YAAA,aAAa,CAAC,gBAAd,CAA+B,YAA/B,EAA6C,UAAA,CAAC,EAAG;AAC/C,kBAAM,SAAS,GAA2B;AACxC,gBAAA,CAAC,EAAE,CADqC;AAExC,gBAAA,MAAM,EAAE,IAAI,CAAC,EAF2B;AAGxC,gBAAA,MAAM,EAAE,IAAI,CAAC,EAH2B;AAIxC,gBAAA,QAAQ,EAAE,IAJ8B;AAKxC,gBAAA,QAAQ,EAAE,IAAI,CAAC,OAAL,EAL8B;AAMxC,gBAAA,OAAO,EAAG,IAA4B,CAAC,OANC;AAOxC,gBAAA,SAAS,EAAE,IAAI,CAAC;AAPwB,eAA1C;AASA,cAAA,KAAK,CAAC,OAAN,CAAc,WAAW,CAAC,WAA1B,EAAuC,SAAvC;AACD,aAXD;AAYD;AACF;AAxC+B,OAAlC;AA0CA,aAAO,UAAP;AACD,KA5CD;;AA8CA,SAAA,eAAA,GAAkB;AAAA,aAAW,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDACpB,UAAU,CAAC,MAAX,CAAkB,YAAK,CAAG,CAA1B,CADoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA,EAAX;AAAA,KAAlB;;AAIA,SAAA,YAAA,GAAe,UAAO,KAAP;AAAA,aAA2B,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAClC,gBAAA,SADkC,GACtB,IAAI,oBAAJ,EADsB;AAElC,gBAAA,WAFkC,GAEpB,CAClB,KAAK,CAAC,YAAN,CAAmB,YAAnB,CAAgC;AAC9B,kBAAA,IAAI,EAAE,6BADwB;AAE9B,kBAAA,OAAO,EAAE,iBAAM,IAAN;AAAA,2BAAa,SAAA,CAAA,MAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;AAAA;AAAA;AAAA;AACpB,8BAAA,MAAM,CAAC,MAAP,CAAc,IAAd,EAAoB,KAAK,mBAAL,EAApB;;AADoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAA,EAAb;AAAA;AAFqB,iBAAhC,CADkB,CAFoB;AAUxC,gBAAA,SAAS,CAAC,OAAV,CAAkB,WAAlB;AAVwC,kDAWjC,UAAU,CAAC,MAAX,CAAkB,YAAK,CAAG,CAA1B,CAXiC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA,EAA3B;AAAA,KAAf;AAsDD;;AAvHD;AAAA;AAAA,WA+EE,uBAAc,QAAd,EAAqC;AAAA;;AACnC,MAAA,QAAQ,CAAC,aAAT,CAAgD;AAC9C,QAAA,EAAE,EAAE,gBAAgB,CAAC,EADyB;AAE9C,QAAA,WAAW,EAAE,qBAAM,IAAN;AAAA,iBAAa,SAAA,CAAA,MAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,2BAAM,KAAK,gBAAL,EAAN;;AADF;AAAA;AAChB,oBAAA,KADgB,yBAChB,KADgB;AACT,oBAAA,MADS,yBACT,MADS;;AAGlB,oBAAA,YAHkB,GAGH,SAAf,YAAe,CAAC,CAAD,EAAkB;AACrC,kDAAiC,CAAC,CAAC,MAAF,CAAyB,qBAAzB,EAAjC;AAAA,0BAAQ,CAAR,yBAAQ,CAAR;AAAA,0BAAW,CAAX,yBAAW,CAAX;AAAA,0BAAc,KAAd,yBAAc,KAAd;AAAA,0BAAqB,MAArB,yBAAqB,MAArB;;AACA,0BAAM,UAAU,GAAG,MAAM,CAAC,aAAP,CAAqB,qBAArB,EAAnB;AACA,0BAAM,QAAQ,GAAG;AACf,wBAAA,CAAC,EAAE,CAAC,IAAI,CAAA,UAAU,KAAA,IAAV,IAAA,UAAU,KAAA,KAAA,CAAV,GAAU,KAAA,CAAV,GAAA,UAAU,CAAE,CAAZ,KAAiB,CAArB,CAAD,GAA2B,KAAK,GAAG,CADvB;AAEf,wBAAA,CAAC,EAAE,CAAC,IAAI,CAAA,UAAU,KAAA,IAAV,IAAA,UAAU,KAAA,KAAA,CAAV,GAAU,KAAA,CAAV,GAAA,UAAU,CAAE,CAAZ,KAAiB,CAArB,CAAD,GAA2B,MAAM,GAAG;AAFxB,uBAAjB;AAIA,6BAAO,QAAP;AACD,qBAXuB;;AAalB,oBAAA,YAbkB,GAaH,SAAf,YAAe,CAAC,IAAD,EAAiC;AACpD,sBAAA,IAAI,CAAC,QAAL,CAAa,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EACR,IADQ,CAAA,EACJ;AACP,wBAAA,QAAQ,EAAE,YAAY,CAAC,IAAI,CAAC,CAAN;AADf,uBADI,CAAb;AAID,qBAlBuB;;AAoBlB,oBAAA,YApBkB,GAoBH,SAAf,YAAe,GAAK;AACxB,sBAAA,IAAI,CAAC,QAAL,CAAc,IAAd;AACD,qBAtBuB;AAwBxB;;;AACA,oBAAA,KAAK,CAAC,EAAN,CAAS,WAAW,CAAC,WAArB,EAAkC,YAAlC;AACA,oBAAA,KAAK,CAAC,EAAN,CAAS,WAAW,CAAC,WAArB,EAAkC,YAAlC;AACA,oBAAA,KAAK,CAAC,EAAN,CAAS,iBAAT,EAA4B,YAA5B;AA3BwB,sDA6BjB,UAAU,CAAC,MAAX,CAAkB,YAAK;AAC5B;AACA,sBAAA,KAAK,CAAC,GAAN,CAAU,WAAW,CAAC,WAAtB,EAAmC,YAAnC;AACA,sBAAA,KAAK,CAAC,GAAN,CAAU,WAAW,CAAC,WAAtB,EAAmC,YAAnC;AACD,qBAJM,CA7BiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAA,EAAb;AAAA;AAFiC,OAAhD;AAsCD;AAtHH;;AAAA;AAAA,GAAA;;AAKE,UAAA,CAAA,CADC,WAAW,CAAC,MAAZ,CAAmB,cAAnB,CACD,E,iCAAA,CAAA,E,qCAAA,E,eAAA,E,KAAgD,CAAhD,CAAA;;AALW,2BAA2B,GAAA,UAAA,CAAA,CADvC,WAAW,CAAC,SAAZ,CAAsB;AAAE,EAAA,OAAO,EAAE,CAAC,iBAAD,EAAoB,kBAApB;AAAX,CAAtB,CACuC,CAAA,EAA3B,2BAA2B,CAA3B;SAAA,2B","sourceRoot":"","sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport classnames from 'classnames';\nimport { IHookContribution, ManaSyringe } from '@antv/xflow-core';\nimport { IGraphProvider } from '@antv/xflow-core';\nimport { ACTIVE_NODE_PORT, NsPortEvent } from '../interface';\nimport { DisposableCollection, IModelContribution, Disposable } from '@antv/xflow-core';\n/**\n * 内置的hook contribution\n * 处理 config上的runtime的注册项\n */\nlet NodePortTooltipContribution = class NodePortTooltipContribution {\n    constructor() {\n        this.toDispose = new DisposableCollection();\n        /** 获取画布实例 */\n        this.getGraphInstance = () => __awaiter(this, void 0, void 0, function* () {\n            const graphInstance = yield this.graphProvider.getGraphInstance();\n            const graphConfig = yield this.graphProvider.getGraphOptions();\n            return { graph: graphInstance, config: graphConfig };\n        });\n        /** 获取GraphOptions */\n        this.getPortRenderConfig = () => {\n            const dagOptions = {\n                onPortRendered(portRenderedArgs) {\n                    var _a, _b;\n                    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n                    const graph = this;\n                    const { port, node } = portRenderedArgs;\n                    const { contentSelectors } = portRenderedArgs;\n                    const portContainer = contentSelectors && contentSelectors['xflow-port-group'];\n                    if (portContainer instanceof Element) {\n                        portContainer.setAttribute('class', classnames('xflow-port-group', {\n                            connected: port.connected && port.group !== 'out',\n                            groupPort: ((_a = node) === null || _a === void 0 ? void 0 : _a.isGroup) && ((_b = node) === null || _b === void 0 ? void 0 : _b.isGroup()),\n                        }));\n                        portContainer.addEventListener('mouseenter', e => {\n                            const eventArgs = {\n                                e: e,\n                                portId: port.id,\n                                nodeId: node.id,\n                                portData: port,\n                                nodeData: node.getData(),\n                                tooltip: port.tooltip,\n                                placement: port.group,\n                            };\n                            graph.trigger(NsPortEvent.MOUSE_ENTER, eventArgs);\n                        });\n                        portContainer.addEventListener('mouseleave', e => {\n                            const eventArgs = {\n                                e: e,\n                                portId: port.id,\n                                nodeId: node.id,\n                                portData: port,\n                                nodeData: node.getData(),\n                                tooltip: port.tooltip,\n                                placement: port.group,\n                            };\n                            graph.trigger(NsPortEvent.MOUSE_LEAVE, eventArgs);\n                        });\n                    }\n                },\n            };\n            return dagOptions;\n        };\n        this.registerHookHub = () => __awaiter(this, void 0, void 0, function* () {\n            return Disposable.create(() => { });\n        });\n        this.registerHook = (hooks) => __awaiter(this, void 0, void 0, function* () {\n            const toDispose = new DisposableCollection();\n            const disposables = [\n                hooks.graphOptions.registerHook({\n                    name: 'add onPortRendered options ',\n                    handler: (args) => __awaiter(this, void 0, void 0, function* () {\n                        Object.assign(args, this.getPortRenderConfig());\n                    }),\n                }),\n            ];\n            toDispose.pushAll(disposables);\n            return Disposable.create(() => { });\n        });\n    }\n    registerModel(registry) {\n        registry.registerModel({\n            id: ACTIVE_NODE_PORT.id,\n            watchChange: (self) => __awaiter(this, void 0, void 0, function* () {\n                const { graph, config } = yield this.getGraphInstance();\n                const calcPosition = (e) => {\n                    const { x, y, width, height } = e.target.getBoundingClientRect();\n                    const clientRect = config.rootContainer.getBoundingClientRect();\n                    const position = {\n                        x: x - ((clientRect === null || clientRect === void 0 ? void 0 : clientRect.x) || 0) + width / 2,\n                        y: y - ((clientRect === null || clientRect === void 0 ? void 0 : clientRect.y) || 0) + height / 2,\n                    };\n                    return position;\n                };\n                const onMouseEnter = (args) => {\n                    self.setValue(Object.assign(Object.assign({}, args), { position: calcPosition(args.e) }));\n                };\n                const onMouseLeave = () => {\n                    self.setValue(null);\n                };\n                /** 绑定事件 */\n                graph.on(NsPortEvent.MOUSE_ENTER, onMouseEnter);\n                graph.on(NsPortEvent.MOUSE_LEAVE, onMouseLeave);\n                graph.on('cell:mouseleave', onMouseLeave);\n                return Disposable.create(() => {\n                    /** 解除绑定 */\n                    graph.off(NsPortEvent.MOUSE_ENTER, onMouseEnter);\n                    graph.off(NsPortEvent.MOUSE_LEAVE, onMouseLeave);\n                });\n            }),\n        });\n    }\n};\n__decorate([\n    ManaSyringe.inject(IGraphProvider),\n    __metadata(\"design:type\", Object)\n], NodePortTooltipContribution.prototype, \"graphProvider\", void 0);\nNodePortTooltipContribution = __decorate([\n    ManaSyringe.singleton({ contrib: [IHookContribution, IModelContribution] })\n], NodePortTooltipContribution);\nexport { NodePortTooltipContribution };\n//# sourceMappingURL=node-port.js.map"]},"metadata":{},"sourceType":"module"}