{"ast":null,"code":"import _classCallCheck from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { StringExt, Dom, Vector } from '../util';\nimport { Filter } from '../registry';\nimport { Markup } from '../view';\nimport { Base } from './base';\nexport var DefsManager = /*#__PURE__*/function (_Base) {\n  _inherits(DefsManager, _Base);\n\n  var _super = _createSuper(DefsManager);\n\n  function DefsManager() {\n    _classCallCheck(this, DefsManager);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(DefsManager, [{\n    key: \"cid\",\n    get: function get() {\n      return this.graph.view.cid;\n    }\n  }, {\n    key: \"svg\",\n    get: function get() {\n      return this.view.svg;\n    }\n  }, {\n    key: \"defs\",\n    get: function get() {\n      return this.view.defs;\n    }\n  }, {\n    key: \"isDefined\",\n    value: function isDefined(id) {\n      return this.svg.getElementById(id) != null;\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(options) {\n      var filterId = options.id;\n      var name = options.name;\n\n      if (!filterId) {\n        filterId = \"filter-\".concat(name, \"-\").concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(filterId)) {\n        var fn = Filter.registry.get(name);\n\n        if (fn == null) {\n          return Filter.registry.onNotFound(name);\n        }\n\n        var markup = fn(options.args || {}); // Set the filter area to be 3x the bounding box of the cell\n        // and center the filter around the cell.\n\n        var attrs = Object.assign(Object.assign({\n          x: -1,\n          y: -1,\n          width: 3,\n          height: 3,\n          filterUnits: 'objectBoundingBox'\n        }, options.attrs), {\n          id: filterId\n        });\n        Vector.create(Markup.sanitize(markup), attrs).appendTo(this.defs);\n      }\n\n      return filterId;\n    }\n  }, {\n    key: \"gradient\",\n    value: function gradient(options) {\n      var id = options.id;\n      var type = options.type;\n\n      if (!id) {\n        id = \"gradient-\".concat(type, \"-\").concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(id)) {\n        var stops = options.stops;\n        var arr = stops.map(function (stop) {\n          var opacity = stop.opacity != null && Number.isFinite(stop.opacity) ? stop.opacity : 1;\n          return \"<stop offset=\\\"\".concat(stop.offset, \"\\\" stop-color=\\\"\").concat(stop.color, \"\\\" stop-opacity=\\\"\").concat(opacity, \"\\\"/>\");\n        });\n        var markup = \"<\".concat(type, \">\").concat(arr.join(''), \"</\").concat(type, \">\");\n        var attrs = Object.assign({\n          id: id\n        }, options.attrs);\n        Vector.create(markup, attrs).appendTo(this.defs);\n      }\n\n      return id;\n    }\n  }, {\n    key: \"marker\",\n    value: function marker(options) {\n      var id = options.id,\n          refX = options.refX,\n          refY = options.refY,\n          markerUnits = options.markerUnits,\n          markerOrient = options.markerOrient,\n          tagName = options.tagName,\n          children = options.children,\n          attrs = __rest(options, [\"id\", \"refX\", \"refY\", \"markerUnits\", \"markerOrient\", \"tagName\", \"children\"]);\n\n      var markerId = id;\n\n      if (!markerId) {\n        markerId = \"marker-\".concat(this.cid, \"-\").concat(StringExt.hashcode(JSON.stringify(options)));\n      }\n\n      if (!this.isDefined(markerId)) {\n        if (tagName !== 'path') {\n          // remove unnecessary d attribute inherit from standard edge.\n          delete attrs.d;\n        }\n\n        var pathMarker = Vector.create('marker', {\n          refX: refX,\n          refY: refY,\n          id: markerId,\n          overflow: 'visible',\n          orient: markerOrient != null ? markerOrient : 'auto',\n          markerUnits: markerUnits || 'userSpaceOnUse'\n        }, children ? children.map(function (_a) {\n          var tagName = _a.tagName,\n              other = __rest(_a, [\"tagName\"]);\n\n          return Vector.create(\"\".concat(tagName) || 'path', Dom.kebablizeAttrs(Object.assign(Object.assign({}, attrs), other)));\n        }) : [Vector.create(tagName || 'path', Dom.kebablizeAttrs(attrs))]);\n        this.defs.appendChild(pathMarker.node);\n      }\n\n      return markerId;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(id) {\n      var elem = this.svg.getElementById(id);\n\n      if (elem && elem.parentNode) {\n        elem.parentNode.removeChild(elem);\n      }\n    }\n  }]);\n\n  return DefsManager;\n}(Base);","map":{"version":3,"sources":["../../src/graph/defs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,SAAS,SAAT,EAAoB,GAApB,EAAyB,MAAzB,QAAuC,SAAvC;AACA,SAAe,MAAf,QAAqC,aAArC;AACA,SAAS,MAAT,QAAuB,SAAvB;AACA,SAAS,IAAT,QAAqB,QAArB;AAEA,WAAa,WAAb;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,SACE,eAAiB;AACf,aAAO,KAAK,KAAL,CAAW,IAAX,CAAgB,GAAvB;AACD;AAHH;AAAA;AAAA,SAKE,eAAiB;AACf,aAAO,KAAK,IAAL,CAAU,GAAjB;AACD;AAPH;AAAA;AAAA,SASE,eAAkB;AAChB,aAAO,KAAK,IAAL,CAAU,IAAjB;AACD;AAXH;AAAA;AAAA,WAaY,mBAAU,EAAV,EAAoB;AAC5B,aAAO,KAAK,GAAL,CAAS,cAAT,CAAwB,EAAxB,KAA+B,IAAtC;AACD;AAfH;AAAA;AAAA,WAiBE,gBAAO,OAAP,EAAyC;AACvC,UAAI,QAAQ,GAAG,OAAO,CAAC,EAAvB;AACA,UAAM,IAAI,GAAG,OAAO,CAAC,IAArB;;AACA,UAAI,CAAC,QAAL,EAAe;AACb,QAAA,QAAQ,oBAAa,IAAb,cAAqB,KAAK,GAA1B,cAAiC,SAAS,CAAC,QAAV,CACvC,IAAI,CAAC,SAAL,CAAe,OAAf,CADuC,CAAjC,CAAR;AAGD;;AAED,UAAI,CAAC,KAAK,SAAL,CAAe,QAAf,CAAL,EAA+B;AAC7B,YAAM,EAAE,GAAG,MAAM,CAAC,QAAP,CAAgB,GAAhB,CAAoB,IAApB,CAAX;;AACA,YAAI,EAAE,IAAI,IAAV,EAAgB;AACd,iBAAO,MAAM,CAAC,QAAP,CAAgB,UAAhB,CAA2B,IAA3B,CAAP;AACD;;AAED,YAAM,MAAM,GAAG,EAAE,CAAC,OAAO,CAAC,IAAR,IAAgB,EAAjB,CAAjB,CAN6B,CAQ7B;AACA;;AACA,YAAM,KAAK,GAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA;AACT,UAAA,CAAC,EAAE,CAAC,CADK;AAET,UAAA,CAAC,EAAE,CAAC,CAFK;AAGT,UAAA,KAAK,EAAE,CAHE;AAIT,UAAA,MAAM,EAAE,CAJC;AAKT,UAAA,WAAW,EAAE;AALJ,SAAA,EAMN,OAAO,CAAC,KANF,CAAA,EAMO;AAChB,UAAA,EAAE,EAAE;AADY,SANP,CAAX;AASA,QAAA,MAAM,CAAC,MAAP,CAAc,MAAM,CAAC,QAAP,CAAgB,MAAhB,CAAd,EAAuC,KAAvC,EAA8C,QAA9C,CAAuD,KAAK,IAA5D;AACD;;AAED,aAAO,QAAP;AACD;AAjDH;AAAA;AAAA,WAmDE,kBAAS,OAAT,EAA6C;AAC3C,UAAI,EAAE,GAAG,OAAO,CAAC,EAAjB;AACA,UAAM,IAAI,GAAG,OAAO,CAAC,IAArB;;AACA,UAAI,CAAC,EAAL,EAAS;AACP,QAAA,EAAE,sBAAe,IAAf,cAAuB,KAAK,GAA5B,cAAmC,SAAS,CAAC,QAAV,CACnC,IAAI,CAAC,SAAL,CAAe,OAAf,CADmC,CAAnC,CAAF;AAGD;;AAED,UAAI,CAAC,KAAK,SAAL,CAAe,EAAf,CAAL,EAAyB;AACvB,YAAM,KAAK,GAAG,OAAO,CAAC,KAAtB;AACA,YAAM,GAAG,GAAG,KAAK,CAAC,GAAN,CAAU,UAAC,IAAD,EAAS;AAC7B,cAAM,OAAO,GACX,IAAI,CAAC,OAAL,IAAgB,IAAhB,IAAwB,MAAM,CAAC,QAAP,CAAgB,IAAI,CAAC,OAArB,CAAxB,GACI,IAAI,CAAC,OADT,GAEI,CAHN;AAKA,0CAAwB,IAAI,CAAC,MAA7B,6BAAoD,IAAI,CAAC,KAAzD,+BAAiF,OAAjF;AACD,SAPW,CAAZ;AASA,YAAM,MAAM,cAAO,IAAP,cAAe,GAAG,CAAC,IAAJ,CAAS,EAAT,CAAf,eAAgC,IAAhC,MAAZ;AACA,YAAM,KAAK,GAAA,MAAA,CAAA,MAAA,CAAA;AAAK,UAAA,EAAE,EAAF;AAAL,SAAA,EAAY,OAAO,CAAC,KAApB,CAAX;AACA,QAAA,MAAM,CAAC,MAAP,CAAc,MAAd,EAAsB,KAAtB,EAA6B,QAA7B,CAAsC,KAAK,IAA3C;AACD;;AAED,aAAO,EAAP;AACD;AA7EH;AAAA;AAAA,WA+EE,gBAAO,OAAP,EAAyC;AACvC,UACE,EADF,GASI,OATJ,CACE,EADF;AAAA,UAEE,IAFF,GASI,OATJ,CAEE,IAFF;AAAA,UAGE,IAHF,GASI,OATJ,CAGE,IAHF;AAAA,UAIE,WAJF,GASI,OATJ,CAIE,WAJF;AAAA,UAKE,YALF,GASI,OATJ,CAKE,YALF;AAAA,UAME,OANF,GASI,OATJ,CAME,OANF;AAAA,UAOE,QAPF,GASI,OATJ,CAOE,QAPF;AAAA,UAQK,KARL,GAQU,MAAA,CACN,OADM,EARJ,CAAA,IAAA,EAAA,MAAA,EAAA,MAAA,EAAA,aAAA,EAAA,cAAA,EAAA,SAAA,EAAA,UAAA,CAQI,CARV;;AAUA,UAAI,QAAQ,GAAG,EAAf;;AACA,UAAI,CAAC,QAAL,EAAe;AACb,QAAA,QAAQ,oBAAa,KAAK,GAAlB,cAAyB,SAAS,CAAC,QAAV,CAC/B,IAAI,CAAC,SAAL,CAAe,OAAf,CAD+B,CAAzB,CAAR;AAGD;;AAED,UAAI,CAAC,KAAK,SAAL,CAAe,QAAf,CAAL,EAA+B;AAC7B,YAAI,OAAO,KAAK,MAAhB,EAAwB;AACtB;AACA,iBAAO,KAAK,CAAC,CAAb;AACD;;AAED,YAAM,UAAU,GAAG,MAAM,CAAC,MAAP,CACjB,QADiB,EAEjB;AACE,UAAA,IAAI,EAAJ,IADF;AAEE,UAAA,IAAI,EAAJ,IAFF;AAGE,UAAA,EAAE,EAAE,QAHN;AAIE,UAAA,QAAQ,EAAE,SAJZ;AAKE,UAAA,MAAM,EAAE,YAAY,IAAI,IAAhB,GAAuB,YAAvB,GAAsC,MALhD;AAME,UAAA,WAAW,EAAE,WAAW,IAAI;AAN9B,SAFiB,EAUjB,QAAQ,GACJ,QAAQ,CAAC,GAAT,CAAa,UAAC,EAAD,EAA0B;AAAzB,cAAE,OAAF,GAAS,EAAT,CAAE,OAAF;AAAA,cAAc,KAAd,GAAmB,MAAA,CAAA,EAAA,EAAnB,CAAA,SAAA,CAAmB,CAAnB;;AACZ,iBAAA,MAAM,CAAC,MAAP,CACE,UAAG,OAAH,KAAgB,MADlB,EAEE,GAAG,CAAC,cAAJ,CAAkB,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EACb,KADa,CAAA,EAEb,KAFa,CAAlB,CAFF,CAAA;AAMC,SAPH,CADI,GAUJ,CAAC,MAAM,CAAC,MAAP,CAAc,OAAO,IAAI,MAAzB,EAAiC,GAAG,CAAC,cAAJ,CAAmB,KAAnB,CAAjC,CAAD,CApBa,CAAnB;AAuBA,aAAK,IAAL,CAAU,WAAV,CAAsB,UAAU,CAAC,IAAjC;AACD;;AAED,aAAO,QAAP;AACD;AAlIH;AAAA;AAAA,WAoIE,gBAAO,EAAP,EAAiB;AACf,UAAM,IAAI,GAAG,KAAK,GAAL,CAAS,cAAT,CAAwB,EAAxB,CAAb;;AACA,UAAI,IAAI,IAAI,IAAI,CAAC,UAAjB,EAA6B;AAC3B,QAAA,IAAI,CAAC,UAAL,CAAgB,WAAhB,CAA4B,IAA5B;AACD;AACF;AAzIH;;AAAA;AAAA,EAAiC,IAAjC","sourceRoot":"","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { StringExt, Dom, Vector } from '../util';\nimport { Filter } from '../registry';\nimport { Markup } from '../view';\nimport { Base } from './base';\nexport class DefsManager extends Base {\n    get cid() {\n        return this.graph.view.cid;\n    }\n    get svg() {\n        return this.view.svg;\n    }\n    get defs() {\n        return this.view.defs;\n    }\n    isDefined(id) {\n        return this.svg.getElementById(id) != null;\n    }\n    filter(options) {\n        let filterId = options.id;\n        const name = options.name;\n        if (!filterId) {\n            filterId = `filter-${name}-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n        }\n        if (!this.isDefined(filterId)) {\n            const fn = Filter.registry.get(name);\n            if (fn == null) {\n                return Filter.registry.onNotFound(name);\n            }\n            const markup = fn(options.args || {});\n            // Set the filter area to be 3x the bounding box of the cell\n            // and center the filter around the cell.\n            const attrs = Object.assign(Object.assign({ x: -1, y: -1, width: 3, height: 3, filterUnits: 'objectBoundingBox' }, options.attrs), { id: filterId });\n            Vector.create(Markup.sanitize(markup), attrs).appendTo(this.defs);\n        }\n        return filterId;\n    }\n    gradient(options) {\n        let id = options.id;\n        const type = options.type;\n        if (!id) {\n            id = `gradient-${type}-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n        }\n        if (!this.isDefined(id)) {\n            const stops = options.stops;\n            const arr = stops.map((stop) => {\n                const opacity = stop.opacity != null && Number.isFinite(stop.opacity)\n                    ? stop.opacity\n                    : 1;\n                return `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\" stop-opacity=\"${opacity}\"/>`;\n            });\n            const markup = `<${type}>${arr.join('')}</${type}>`;\n            const attrs = Object.assign({ id }, options.attrs);\n            Vector.create(markup, attrs).appendTo(this.defs);\n        }\n        return id;\n    }\n    marker(options) {\n        const { id, refX, refY, markerUnits, markerOrient, tagName, children } = options, attrs = __rest(options, [\"id\", \"refX\", \"refY\", \"markerUnits\", \"markerOrient\", \"tagName\", \"children\"]);\n        let markerId = id;\n        if (!markerId) {\n            markerId = `marker-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n        }\n        if (!this.isDefined(markerId)) {\n            if (tagName !== 'path') {\n                // remove unnecessary d attribute inherit from standard edge.\n                delete attrs.d;\n            }\n            const pathMarker = Vector.create('marker', {\n                refX,\n                refY,\n                id: markerId,\n                overflow: 'visible',\n                orient: markerOrient != null ? markerOrient : 'auto',\n                markerUnits: markerUnits || 'userSpaceOnUse',\n            }, children\n                ? children.map((_a) => {\n                    var { tagName } = _a, other = __rest(_a, [\"tagName\"]);\n                    return Vector.create(`${tagName}` || 'path', Dom.kebablizeAttrs(Object.assign(Object.assign({}, attrs), other)));\n                })\n                : [Vector.create(tagName || 'path', Dom.kebablizeAttrs(attrs))]);\n            this.defs.appendChild(pathMarker.node);\n        }\n        return markerId;\n    }\n    remove(id) {\n        const elem = this.svg.getElementById(id);\n        if (elem && elem.parentNode) {\n            elem.parentNode.removeChild(elem);\n        }\n    }\n}\n//# sourceMappingURL=defs.js.map"]},"metadata":{},"sourceType":"module"}