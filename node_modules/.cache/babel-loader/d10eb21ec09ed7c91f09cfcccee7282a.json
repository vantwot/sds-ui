{"ast":null,"code":"import _defineProperty from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\n/* eslint-disable jsx-a11y/click-events-have-key-events  */\n\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classnames from 'classnames';\nimport addEventListener from 'rc-util/lib/Dom/addEventListener';\nimport { MenubarContext } from './context';\nvar cacheDeactiveMap = new WeakMap();\n\nvar MenubarItemInner = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(MenubarItemInner, _React$PureComponent);\n\n  var _super = _createSuper(MenubarItemInner);\n\n  function MenubarItemInner(props) {\n    var _this;\n\n    _classCallCheck(this, MenubarItemInner);\n\n    _this = _super.call(this, props);\n\n    _this.onDocumentClick = function () {\n      _this.deactive();\n    };\n\n    _this.onClick = function (e) {\n      _this.props.context.activeMenubar();\n\n      _this.removeDeactive(e.currentTarget.parentElement);\n\n      _this.active();\n    };\n\n    _this.onMouseEnter = function (e) {\n      if (_this.props.context.menubarActived && !_this.state.active && !_this.isPrevMenuHiddening(e)) {\n        var currentTarget = e.currentTarget;\n        var childNodes = currentTarget.parentElement.childNodes;\n        childNodes.forEach(function (child) {\n          if (child === currentTarget) {\n            _this.removeDeactive(child);\n          } else {\n            _this.callDeactive(child);\n          }\n        });\n\n        _this.active();\n      }\n    };\n\n    _this.onMouseLeave = function (e) {\n      var relatedTarget = e.relatedTarget;\n      var currentTarget = e.currentTarget;\n\n      if (_this.props.context.menubarActived && _this.state.active) {\n        var childNodes = currentTarget.parentElement.childNodes;\n        var shoudDeactive = false;\n\n        if (relatedTarget !== window) {\n          for (var i = 0, l = childNodes.length; i < l; i += 1) {\n            var child = childNodes[i];\n\n            if (child === relatedTarget || child.contains(relatedTarget)) {\n              shoudDeactive = true;\n              break;\n            }\n          }\n        }\n\n        if (shoudDeactive) {\n          _this.deactive();\n        } else {\n          // 缓存一下，当再次 hover 到其他菜单时被调用\n          _this.cacheDeactive(currentTarget);\n        }\n      }\n    };\n\n    _this.active = function () {\n      _this.setState({\n        active: true\n      });\n\n      if (!_this.removeDocClickEvent) {\n        _this.removeDocClickEvent = addEventListener(document.documentElement, 'click', _this.onDocumentClick).remove;\n      }\n    };\n\n    _this.deactive = function () {\n      _this.setState({\n        active: false\n      });\n\n      if (_this.removeDocClickEvent) {\n        _this.removeDocClickEvent();\n\n        _this.removeDocClickEvent = null;\n      }\n    };\n\n    _this.popupClassName = \"\".concat(props.context.prefixCls, \"-item-dropdown\");\n    _this.state = {\n      active: false\n    };\n    return _this;\n  }\n\n  _createClass(MenubarItemInner, [{\n    key: \"isPrevMenuHiddening\",\n    value: function isPrevMenuHiddening(e) {\n      var toElement = e.nativeEvent.toElement;\n\n      if (toElement && toElement.className === this.popupClassName) {\n        return true;\n      }\n\n      var currentTarget = e.currentTarget;\n      var childNodes = currentTarget.parentElement.childNodes;\n\n      for (var i = 0, l = childNodes.length; i < l; i += 1) {\n        var child = childNodes[i];\n        var popupElem = child.querySelector(\".\".concat(this.popupClassName));\n\n        if (popupElem.contains(toElement)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"cacheDeactive\",\n    value: function cacheDeactive(elem) {\n      cacheDeactiveMap.set(elem, this.deactive);\n    }\n  }, {\n    key: \"callDeactive\",\n    value: function callDeactive(elem) {\n      if (cacheDeactiveMap.has(elem)) {\n        cacheDeactiveMap.get(elem)();\n        cacheDeactiveMap.delete(elem);\n      }\n    }\n  }, {\n    key: \"removeDeactive\",\n    value: function removeDeactive(elem) {\n      cacheDeactiveMap.delete(elem);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _classnames;\n\n      var _this$props = this.props,\n          text = _this$props.text,\n          children = _this$props.children,\n          hidden = _this$props.hidden;\n      var _this$props$context = this.props.context,\n          prefixCls = _this$props$context.prefixCls,\n          menubarActived = _this$props$context.menubarActived;\n      var currentMenuActived = menubarActived && this.state.active;\n      var baseCls = \"\".concat(prefixCls, \"-item\");\n      return React.createElement(\"div\", {\n        className: classnames(baseCls, (_classnames = {}, _defineProperty(_classnames, \"\".concat(baseCls, \"-hidden\"), hidden), _defineProperty(_classnames, \"\".concat(baseCls, \"-hover\"), menubarActived), _defineProperty(_classnames, \"\".concat(baseCls, \"-active\"), currentMenuActived), _classnames)),\n        onMouseEnter: this.onMouseEnter,\n        onMouseLeave: this.onMouseLeave\n      }, React.createElement(\"div\", {\n        className: classnames(\"\".concat(baseCls, \"-text\"), _defineProperty({}, \"\".concat(baseCls, \"-text-active\"), currentMenuActived)),\n        onClick: this.onClick\n      }, text), React.createElement(\"div\", {\n        className: this.popupClassName\n      }, children));\n    }\n  }]);\n\n  return MenubarItemInner;\n}(React.PureComponent);\n\nexport var MenubarItem = function MenubarItem(props) {\n  return React.createElement(MenubarContext.Consumer, null, function (context) {\n    return React.createElement(MenubarItemInner, Object.assign({\n      context: context\n    }, props));\n  });\n};","map":{"version":3,"sources":["../../src/menubar/item.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/* eslint-disable jsx-a11y/click-events-have-key-events  */\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classnames from 'classnames';\nimport addEventListener from 'rc-util/lib/Dom/addEventListener';\nimport { MenubarContext } from './context';\nconst cacheDeactiveMap = new WeakMap();\nclass MenubarItemInner extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.onDocumentClick = () => {\n            this.deactive();\n        };\n        this.onClick = (e) => {\n            this.props.context.activeMenubar();\n            this.removeDeactive(e.currentTarget.parentElement);\n            this.active();\n        };\n        this.onMouseEnter = (e) => {\n            if (this.props.context.menubarActived &&\n                !this.state.active &&\n                !this.isPrevMenuHiddening(e)) {\n                const currentTarget = e.currentTarget;\n                const childNodes = currentTarget.parentElement.childNodes;\n                childNodes.forEach((child) => {\n                    if (child === currentTarget) {\n                        this.removeDeactive(child);\n                    }\n                    else {\n                        this.callDeactive(child);\n                    }\n                });\n                this.active();\n            }\n        };\n        this.onMouseLeave = (e) => {\n            const relatedTarget = e.relatedTarget;\n            const currentTarget = e.currentTarget;\n            if (this.props.context.menubarActived && this.state.active) {\n                const childNodes = currentTarget.parentElement.childNodes;\n                let shoudDeactive = false;\n                if (relatedTarget !== window) {\n                    for (let i = 0, l = childNodes.length; i < l; i += 1) {\n                        const child = childNodes[i];\n                        if (child === relatedTarget ||\n                            child.contains(relatedTarget)) {\n                            shoudDeactive = true;\n                            break;\n                        }\n                    }\n                }\n                if (shoudDeactive) {\n                    this.deactive();\n                }\n                else {\n                    // 缓存一下，当再次 hover 到其他菜单时被调用\n                    this.cacheDeactive(currentTarget);\n                }\n            }\n        };\n        this.active = () => {\n            this.setState({ active: true });\n            if (!this.removeDocClickEvent) {\n                this.removeDocClickEvent = addEventListener(document.documentElement, 'click', this.onDocumentClick).remove;\n            }\n        };\n        this.deactive = () => {\n            this.setState({ active: false });\n            if (this.removeDocClickEvent) {\n                this.removeDocClickEvent();\n                this.removeDocClickEvent = null;\n            }\n        };\n        this.popupClassName = `${props.context.prefixCls}-item-dropdown`;\n        this.state = { active: false };\n    }\n    isPrevMenuHiddening(e) {\n        const toElement = e.nativeEvent.toElement;\n        if (toElement && toElement.className === this.popupClassName) {\n            return true;\n        }\n        const currentTarget = e.currentTarget;\n        const childNodes = currentTarget.parentElement.childNodes;\n        for (let i = 0, l = childNodes.length; i < l; i += 1) {\n            const child = childNodes[i];\n            const popupElem = child.querySelector(`.${this.popupClassName}`);\n            if (popupElem.contains(toElement)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    cacheDeactive(elem) {\n        cacheDeactiveMap.set(elem, this.deactive);\n    }\n    callDeactive(elem) {\n        if (cacheDeactiveMap.has(elem)) {\n            cacheDeactiveMap.get(elem)();\n            cacheDeactiveMap.delete(elem);\n        }\n    }\n    removeDeactive(elem) {\n        cacheDeactiveMap.delete(elem);\n    }\n    render() {\n        const { text, children, hidden } = this.props;\n        const { prefixCls, menubarActived } = this.props.context;\n        const currentMenuActived = menubarActived && this.state.active;\n        const baseCls = `${prefixCls}-item`;\n        return (React.createElement(\"div\", { className: classnames(baseCls, {\n                [`${baseCls}-hidden`]: hidden,\n                [`${baseCls}-hover`]: menubarActived,\n                [`${baseCls}-active`]: currentMenuActived,\n            }), onMouseEnter: this.onMouseEnter, onMouseLeave: this.onMouseLeave },\n            React.createElement(\"div\", { className: classnames(`${baseCls}-text`, {\n                    [`${baseCls}-text-active`]: currentMenuActived,\n                }), onClick: this.onClick }, text),\n            React.createElement(\"div\", { className: this.popupClassName }, children)));\n    }\n}\nexport const MenubarItem = (props) => (React.createElement(MenubarContext.Consumer, null, (context) => React.createElement(MenubarItemInner, Object.assign({ context: context }, props))));\n//# sourceMappingURL=item.js.map"]},"metadata":{},"sourceType":"module"}