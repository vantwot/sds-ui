{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport { PositionType, TYPES } from '@antv/l7-core';\nimport { DOM } from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nexport { PositionType } from '@antv/l7-core';\nvar controlId = 0;\n\nvar Control = function (_EventEmitter) {\n  _inherits(Control, _EventEmitter);\n\n  var _super = _createSuper(Control);\n\n  function Control(cfg) {\n    var _this;\n\n    _classCallCheck(this, Control);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"controlOption\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"container\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"sceneContainer\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mapsService\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderService\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"layerService\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"controlService\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"isShow\", void 0);\n\n    _this.controlOption = _objectSpread(_objectSpread({}, _this.getDefault()), cfg || {});\n    return _this;\n  }\n\n  _createClass(Control, [{\n    key: \"getDefault\",\n    value: function getDefault() {\n      return {\n        position: PositionType.TOPRIGHT,\n        name: \"\".concat(controlId++)\n      };\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition() {\n      var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : PositionType.BOTTOMRIGHT;\n      var controlService = this.controlService;\n\n      if (controlService) {\n        controlService.removeControl(this);\n      }\n\n      this.controlOption.position = position;\n\n      if (controlService) {\n        controlService.addControl(this, this.sceneContainer);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"addTo\",\n    value: function addTo(sceneContainer) {\n      this.mapsService = sceneContainer.get(TYPES.IMapService);\n      this.renderService = sceneContainer.get(TYPES.IRendererService);\n      this.layerService = sceneContainer.get(TYPES.ILayerService);\n      this.controlService = sceneContainer.get(TYPES.IControlService);\n      this.sceneContainer = sceneContainer;\n      this.isShow = true;\n      this.container = this.onAdd();\n      var container = this.container;\n      var pos = this.controlOption.position;\n      var corner = this.controlService.controlCorners[pos];\n      DOM.addClass(container, 'l7-control');\n\n      if (pos.indexOf('bottom') !== -1) {\n        corner.insertBefore(container, corner.firstChild);\n      } else {\n        corner.appendChild(container);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"onAdd\",\n    value: function onAdd() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove() {\n      throw new Error('Method not implemented.');\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      var container = this.container;\n      DOM.addClass(container, 'l7-control-hide');\n      this.isShow = false;\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      var container = this.container;\n      DOM.removeClass(container, 'l7-control-hide');\n      this.isShow = true;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (!this.mapsService) {\n        return this;\n      }\n\n      DOM.remove(this.container);\n      this.onRemove();\n    }\n  }, {\n    key: \"_refocusOnMap\",\n    value: function _refocusOnMap(e) {\n      if (this.mapsService && e && e.screenX > 0 && e.screenY > 0) {\n        var container = this.mapsService.getContainer();\n\n        if (container !== null) {\n          container.focus();\n        }\n      }\n    }\n  }]);\n\n  return Control;\n}(EventEmitter);\n\nexport { Control as default };","map":{"version":3,"sources":["../../src/control/BaseControl.ts"],"names":["controlId","Control","EventEmitter","cfg","position","PositionType","name","BOTTOMRIGHT","controlService","sceneContainer","TYPES","container","pos","corner","DOM","e"],"mappings":"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","sourcesContent":["import {\n  IControlOption,\n  IControlService,\n  ILayerService,\n  IMapService,\n  IRendererService,\n  PositionType,\n  TYPES,\n} from '@antv/l7-core';\nimport { DOM } from '@antv/l7-utils';\nimport { EventEmitter } from 'eventemitter3';\nimport { Container } from 'inversify';\n\nexport { PositionType } from '@antv/l7-core';\n\nlet controlId = 0;\nexport default class Control extends EventEmitter {\n  public controlOption: IControlOption;\n  protected container: HTMLElement;\n  protected sceneContainer: Container;\n  protected mapsService: IMapService;\n  protected renderService: IRendererService;\n  protected layerService: ILayerService;\n  protected controlService: IControlService;\n\n  private isShow: boolean;\n\n  constructor(cfg?: Partial<IControlOption>) {\n    super();\n    this.controlOption = {\n      ...this.getDefault(),\n      ...(cfg || {}),\n    };\n  }\n\n  public getDefault() {\n    return {\n      position: PositionType.TOPRIGHT,\n      name: `${controlId++}`,\n    };\n  }\n\n  public setPosition(position: PositionType = PositionType.BOTTOMRIGHT) {\n    // 考虑组件的自动布局，需要销毁重建\n    const controlService = this.controlService;\n    if (controlService) {\n      controlService.removeControl(this);\n    }\n    this.controlOption.position = position;\n    if (controlService) {\n      controlService.addControl(this, this.sceneContainer);\n    }\n    return this;\n  }\n  public addTo(sceneContainer: Container) {\n    this.mapsService = sceneContainer.get<IMapService>(TYPES.IMapService);\n    this.renderService = sceneContainer.get<IRendererService>(\n      TYPES.IRendererService,\n    );\n    this.layerService = sceneContainer.get<ILayerService>(TYPES.ILayerService);\n    this.controlService = sceneContainer.get<IControlService>(\n      TYPES.IControlService,\n    );\n    this.sceneContainer = sceneContainer;\n    this.isShow = true;\n    this.container = this.onAdd();\n    const container = this.container;\n    const pos = this.controlOption.position;\n    const corner = this.controlService.controlCorners[pos];\n    DOM.addClass(container, 'l7-control');\n\n    if (pos.indexOf('bottom') !== -1) {\n      corner.insertBefore(container, corner.firstChild);\n    } else {\n      corner.appendChild(container);\n    }\n    return this;\n  }\n  public onAdd(): HTMLElement {\n    throw new Error('Method not implemented.');\n  }\n\n  public onRemove(): void {\n    throw new Error('Method not implemented.');\n  }\n  public hide() {\n    const container = this.container;\n    DOM.addClass(container, 'l7-control-hide');\n    this.isShow = false;\n  }\n  public show() {\n    const container = this.container;\n    DOM.removeClass(container, 'l7-control-hide');\n    this.isShow = true;\n  }\n  public remove() {\n    if (!this.mapsService) {\n      return this;\n    }\n    DOM.remove(this.container);\n    this.onRemove();\n  }\n  public _refocusOnMap(e: MouseEvent) {\n    // if map exists and event is not a keyboard event\n    if (this.mapsService && e && e.screenX > 0 && e.screenY > 0) {\n      const container = this.mapsService.getContainer();\n      if (container !== null) {\n        container.focus();\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}