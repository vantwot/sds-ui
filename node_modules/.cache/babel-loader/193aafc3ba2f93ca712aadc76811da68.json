{"ast":null,"code":"import _classCallCheck from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Dom } from '../util';\nimport { Highlighter } from '../registry';\nimport { Base } from './base';\nexport var HighlightManager = /*#__PURE__*/function (_Base) {\n  _inherits(HighlightManager, _Base);\n\n  var _super = _createSuper(HighlightManager);\n\n  function HighlightManager() {\n    var _this;\n\n    _classCallCheck(this, HighlightManager);\n\n    _this = _super.apply(this, arguments);\n    _this.highlights = {};\n    return _this;\n  }\n\n  _createClass(HighlightManager, [{\n    key: \"init\",\n    value: function init() {\n      this.startListening();\n    }\n  }, {\n    key: \"startListening\",\n    value: function startListening() {\n      this.graph.on('cell:highlight', this.onCellHighlight, this);\n      this.graph.on('cell:unhighlight', this.onCellUnhighlight, this);\n    }\n  }, {\n    key: \"stopListening\",\n    value: function stopListening() {\n      this.graph.off('cell:highlight', this.onCellHighlight, this);\n      this.graph.off('cell:unhighlight', this.onCellUnhighlight, this);\n    }\n  }, {\n    key: \"onCellHighlight\",\n    value: function onCellHighlight(_ref) {\n      var cellView = _ref.view,\n          magnet = _ref.magnet,\n          _ref$options = _ref.options,\n          options = _ref$options === void 0 ? {} : _ref$options;\n      var resolved = this.resolveHighlighter(options);\n\n      if (!resolved) {\n        return;\n      }\n\n      var key = this.getHighlighterId(magnet, resolved);\n\n      if (!this.highlights[key]) {\n        var highlighter = resolved.highlighter;\n        highlighter.highlight(cellView, magnet, Object.assign({}, resolved.args));\n        this.highlights[key] = {\n          cellView: cellView,\n          magnet: magnet,\n          highlighter: highlighter,\n          args: resolved.args\n        };\n      }\n    }\n  }, {\n    key: \"onCellUnhighlight\",\n    value: function onCellUnhighlight(_ref2) {\n      var magnet = _ref2.magnet,\n          _ref2$options = _ref2.options,\n          options = _ref2$options === void 0 ? {} : _ref2$options;\n      var resolved = this.resolveHighlighter(options);\n\n      if (!resolved) {\n        return;\n      }\n\n      var id = this.getHighlighterId(magnet, resolved);\n      this.unhighlight(id);\n    }\n  }, {\n    key: \"resolveHighlighter\",\n    value: function resolveHighlighter(options) {\n      var graphOptions = this.options;\n      var highlighterDef = options.highlighter;\n\n      if (highlighterDef == null) {\n        // check for built-in types\n        var type = options.type;\n        highlighterDef = type && graphOptions.highlighting[type] || graphOptions.highlighting.default;\n      }\n\n      if (highlighterDef == null) {\n        return null;\n      }\n\n      var def = typeof highlighterDef === 'string' ? {\n        name: highlighterDef\n      } : highlighterDef;\n      var name = def.name;\n      var highlighter = Highlighter.registry.get(name);\n\n      if (highlighter == null) {\n        return Highlighter.registry.onNotFound(name);\n      }\n\n      Highlighter.check(name, highlighter);\n      return {\n        name: name,\n        highlighter: highlighter,\n        args: def.args || {}\n      };\n    }\n  }, {\n    key: \"getHighlighterId\",\n    value: function getHighlighterId(magnet, options) {\n      Dom.ensureId(magnet);\n      return options.name + magnet.id + JSON.stringify(options.args);\n    }\n  }, {\n    key: \"unhighlight\",\n    value: function unhighlight(id) {\n      var highlight = this.highlights[id];\n\n      if (highlight) {\n        highlight.highlighter.unhighlight(highlight.cellView, highlight.magnet, highlight.args);\n        delete this.highlights[id];\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      var _this2 = this;\n\n      Object.keys(this.highlights).forEach(function (id) {\n        return _this2.unhighlight(id);\n      });\n      this.stopListening();\n    }\n  }]);\n\n  return HighlightManager;\n}(Base);\n\n__decorate([HighlightManager.dispose()], HighlightManager.prototype, \"dispose\", null);","map":{"version":3,"sources":["../../src/graph/highlight.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Dom } from '../util';\nimport { Highlighter } from '../registry';\nimport { Base } from './base';\nexport class HighlightManager extends Base {\n    constructor() {\n        super(...arguments);\n        this.highlights = {};\n    }\n    init() {\n        this.startListening();\n    }\n    startListening() {\n        this.graph.on('cell:highlight', this.onCellHighlight, this);\n        this.graph.on('cell:unhighlight', this.onCellUnhighlight, this);\n    }\n    stopListening() {\n        this.graph.off('cell:highlight', this.onCellHighlight, this);\n        this.graph.off('cell:unhighlight', this.onCellUnhighlight, this);\n    }\n    onCellHighlight({ view: cellView, magnet, options = {}, }) {\n        const resolved = this.resolveHighlighter(options);\n        if (!resolved) {\n            return;\n        }\n        const key = this.getHighlighterId(magnet, resolved);\n        if (!this.highlights[key]) {\n            const highlighter = resolved.highlighter;\n            highlighter.highlight(cellView, magnet, Object.assign({}, resolved.args));\n            this.highlights[key] = {\n                cellView,\n                magnet,\n                highlighter,\n                args: resolved.args,\n            };\n        }\n    }\n    onCellUnhighlight({ magnet, options = {}, }) {\n        const resolved = this.resolveHighlighter(options);\n        if (!resolved) {\n            return;\n        }\n        const id = this.getHighlighterId(magnet, resolved);\n        this.unhighlight(id);\n    }\n    resolveHighlighter(options) {\n        const graphOptions = this.options;\n        let highlighterDef = options.highlighter;\n        if (highlighterDef == null) {\n            // check for built-in types\n            const type = options.type;\n            highlighterDef =\n                (type && graphOptions.highlighting[type]) ||\n                    graphOptions.highlighting.default;\n        }\n        if (highlighterDef == null) {\n            return null;\n        }\n        const def = typeof highlighterDef === 'string'\n            ? {\n                name: highlighterDef,\n            }\n            : highlighterDef;\n        const name = def.name;\n        const highlighter = Highlighter.registry.get(name);\n        if (highlighter == null) {\n            return Highlighter.registry.onNotFound(name);\n        }\n        Highlighter.check(name, highlighter);\n        return {\n            name,\n            highlighter,\n            args: def.args || {},\n        };\n    }\n    getHighlighterId(magnet, options) {\n        Dom.ensureId(magnet);\n        return options.name + magnet.id + JSON.stringify(options.args);\n    }\n    unhighlight(id) {\n        const highlight = this.highlights[id];\n        if (highlight) {\n            highlight.highlighter.unhighlight(highlight.cellView, highlight.magnet, highlight.args);\n            delete this.highlights[id];\n        }\n    }\n    dispose() {\n        Object.keys(this.highlights).forEach((id) => this.unhighlight(id));\n        this.stopListening();\n    }\n}\n__decorate([\n    HighlightManager.dispose()\n], HighlightManager.prototype, \"dispose\", null);\n//# sourceMappingURL=highlight.js.map"]},"metadata":{},"sourceType":"module"}