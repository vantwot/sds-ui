{"ast":null,"code":"import { __spreadArray } from \"tslib\";\nimport { isString } from '@antv/util';\nimport { traverseTree } from './graphic';\n/**\n * 验证关系图或树图数据的合法性，必须符合以下规则才会渲染图：\n * 1. 必须传入数据\n * 2. 节点的 ID 必须为字符串，暂不支持数字类型，如果支持数字类型，会出现类似 123 与 '123' 是否相等的问题\n * 3. 边的 source 和 target 值必须在节点 ID 中存在\n * @param data 关系图或树图数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var dataValidation = function dataValidation(data) {\n  var _a; // 1. 必须传入数据\n\n\n  if (!data) {\n    console.error('G6 Error Tips: the data must be defined');\n    return false;\n  } // 2. 节点的 ID 必须为字符串或数字类型\n\n\n  var nodes = data.nodes,\n      edges = data.edges,\n      _b = data.combos,\n      combos = _b === void 0 ? [] : _b;\n\n  if (!nodes && !edges) {\n    var validated_1 = true; // 不存在 nodes 和 edges，则说明是 TreeGraphData，按 TreeGraphData 规则验证\n\n    traverseTree(data, function (param) {\n      if (!isString(param.id)) {\n        validated_1 = false;\n        return false;\n      }\n\n      return true;\n    });\n    return validated_1;\n  }\n\n  var nonNode = (nodes || []).find(function (node) {\n    return !isString(node.id);\n  });\n\n  if (nonNode) {\n    console.warn(\"G6 Warning Tips: missing 'id' property, or %c\" + nonNode.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n    return false;\n  } // 3. 边的 source 和 target 必须存在于节点 或 Combo中\n\n\n  var nodeIds = (nodes || []).map(function (node) {\n    return node.id;\n  });\n  var comboIds = (_a = combos) === null || _a === void 0 ? void 0 : _a.map(function (combo) {\n    return combo.id;\n  });\n\n  var ids = __spreadArray(__spreadArray([], nodeIds, true), comboIds, true);\n\n  var nonEdges = (edges || []).find(function (edge) {\n    return !ids.includes(edge.source) || !ids.includes(edge.target);\n  });\n\n  if (nonEdges) {\n    console.warn(\"G6 Warning Tips: The source %c\" + nonEdges.source + \"%c or the target %c\" + nonEdges.target + \"%c of the edge do not exist in the nodes or combos.\", 'font-size: 20px; color: red;', '', 'font-size: 20px; color: red;', '');\n    return false;\n  }\n\n  return true;\n};\n/**\n * 验证添加节点、边或从combo时的数据\n * @param type 节点、边或从combo\n * @param data 添加的单条数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var singleDataValidation = function singleDataValidation(type, data) {\n  if (type === 'node' || type === 'combo') {\n    // 必须有 id 字段，且id必须为字符串类型\n    if (data.id && !isString(data.id)) {\n      console.warn(\"G6 Warning Tips: missing 'id' property, or the 'id' %c\" + data.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n      return false;\n    }\n  } else if (type === 'edge') {\n    // 必须有 source 和 target 字段\n    if (!data.source || !data.target) {\n      console.warn(\"G6 Warning Tips: missing 'source' or 'target' for the edge.\");\n      return false;\n    }\n  }\n\n  return true;\n};","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@antv/g6-core/es/util/validation.js"],"names":["__spreadArray","isString","traverseTree","dataValidation","data","_a","console","error","nodes","edges","_b","combos","validated_1","param","id","nonNode","find","node","warn","nodeIds","map","comboIds","combo","ids","nonEdges","edge","includes","source","target","singleDataValidation","type"],"mappings":"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","sourcesContent":["import { __spreadArray } from \"tslib\";\nimport { isString } from '@antv/util';\nimport { traverseTree } from './graphic';\n/**\n * 验证关系图或树图数据的合法性，必须符合以下规则才会渲染图：\n * 1. 必须传入数据\n * 2. 节点的 ID 必须为字符串，暂不支持数字类型，如果支持数字类型，会出现类似 123 与 '123' 是否相等的问题\n * 3. 边的 source 和 target 值必须在节点 ID 中存在\n * @param data 关系图或树图数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var dataValidation = function dataValidation(data) {\n  var _a; // 1. 必须传入数据\n\n\n  if (!data) {\n    console.error('G6 Error Tips: the data must be defined');\n    return false;\n  } // 2. 节点的 ID 必须为字符串或数字类型\n\n\n  var nodes = data.nodes,\n      edges = data.edges,\n      _b = data.combos,\n      combos = _b === void 0 ? [] : _b;\n\n  if (!nodes && !edges) {\n    var validated_1 = true; // 不存在 nodes 和 edges，则说明是 TreeGraphData，按 TreeGraphData 规则验证\n\n    traverseTree(data, function (param) {\n      if (!isString(param.id)) {\n        validated_1 = false;\n        return false;\n      }\n\n      return true;\n    });\n    return validated_1;\n  }\n\n  var nonNode = (nodes || []).find(function (node) {\n    return !isString(node.id);\n  });\n\n  if (nonNode) {\n    console.warn(\"G6 Warning Tips: missing 'id' property, or %c\" + nonNode.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n    return false;\n  } // 3. 边的 source 和 target 必须存在于节点 或 Combo中\n\n\n  var nodeIds = (nodes || []).map(function (node) {\n    return node.id;\n  });\n  var comboIds = (_a = combos) === null || _a === void 0 ? void 0 : _a.map(function (combo) {\n    return combo.id;\n  });\n\n  var ids = __spreadArray(__spreadArray([], nodeIds, true), comboIds, true);\n\n  var nonEdges = (edges || []).find(function (edge) {\n    return !ids.includes(edge.source) || !ids.includes(edge.target);\n  });\n\n  if (nonEdges) {\n    console.warn(\"G6 Warning Tips: The source %c\" + nonEdges.source + \"%c or the target %c\" + nonEdges.target + \"%c of the edge do not exist in the nodes or combos.\", 'font-size: 20px; color: red;', '', 'font-size: 20px; color: red;', '');\n    return false;\n  }\n\n  return true;\n};\n/**\n * 验证添加节点、边或从combo时的数据\n * @param type 节点、边或从combo\n * @param data 添加的单条数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var singleDataValidation = function singleDataValidation(type, data) {\n  if (type === 'node' || type === 'combo') {\n    // 必须有 id 字段，且id必须为字符串类型\n    if (data.id && !isString(data.id)) {\n      console.warn(\"G6 Warning Tips: missing 'id' property, or the 'id' %c\" + data.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n      return false;\n    }\n  } else if (type === 'edge') {\n    // 必须有 source 和 target 字段\n    if (!data.source || !data.target) {\n      console.warn(\"G6 Warning Tips: missing 'source' or 'target' for the edge.\");\n      return false;\n    }\n  }\n\n  return true;\n};"]},"metadata":{},"sourceType":"module"}