{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport AppContext from '../../../../context';\nimport { FormWrapper } from '../../form-wrapper';\nimport { ColorPicker, InputNumberFiled, InputFiled, SelectField } from './fields';\nimport { prefix } from './constants';\nexport var ArrowConfig = {\n  width: 12,\n  height: 8,\n  name: 'block'\n};\nexport var DisableArrowConfig = {\n  width: 0,\n  height: 0,\n  name: ''\n};\nexport var ArrowMaps = {\n  target: {\n    sourceMarker: DisableArrowConfig,\n    targetMarker: ArrowConfig\n  },\n  source: {\n    sourceMarker: ArrowConfig,\n    targetMarker: DisableArrowConfig\n  },\n  all: {\n    sourceMarker: ArrowConfig,\n    targetMarker: ArrowConfig\n  },\n  none: {\n    sourceMarker: DisableArrowConfig,\n    targetMarker: DisableArrowConfig\n  }\n};\nexport var ArrowStrokeMaps = {\n  solid: [0, 0],\n  dash: [5, 5]\n};\n\nvar EdgeComponent = function (props) {\n  var config = props.config,\n      _a = props.plugin,\n      plugin = _a === void 0 ? {} : _a;\n  var updateEdge = plugin.updateEdge;\n  var EdgeConfig = useContext(AppContext).theme.EdgeConfig;\n\n  var _b = useState(__assign(__assign({}, EdgeConfig.normal), config)),\n      edgeConfig = _b[0],\n      setEdgeConfig = _b[1];\n\n  useEffect(function () {\n    setEdgeConfig(__assign(__assign({}, EdgeConfig.normal), config));\n  }, [config]);\n\n  var getAttrs = function (key, type) {\n    var _a;\n\n    if (type === void 0) {\n      type = 'line';\n    }\n\n    var _b = edgeConfig.attrs,\n        attrs = _b === void 0 ? {} : _b;\n    return (_a = attrs[type]) === null || _a === void 0 ? void 0 : _a[key];\n  };\n\n  var getArrowValue = function () {\n    var _a, _b, _c, _d, _e;\n\n    var _f = edgeConfig.attrs,\n        attrs = _f === void 0 ? {} : _f;\n    var _g = attrs.line,\n        line = _g === void 0 ? {} : _g;\n\n    if (((_a = line.sourceMarker) === null || _a === void 0 ? void 0 : _a.name) && ((_b = line.targetMarker) === null || _b === void 0 ? void 0 : _b.name)) {\n      return 'all';\n    }\n\n    if (!((_c = line.sourceMarker) === null || _c === void 0 ? void 0 : _c.name) && !((_d = line.targetMarker) === null || _d === void 0 ? void 0 : _d.name)) {\n      return 'none';\n    }\n\n    if ((_e = line.sourceMarker) === null || _e === void 0 ? void 0 : _e.name) {\n      return 'source';\n    }\n\n    return 'target';\n  };\n\n  var getSrokeDashValue = function () {\n    var _a = edgeConfig.attrs,\n        attrs = _a === void 0 ? {} : _a;\n    var _b = attrs.line,\n        line = _b === void 0 ? {} : _b;\n    return line.strokeDasharray ? 'dash' : 'solid';\n  };\n\n  var onEdgeConfigChange = function (key, value, type) {\n    var _a, _b, _c, _d, _e;\n\n    var _f, _g;\n\n    if (type === void 0) {\n      type = 'line';\n    }\n    /** 全量更新，简化逻辑 */\n\n\n    if (key === 'arrow') {\n      setEdgeConfig(__assign(__assign({}, edgeConfig), {\n        attrs: __assign(__assign({}, edgeConfig.attrs), (_a = {}, _a[type] = __assign(__assign({}, (_f = edgeConfig.attrs) === null || _f === void 0 ? void 0 : _f[type]), value), _a))\n      }));\n    } else {\n      setEdgeConfig(__assign(__assign({}, edgeConfig), (_b = {}, _b[key] = value, _b.attrs = __assign(__assign({}, edgeConfig.attrs), (_c = {}, _c[type] = __assign(__assign({}, (_g = edgeConfig.attrs) === null || _g === void 0 ? void 0 : _g[type]), (_d = {}, _d[key] = value, _d)), _c)), _b)));\n    }\n\n    updateEdge((_e = {}, _e[key] = value, _e), type, key === 'arrow' ? 'arrow' : '');\n  };\n\n  return React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-panel-body\")\n  }, React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-panel-group\")\n  }, React.createElement(\"h5\", null, \"\\u5185\\u5BB9\"), React.createElement(InputFiled, {\n    label: \"\\u6807\\u7B7E\",\n    value: edgeConfig.label,\n    onChange: function (value) {\n      onEdgeConfigChange('label', value);\n    }\n  })), React.createElement(\"h5\", {\n    style: {\n      marginBottom: 12\n    }\n  }, \"\\u6837\\u5F0F\"), React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-panel-group\"),\n    style: {\n      marginBottom: 0\n    }\n  }, React.createElement(\"h5\", null, \"\\u7EBF\"), React.createElement(SelectField, {\n    label: \"\\u7BAD\\u5934\",\n    value: getArrowValue(),\n    options: [{\n      label: '正向',\n      value: 'target'\n    }, {\n      label: '逆向',\n      value: 'source'\n    }, {\n      label: '双向',\n      value: 'all'\n    }, {\n      label: '无',\n      value: 'none'\n    }],\n    onChange: function (value) {\n      onEdgeConfigChange('arrow', ArrowMaps[value], 'line');\n    }\n  }), React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-edge-stroke-style\")\n  }, React.createElement(SelectField, {\n    label: \"\\u7EBF\\u5F62\",\n    width: 68,\n    value: getSrokeDashValue(),\n    options: [{\n      label: '实线',\n      value: 'solid'\n    }, {\n      label: '虚线',\n      value: 'dash'\n    }],\n    onChange: function (value) {\n      onEdgeConfigChange('strokeDasharray', ArrowStrokeMaps[value], 'line');\n    }\n  }), React.createElement(InputNumberFiled, {\n    value: getAttrs('strokeWidth'),\n    min: 1,\n    onChange: function (value) {\n      onEdgeConfigChange('strokeWidth', value, 'line');\n    }\n  })), React.createElement(ColorPicker, {\n    label: \"\\u8FB9\\u6846\",\n    value: getAttrs('stroke'),\n    onChange: function (value) {\n      onEdgeConfigChange('stroke', value, 'line');\n    }\n  })), React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-panel-group\")\n  }, React.createElement(\"h5\", null, \"\\u6807\\u7B7E\"), React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"-edge-text-style\")\n  }, React.createElement(InputNumberFiled, {\n    label: \"\\u5B57\\u53F7\",\n    min: 10,\n    width: 68,\n    value: getAttrs('fontSize', 'text') || 12,\n    onChange: function (value) {\n      onEdgeConfigChange('fontSize', value, 'text');\n    }\n  }), React.createElement(ColorPicker, {\n    value: getAttrs('fill', 'text') || '#000',\n    onChange: function (value) {\n      onEdgeConfigChange('fill', value, 'text');\n    }\n  }))));\n};\n\nexport var EdgeService = function (props) {\n  return React.createElement(FormWrapper, __assign({}, props, {\n    type: \"edge\"\n  }), function (config, plugin) {\n    return React.createElement(EdgeComponent, __assign({}, props, {\n      plugin: plugin,\n      config: config\n    }));\n  });\n};","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@ant-design/flowchart/es/components/editor-panel/control-map-service/components/edge.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","useState","useEffect","useContext","AppContext","FormWrapper","ColorPicker","InputNumberFiled","InputFiled","SelectField","prefix","ArrowConfig","width","height","name","DisableArrowConfig","ArrowMaps","target","sourceMarker","targetMarker","source","all","none","ArrowStrokeMaps","solid","dash","EdgeComponent","props","config","_a","plugin","updateEdge","EdgeConfig","theme","_b","normal","edgeConfig","setEdgeConfig","getAttrs","key","type","attrs","getArrowValue","_c","_d","_e","_f","_g","line","getSrokeDashValue","strokeDasharray","onEdgeConfigChange","value","createElement","className","concat","label","onChange","style","marginBottom","options","min","EdgeService"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useState, useEffect, useContext } from 'react';\nimport AppContext from '../../../../context';\nimport { FormWrapper } from '../../form-wrapper';\nimport { ColorPicker, InputNumberFiled, InputFiled, SelectField } from './fields';\nimport { prefix } from './constants';\nexport var ArrowConfig = {\n    width: 12,\n    height: 8,\n    name: 'block',\n};\nexport var DisableArrowConfig = {\n    width: 0,\n    height: 0,\n    name: '',\n};\nexport var ArrowMaps = {\n    target: {\n        sourceMarker: DisableArrowConfig,\n        targetMarker: ArrowConfig,\n    },\n    source: {\n        sourceMarker: ArrowConfig,\n        targetMarker: DisableArrowConfig,\n    },\n    all: {\n        sourceMarker: ArrowConfig,\n        targetMarker: ArrowConfig,\n    },\n    none: {\n        sourceMarker: DisableArrowConfig,\n        targetMarker: DisableArrowConfig,\n    },\n};\nexport var ArrowStrokeMaps = {\n    solid: [0, 0],\n    dash: [5, 5],\n};\nvar EdgeComponent = function (props) {\n    var config = props.config, _a = props.plugin, plugin = _a === void 0 ? {} : _a;\n    var updateEdge = plugin.updateEdge;\n    var EdgeConfig = useContext(AppContext).theme.EdgeConfig;\n    var _b = useState(__assign(__assign({}, EdgeConfig.normal), config)), edgeConfig = _b[0], setEdgeConfig = _b[1];\n    useEffect(function () {\n        setEdgeConfig(__assign(__assign({}, EdgeConfig.normal), config));\n    }, [config]);\n    var getAttrs = function (key, type) {\n        var _a;\n        if (type === void 0) { type = 'line'; }\n        var _b = edgeConfig.attrs, attrs = _b === void 0 ? {} : _b;\n        return (_a = attrs[type]) === null || _a === void 0 ? void 0 : _a[key];\n    };\n    var getArrowValue = function () {\n        var _a, _b, _c, _d, _e;\n        var _f = edgeConfig.attrs, attrs = _f === void 0 ? {} : _f;\n        var _g = attrs.line, line = _g === void 0 ? {} : _g;\n        if (((_a = line.sourceMarker) === null || _a === void 0 ? void 0 : _a.name) && ((_b = line.targetMarker) === null || _b === void 0 ? void 0 : _b.name)) {\n            return 'all';\n        }\n        if (!((_c = line.sourceMarker) === null || _c === void 0 ? void 0 : _c.name) && !((_d = line.targetMarker) === null || _d === void 0 ? void 0 : _d.name)) {\n            return 'none';\n        }\n        if ((_e = line.sourceMarker) === null || _e === void 0 ? void 0 : _e.name) {\n            return 'source';\n        }\n        return 'target';\n    };\n    var getSrokeDashValue = function () {\n        var _a = edgeConfig.attrs, attrs = _a === void 0 ? {} : _a;\n        var _b = attrs.line, line = _b === void 0 ? {} : _b;\n        return line.strokeDasharray ? 'dash' : 'solid';\n    };\n    var onEdgeConfigChange = function (key, value, type) {\n        var _a, _b, _c, _d, _e;\n        var _f, _g;\n        if (type === void 0) { type = 'line'; }\n        /** 全量更新，简化逻辑 */\n        if (key === 'arrow') {\n            setEdgeConfig(__assign(__assign({}, edgeConfig), { attrs: __assign(__assign({}, edgeConfig.attrs), (_a = {}, _a[type] = __assign(__assign({}, (_f = edgeConfig.attrs) === null || _f === void 0 ? void 0 : _f[type]), value), _a)) }));\n        }\n        else {\n            setEdgeConfig(__assign(__assign({}, edgeConfig), (_b = {}, _b[key] = value, _b.attrs = __assign(__assign({}, edgeConfig.attrs), (_c = {}, _c[type] = __assign(__assign({}, (_g = edgeConfig.attrs) === null || _g === void 0 ? void 0 : _g[type]), (_d = {}, _d[key] = value, _d)), _c)), _b)));\n        }\n        updateEdge((_e = {},\n            _e[key] = value,\n            _e), type, key === 'arrow' ? 'arrow' : '');\n    };\n    return (React.createElement(\"div\", { className: \"\".concat(prefix, \"-panel-body\") },\n        React.createElement(\"div\", { className: \"\".concat(prefix, \"-panel-group\") },\n            React.createElement(\"h5\", null, \"\\u5185\\u5BB9\"),\n            React.createElement(InputFiled, { label: \"\\u6807\\u7B7E\", value: edgeConfig.label, onChange: function (value) {\n                    onEdgeConfigChange('label', value);\n                } })),\n        React.createElement(\"h5\", { style: { marginBottom: 12 } }, \"\\u6837\\u5F0F\"),\n        React.createElement(\"div\", { className: \"\".concat(prefix, \"-panel-group\"), style: { marginBottom: 0 } },\n            React.createElement(\"h5\", null, \"\\u7EBF\"),\n            React.createElement(SelectField, { label: \"\\u7BAD\\u5934\", value: getArrowValue(), options: [\n                    {\n                        label: '正向',\n                        value: 'target',\n                    },\n                    {\n                        label: '逆向',\n                        value: 'source',\n                    },\n                    {\n                        label: '双向',\n                        value: 'all',\n                    },\n                    {\n                        label: '无',\n                        value: 'none',\n                    },\n                ], onChange: function (value) {\n                    onEdgeConfigChange('arrow', ArrowMaps[value], 'line');\n                } }),\n            React.createElement(\"div\", { className: \"\".concat(prefix, \"-edge-stroke-style\") },\n                React.createElement(SelectField, { label: \"\\u7EBF\\u5F62\", width: 68, value: getSrokeDashValue(), options: [\n                        {\n                            label: '实线',\n                            value: 'solid',\n                        },\n                        {\n                            label: '虚线',\n                            value: 'dash',\n                        },\n                    ], onChange: function (value) {\n                        onEdgeConfigChange('strokeDasharray', ArrowStrokeMaps[value], 'line');\n                    } }),\n                React.createElement(InputNumberFiled, { value: getAttrs('strokeWidth'), min: 1, onChange: function (value) {\n                        onEdgeConfigChange('strokeWidth', value, 'line');\n                    } })),\n            React.createElement(ColorPicker, { label: \"\\u8FB9\\u6846\", value: getAttrs('stroke'), onChange: function (value) {\n                    onEdgeConfigChange('stroke', value, 'line');\n                } })),\n        React.createElement(\"div\", { className: \"\".concat(prefix, \"-panel-group\") },\n            React.createElement(\"h5\", null, \"\\u6807\\u7B7E\"),\n            React.createElement(\"div\", { className: \"\".concat(prefix, \"-edge-text-style\") },\n                React.createElement(InputNumberFiled, { label: \"\\u5B57\\u53F7\", min: 10, width: 68, value: getAttrs('fontSize', 'text') || 12, onChange: function (value) {\n                        onEdgeConfigChange('fontSize', value, 'text');\n                    } }),\n                React.createElement(ColorPicker, { value: getAttrs('fill', 'text') || '#000', onChange: function (value) {\n                        onEdgeConfigChange('fill', value, 'text');\n                    } })))));\n};\nexport var EdgeService = function (props) {\n    return (React.createElement(FormWrapper, __assign({}, props, { type: \"edge\" }), function (config, plugin) { return React.createElement(EdgeComponent, __assign({}, props, { plugin: plugin, config: config })); }));\n};\n"]},"metadata":{},"sourceType":"module"}