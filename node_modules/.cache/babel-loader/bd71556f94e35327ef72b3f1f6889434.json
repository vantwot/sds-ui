{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { isArray, isNil, mix } from '@antv/util';\nimport { formatPadding } from '../util/base';\nimport Global from '../global';\nimport Shape from './shape';\nimport { shapeBase } from './shapeBase';\nvar singleNode = {\n  itemType: 'node',\n  // 单个图形的类型\n  shapeType: 'single-node',\n\n  /**\n   * 文本相对图形的位置，默认以中心点\n   * 位置包括： top, bottom, left, right, center\n   * @type {String}\n   */\n  labelPosition: 'center',\n\n  /**\n   * 文本相对偏移，当 labelPosition 不为 center 时有效\n   * @type {Number}\n   */\n  offset: Global.nodeLabel.offset,\n\n  /**\n   * 获取节点宽高\n   * @internal 返回节点的大小，以 [width, height] 的方式维护\n   * @param  {Object} cfg 节点的配置项\n   * @return {Array} 宽高\n   */\n  getSize: function getSize(cfg) {\n    var _a;\n\n    var size = ((_a = this.mergeStyle) === null || _a === void 0 ? void 0 : _a.size) || cfg.size || this.getOptions({}).size || Global.defaultNode.size; // Global.defaultNode.size; //  \n    // size 是数组，但长度为1，则补长度为2\n\n    if (isArray(size) && size.length === 1) {\n      size = [size[0], size[0]];\n    } // size 为数字，则转换为数组\n\n\n    if (!isArray(size)) {\n      size = [size, size];\n    }\n\n    return size;\n  },\n  // 私有方法，不希望扩展的节点复写这个方法\n  getLabelStyleByPosition: function getLabelStyleByPosition(cfg, labelCfg) {\n    var labelPosition = labelCfg.position || this.labelPosition; // 默认的位置（最可能的情形），所以放在最上面\n\n    if (labelPosition === 'center') {\n      return {\n        x: 0,\n        y: 0,\n        text: cfg.label\n      };\n    }\n\n    var offset = labelCfg.offset;\n\n    if (isNil(offset)) {\n      // 考虑 offset = 0 的场景，不用用 labelCfg.offset || Global.nodeLabel.offset\n      offset = this.offset; // 不居中时的偏移量\n    }\n\n    var size = this.getSize(cfg);\n    var style;\n\n    switch (labelPosition) {\n      case 'top':\n        style = {\n          x: 0,\n          y: -size[1] / 2 - offset,\n          textBaseline: 'bottom' // 文本在图形的上面\n\n        };\n        break;\n\n      case 'bottom':\n        style = {\n          x: 0,\n          y: size[1] / 2 + offset,\n          textBaseline: 'top'\n        };\n        break;\n\n      case 'left':\n        style = {\n          x: -size[0] / 2 - offset,\n          y: 0,\n          textAlign: 'right'\n        };\n        break;\n\n      default:\n        style = {\n          x: size[0] / 2 + offset,\n          y: 0,\n          textAlign: 'left'\n        };\n        break;\n    }\n\n    style.text = cfg.label;\n    return style;\n  },\n  getLabelBgStyleByPosition: function getLabelBgStyleByPosition(label, cfg, labelCfg, group) {\n    var _a;\n\n    if (!label) return {};\n    var backgroundStyle = (_a = labelCfg.style) === null || _a === void 0 ? void 0 : _a.background;\n    if (!backgroundStyle) return {};\n    var bbox = label.getBBox();\n    var padding = formatPadding(backgroundStyle.padding);\n    var backgroundWidth = bbox.width + padding[1] + padding[3];\n    var backgroundHeight = bbox.height + padding[0] + padding[2];\n    return __assign(__assign({\n      x: bbox.minX - padding[3],\n      y: bbox.minY - padding[0]\n    }, backgroundStyle), {\n      width: backgroundWidth,\n      height: backgroundHeight\n    });\n  },\n  drawShape: function drawShape(cfg, group) {\n    var shapeType = this.shapeType; // || this.type，都已经加了 shapeType\n\n    var style = this.getShapeStyle(cfg);\n    var shape = group.addShape(shapeType, {\n      attrs: style,\n      draggable: true,\n      name: 'node-shape'\n    });\n    group['shapeMap']['node-shape'] = shape;\n    return shape;\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = (this.mergeStyle || this.getOptions(cfg)).linkPoints;\n    var markLeft = group['shapeMap']['link-point-left'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group['shapeMap']['link-point-right'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group['shapeMap']['link-point-top'] || group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markBottom = group['shapeMap']['link-point-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-bottom';\n    });\n    var currentLinkPoints;\n\n    if (markLeft) {\n      currentLinkPoints = markLeft.attr();\n    }\n\n    if (markRight && !currentLinkPoints) {\n      currentLinkPoints = markRight.attr();\n    }\n\n    if (markTop && !currentLinkPoints) {\n      currentLinkPoints = markTop.attr();\n    }\n\n    if (markBottom && !currentLinkPoints) {\n      currentLinkPoints = markBottom.attr();\n    }\n\n    if (!currentLinkPoints) currentLinkPoints = defaultLinkPoints;\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      bottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        bottom = _a.bottom;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n        delete group['shapeMap']['link-point-left'];\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: -width / 2,\n          y: 0\n        }));\n      }\n    } else if (left) {\n      var name_1 = 'link-point-left';\n      group['shapeMap'][name_1] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: -width / 2,\n          y: 0\n        }),\n        className: name_1,\n        name: name_1,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n        delete group['shapeMap']['link-point-right'];\n      }\n\n      markRight.attr(__assign(__assign({}, styles), {\n        x: width / 2,\n        y: 0\n      }));\n    } else if (right) {\n      var name_2 = 'link-point-right';\n      group['shapeMap'][name_2] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: width / 2,\n          y: 0\n        }),\n        className: name_2,\n        name: name_2,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n        delete group['shapeMap']['link-point-top'];\n      }\n\n      markTop.attr(__assign(__assign({}, styles), {\n        x: 0,\n        y: -height / 2\n      }));\n    } else if (top) {\n      var name_3 = 'link-point-top';\n      group['shapeMap'][name_3] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: 0,\n          y: -height / 2\n        }),\n        className: name_3,\n        name: name_3,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markBottom) {\n      if (!bottom && bottom !== undefined) {\n        markBottom.remove();\n        delete group['shapeMap']['link-point-bottom'];\n      } else {\n        markBottom.attr(__assign(__assign({}, styles), {\n          x: 0,\n          y: height / 2\n        }));\n      }\n    } else if (bottom) {\n      var name_4 = 'link-point-bottom';\n      group['shapeMap'][name_4] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: 0,\n          y: height / 2\n        }),\n        className: name_4,\n        name: name_4,\n        isAnchorPoint: true\n      });\n    }\n  },\n  updateShape: function updateShape(cfg, item, keyShapeStyle, hasIcon, updateType) {\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign({}, keyShapeStyle));\n\n    if (!undefined || (updateType === null || updateType === void 0 ? void 0 : updateType.includes('label'))) {\n      this.updateLabel(cfg, item, updateType);\n    }\n\n    if (hasIcon) {\n      this.updateIcon(cfg, item);\n    }\n  },\n  updateIcon: function updateIcon(cfg, item) {\n    var _this = this;\n\n    var group = item.getContainer();\n    var icon = (this.mergeStyle || this.getOptions(cfg)).icon;\n    var show = (cfg.icon ? cfg.icon : {\n      show: undefined\n    }).show;\n    var iconShape = group['shapeMap'][this.type + \"-icon\"] || group.find(function (ele) {\n      return ele.get('name') === _this.type + \"-icon\";\n    });\n\n    if (iconShape) {\n      // 若原先存在 icon\n      if (show || show === undefined) {\n        // 若传入 show: true, 或没有设置，则更新原有的 icon 样式\n        var iconConfig = mix({}, iconShape.attr(), icon);\n        var _a = iconConfig.width,\n            w = _a === void 0 ? 20 : _a,\n            _b = iconConfig.height,\n            h = _b === void 0 ? 20 : _b;\n        iconShape.attr(__assign(__assign({}, iconConfig), {\n          x: -w / 2,\n          y: -h / 2\n        }));\n      } else {\n        // 若传入了 show: false 则删除原先的 icon\n        iconShape.remove();\n      }\n    } else if (show) {\n      // 如果原先不存在 icon，但传入了 show: true，则新增 icon\n      var w = icon.width,\n          h = icon.height;\n      var name_5 = this.type + \"-icon\";\n      group['shapeMap'][name_5] = group.addShape('image', {\n        attrs: __assign(__assign({}, icon), {\n          x: -w / 2,\n          y: -h / 2\n        }),\n        className: name_5,\n        name: name_5\n      }); // to ensure the label is on the top of all the shapes\n\n      var labelShape = group['shapeMap']['node-label'] || group.find(function (ele) {\n        return ele.get('name') === 'node-label';\n      });\n\n      if (labelShape) {\n        labelShape.toFront();\n      }\n    }\n  }\n};\n\nvar singleNodeDef = __assign(__assign({}, shapeBase), singleNode);\n\nShape.registerNode('single-node', singleNodeDef);","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@antv/g6-core/es/element/node.js"],"names":["__assign","isArray","isNil","mix","formatPadding","Global","Shape","shapeBase","singleNode","itemType","shapeType","labelPosition","offset","nodeLabel","getSize","cfg","_a","size","mergeStyle","getOptions","defaultNode","length","getLabelStyleByPosition","labelCfg","position","x","y","text","label","style","textBaseline","textAlign","getLabelBgStyleByPosition","group","backgroundStyle","background","bbox","getBBox","padding","backgroundWidth","width","backgroundHeight","height","minX","minY","drawShape","getShapeStyle","shape","addShape","attrs","draggable","name","updateLinkPoints","defaultLinkPoints","linkPoints","markLeft","find","element","get","markRight","markTop","markBottom","currentLinkPoints","attr","markFill","fill","markStroke","stroke","borderWidth","lineWidth","markSize","r","left","undefined","right","top","bottom","styles","remove","name_1","className","isAnchorPoint","name_2","name_3","name_4","updateShape","item","keyShapeStyle","hasIcon","updateType","keyShape","includes","updateLabel","updateIcon","_this","getContainer","icon","show","iconShape","type","ele","iconConfig","w","_b","h","name_5","labelShape","toFront","singleNodeDef","registerNode"],"mappings":"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","sourcesContent":["import { __assign } from \"tslib\";\nimport { isArray, isNil, mix } from '@antv/util';\nimport { formatPadding } from '../util/base';\nimport Global from '../global';\nimport Shape from './shape';\nimport { shapeBase } from './shapeBase';\nvar singleNode = {\n  itemType: 'node',\n  // 单个图形的类型\n  shapeType: 'single-node',\n\n  /**\n   * 文本相对图形的位置，默认以中心点\n   * 位置包括： top, bottom, left, right, center\n   * @type {String}\n   */\n  labelPosition: 'center',\n\n  /**\n   * 文本相对偏移，当 labelPosition 不为 center 时有效\n   * @type {Number}\n   */\n  offset: Global.nodeLabel.offset,\n\n  /**\n   * 获取节点宽高\n   * @internal 返回节点的大小，以 [width, height] 的方式维护\n   * @param  {Object} cfg 节点的配置项\n   * @return {Array} 宽高\n   */\n  getSize: function getSize(cfg) {\n    var _a;\n\n    var size = ((_a = this.mergeStyle) === null || _a === void 0 ? void 0 : _a.size) || cfg.size || this.getOptions({}).size || Global.defaultNode.size; // Global.defaultNode.size; //  \n    // size 是数组，但长度为1，则补长度为2\n\n    if (isArray(size) && size.length === 1) {\n      size = [size[0], size[0]];\n    } // size 为数字，则转换为数组\n\n\n    if (!isArray(size)) {\n      size = [size, size];\n    }\n\n    return size;\n  },\n  // 私有方法，不希望扩展的节点复写这个方法\n  getLabelStyleByPosition: function getLabelStyleByPosition(cfg, labelCfg) {\n    var labelPosition = labelCfg.position || this.labelPosition; // 默认的位置（最可能的情形），所以放在最上面\n\n    if (labelPosition === 'center') {\n      return {\n        x: 0,\n        y: 0,\n        text: cfg.label\n      };\n    }\n\n    var offset = labelCfg.offset;\n\n    if (isNil(offset)) {\n      // 考虑 offset = 0 的场景，不用用 labelCfg.offset || Global.nodeLabel.offset\n      offset = this.offset; // 不居中时的偏移量\n    }\n\n    var size = this.getSize(cfg);\n    var style;\n\n    switch (labelPosition) {\n      case 'top':\n        style = {\n          x: 0,\n          y: -size[1] / 2 - offset,\n          textBaseline: 'bottom' // 文本在图形的上面\n\n        };\n        break;\n\n      case 'bottom':\n        style = {\n          x: 0,\n          y: size[1] / 2 + offset,\n          textBaseline: 'top'\n        };\n        break;\n\n      case 'left':\n        style = {\n          x: -size[0] / 2 - offset,\n          y: 0,\n          textAlign: 'right'\n        };\n        break;\n\n      default:\n        style = {\n          x: size[0] / 2 + offset,\n          y: 0,\n          textAlign: 'left'\n        };\n        break;\n    }\n\n    style.text = cfg.label;\n    return style;\n  },\n  getLabelBgStyleByPosition: function getLabelBgStyleByPosition(label, cfg, labelCfg, group) {\n    var _a;\n\n    if (!label) return {};\n    var backgroundStyle = (_a = labelCfg.style) === null || _a === void 0 ? void 0 : _a.background;\n    if (!backgroundStyle) return {};\n    var bbox = label.getBBox();\n    var padding = formatPadding(backgroundStyle.padding);\n    var backgroundWidth = bbox.width + padding[1] + padding[3];\n    var backgroundHeight = bbox.height + padding[0] + padding[2];\n    return __assign(__assign({\n      x: bbox.minX - padding[3],\n      y: bbox.minY - padding[0]\n    }, backgroundStyle), {\n      width: backgroundWidth,\n      height: backgroundHeight\n    });\n  },\n  drawShape: function drawShape(cfg, group) {\n    var shapeType = this.shapeType; // || this.type，都已经加了 shapeType\n\n    var style = this.getShapeStyle(cfg);\n    var shape = group.addShape(shapeType, {\n      attrs: style,\n      draggable: true,\n      name: 'node-shape'\n    });\n    group['shapeMap']['node-shape'] = shape;\n    return shape;\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = (this.mergeStyle || this.getOptions(cfg)).linkPoints;\n    var markLeft = group['shapeMap']['link-point-left'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group['shapeMap']['link-point-right'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group['shapeMap']['link-point-top'] || group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markBottom = group['shapeMap']['link-point-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-bottom';\n    });\n    var currentLinkPoints;\n\n    if (markLeft) {\n      currentLinkPoints = markLeft.attr();\n    }\n\n    if (markRight && !currentLinkPoints) {\n      currentLinkPoints = markRight.attr();\n    }\n\n    if (markTop && !currentLinkPoints) {\n      currentLinkPoints = markTop.attr();\n    }\n\n    if (markBottom && !currentLinkPoints) {\n      currentLinkPoints = markBottom.attr();\n    }\n\n    if (!currentLinkPoints) currentLinkPoints = defaultLinkPoints;\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      bottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        bottom = _a.bottom;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n        delete group['shapeMap']['link-point-left'];\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: -width / 2,\n          y: 0\n        }));\n      }\n    } else if (left) {\n      var name_1 = 'link-point-left';\n      group['shapeMap'][name_1] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: -width / 2,\n          y: 0\n        }),\n        className: name_1,\n        name: name_1,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n        delete group['shapeMap']['link-point-right'];\n      }\n\n      markRight.attr(__assign(__assign({}, styles), {\n        x: width / 2,\n        y: 0\n      }));\n    } else if (right) {\n      var name_2 = 'link-point-right';\n      group['shapeMap'][name_2] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: width / 2,\n          y: 0\n        }),\n        className: name_2,\n        name: name_2,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n        delete group['shapeMap']['link-point-top'];\n      }\n\n      markTop.attr(__assign(__assign({}, styles), {\n        x: 0,\n        y: -height / 2\n      }));\n    } else if (top) {\n      var name_3 = 'link-point-top';\n      group['shapeMap'][name_3] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: 0,\n          y: -height / 2\n        }),\n        className: name_3,\n        name: name_3,\n        isAnchorPoint: true\n      });\n    }\n\n    if (markBottom) {\n      if (!bottom && bottom !== undefined) {\n        markBottom.remove();\n        delete group['shapeMap']['link-point-bottom'];\n      } else {\n        markBottom.attr(__assign(__assign({}, styles), {\n          x: 0,\n          y: height / 2\n        }));\n      }\n    } else if (bottom) {\n      var name_4 = 'link-point-bottom';\n      group['shapeMap'][name_4] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: 0,\n          y: height / 2\n        }),\n        className: name_4,\n        name: name_4,\n        isAnchorPoint: true\n      });\n    }\n  },\n  updateShape: function updateShape(cfg, item, keyShapeStyle, hasIcon, updateType) {\n    var keyShape = item.get('keyShape');\n    keyShape.attr(__assign({}, keyShapeStyle));\n\n    if (!undefined || (updateType === null || updateType === void 0 ? void 0 : updateType.includes('label'))) {\n      this.updateLabel(cfg, item, updateType);\n    }\n\n    if (hasIcon) {\n      this.updateIcon(cfg, item);\n    }\n  },\n  updateIcon: function updateIcon(cfg, item) {\n    var _this = this;\n\n    var group = item.getContainer();\n    var icon = (this.mergeStyle || this.getOptions(cfg)).icon;\n    var show = (cfg.icon ? cfg.icon : {\n      show: undefined\n    }).show;\n    var iconShape = group['shapeMap'][this.type + \"-icon\"] || group.find(function (ele) {\n      return ele.get('name') === _this.type + \"-icon\";\n    });\n\n    if (iconShape) {\n      // 若原先存在 icon\n      if (show || show === undefined) {\n        // 若传入 show: true, 或没有设置，则更新原有的 icon 样式\n        var iconConfig = mix({}, iconShape.attr(), icon);\n        var _a = iconConfig.width,\n            w = _a === void 0 ? 20 : _a,\n            _b = iconConfig.height,\n            h = _b === void 0 ? 20 : _b;\n        iconShape.attr(__assign(__assign({}, iconConfig), {\n          x: -w / 2,\n          y: -h / 2\n        }));\n      } else {\n        // 若传入了 show: false 则删除原先的 icon\n        iconShape.remove();\n      }\n    } else if (show) {\n      // 如果原先不存在 icon，但传入了 show: true，则新增 icon\n      var w = icon.width,\n          h = icon.height;\n      var name_5 = this.type + \"-icon\";\n      group['shapeMap'][name_5] = group.addShape('image', {\n        attrs: __assign(__assign({}, icon), {\n          x: -w / 2,\n          y: -h / 2\n        }),\n        className: name_5,\n        name: name_5\n      }); // to ensure the label is on the top of all the shapes\n\n      var labelShape = group['shapeMap']['node-label'] || group.find(function (ele) {\n        return ele.get('name') === 'node-label';\n      });\n\n      if (labelShape) {\n        labelShape.toFront();\n      }\n    }\n  }\n};\n\nvar singleNodeDef = __assign(__assign({}, shapeBase), singleNode);\n\nShape.registerNode('single-node', singleNodeDef);"]},"metadata":{},"sourceType":"module"}