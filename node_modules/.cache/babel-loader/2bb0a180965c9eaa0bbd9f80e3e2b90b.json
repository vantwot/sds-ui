{"ast":null,"code":"import _slicedToArray from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React from 'react';\nexport var AppContext = React.createContext({\n  cell: null,\n  x6Graph: null,\n  commands: null,\n  modelService: null\n});\nexport var useAppContext = function useAppContext() {\n  return React.useContext(AppContext);\n};\nexport function getNodeReactComponent(Component, commands, modelService) {\n  return function (x6Node) {\n    /* eslint-disable-next-line  */\n    var x6Graph = this;\n    var nodeData = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getData();\n    var size = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getSize();\n    var position = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getPosition();\n\n    var WrappedComponent = function WrappedComponent() {\n      return React.createElement(AppContext.Provider, {\n        value: {\n          cell: x6Node,\n          x6Graph: x6Graph,\n          commands: commands,\n          modelService: modelService\n        }\n      }, React.createElement(Component, {\n        cell: x6Node,\n        data: nodeData,\n        size: size,\n        position: position\n      }));\n    };\n\n    return React.createElement(WrappedComponent, null);\n  };\n}\nexport function getEdgeReactComponent(Component, commands, modelService) {\n  return function (x6Edge) {\n    /* eslint-disable-next-line  */\n    var x6Graph = this;\n    var edgeData = x6Edge === null || x6Edge === void 0 ? void 0 : x6Edge.getData();\n\n    var WrappedComponent = function WrappedComponent() {\n      return React.createElement(AppContext.Provider, {\n        value: {\n          cell: x6Edge,\n          x6Graph: x6Graph,\n          commands: commands,\n          modelService: modelService\n        }\n      }, React.createElement(Component, {\n        data: edgeData,\n        cell: x6Edge\n      }));\n    };\n\n    return React.createElement(WrappedComponent, null);\n  };\n}\n/** 获取节点选中状态 */\n\nexport var useIsNodeSelected = function useIsNodeSelected() {\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isSelected = _React$useState2[0],\n      setIsSelected = _React$useState2[1];\n\n  var _useAppContext = useAppContext(),\n      x6Graph = _useAppContext.x6Graph,\n      cell = _useAppContext.cell;\n\n  React.useEffect(function () {\n    var handler = function handler(_ref) {\n      var added = _ref.added,\n          removed = _ref.removed;\n      var isAdded = added.filter(function (selectedCell) {\n        return selectedCell.isNode();\n      }).some(function (node) {\n        node.id === cell.id;\n      });\n\n      if (isAdded) {\n        cell.setData(Object.assign(Object.assign({}, cell.getData()), {\n          isNodeSelected: true\n        }));\n        setIsSelected(true);\n        return;\n      }\n\n      var isRemoved = removed.filter(function (selectedCell) {\n        return selectedCell.isNode();\n      }).some(function (node) {\n        node.id === cell.id;\n      });\n\n      if (isRemoved) {\n        cell.setData(Object.assign(Object.assign({}, cell.getData()), {\n          isNodeSelected: false\n        }));\n        setIsSelected(false);\n        return;\n      }\n    };\n\n    x6Graph.on('selection:changed', handler);\n    return function () {\n      x6Graph.off('selection:changed', handler);\n    };\n    /* eslint-disable-next-line  */\n  }, [x6Graph]);\n  return [isSelected];\n};","map":{"version":3,"sources":["../../../src/command-contributions/components/context.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React from 'react';\nexport const AppContext = React.createContext({\n    cell: null,\n    x6Graph: null,\n    commands: null,\n    modelService: null,\n});\nexport const useAppContext = () => React.useContext(AppContext);\nexport function getNodeReactComponent(Component, commands, modelService) {\n    return function (x6Node) {\n        /* eslint-disable-next-line  */\n        const x6Graph = this;\n        const nodeData = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getData();\n        const size = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getSize();\n        const position = x6Node === null || x6Node === void 0 ? void 0 : x6Node.getPosition();\n        const WrappedComponent = () => {\n            return (React.createElement(AppContext.Provider, { value: {\n                    cell: x6Node,\n                    x6Graph,\n                    commands,\n                    modelService,\n                } }, React.createElement(Component, {\n                cell: x6Node,\n                data: nodeData,\n                size,\n                position,\n            })));\n        };\n        return React.createElement(WrappedComponent, null);\n    };\n}\nexport function getEdgeReactComponent(Component, commands, modelService) {\n    return function (x6Edge) {\n        /* eslint-disable-next-line  */\n        const x6Graph = this;\n        const edgeData = x6Edge === null || x6Edge === void 0 ? void 0 : x6Edge.getData();\n        const WrappedComponent = () => {\n            return (React.createElement(AppContext.Provider, { value: {\n                    cell: x6Edge,\n                    x6Graph,\n                    commands,\n                    modelService,\n                } }, React.createElement(Component, {\n                data: edgeData,\n                cell: x6Edge,\n            })));\n        };\n        return React.createElement(WrappedComponent, null);\n    };\n}\n/** 获取节点选中状态 */\nexport const useIsNodeSelected = () => {\n    const [isSelected, setIsSelected] = React.useState(false);\n    const { x6Graph, cell } = useAppContext();\n    React.useEffect(() => {\n        const handler = ({ added, removed }) => {\n            const isAdded = added\n                .filter(selectedCell => selectedCell.isNode())\n                .some(node => {\n                node.id === cell.id;\n            });\n            if (isAdded) {\n                cell.setData(Object.assign(Object.assign({}, cell.getData()), { isNodeSelected: true }));\n                setIsSelected(true);\n                return;\n            }\n            const isRemoved = removed\n                .filter(selectedCell => selectedCell.isNode())\n                .some(node => {\n                node.id === cell.id;\n            });\n            if (isRemoved) {\n                cell.setData(Object.assign(Object.assign({}, cell.getData()), { isNodeSelected: false }));\n                setIsSelected(false);\n                return;\n            }\n        };\n        x6Graph.on('selection:changed', handler);\n        return () => {\n            x6Graph.off('selection:changed', handler);\n        };\n        /* eslint-disable-next-line  */\n    }, [x6Graph]);\n    return [isSelected];\n};\n//# sourceMappingURL=context.js.map"]},"metadata":{},"sourceType":"module"}