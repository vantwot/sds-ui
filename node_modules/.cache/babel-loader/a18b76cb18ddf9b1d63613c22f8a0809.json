{"ast":null,"code":"import _defineProperty from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React, { useCallback, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { Empty, Form, Tabs } from 'antd';\nimport { xflowDefaultControls, makeControlMap, getControlFromMap } from './control-map/index';\nexport { FormItemWrapper } from './common/form-item-wrapper';\nvar TabPane = Tabs.TabPane;\nexport var SchemaForm = function SchemaForm(props) {\n  var _classNames;\n\n  var _a;\n\n  var schema = props.schema,\n      formInstance = props.form,\n      className = props.className,\n      triggerUpdate = props.triggerUpdate,\n      defaultControlRender = props.defaultControlRender,\n      afterUpdatingCb = props.afterUpdatingCb,\n      controlMapfromParent = props.controlMap,\n      otherProps = __rest(props, [\"schema\", \"form\", \"className\", \"triggerUpdate\", \"defaultControlRender\", \"afterUpdatingCb\", \"controlMap\"]);\n\n  var tabs = schema.tabs;\n\n  var _Form$useForm = Form.useForm(formInstance),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var controlMap = React.useMemo(function () {\n    return props.controlMap ? props.controlMap : makeControlMap(xflowDefaultControls);\n  }, [props.controlMap]);\n  var innerTriggerUpdate = useCallback(function (values) {\n    if (typeof triggerUpdate === 'function') {\n      triggerUpdate(form, values);\n    }\n  }, [form, triggerUpdate]);\n  /** 初次挂载时设置一次值以激活首次联动 */\n\n  useEffect(function () {\n    form.setFieldsValue({});\n  }, [form]);\n  /** 切换标签时激活联动 */\n\n  var onClickTab = useCallback(function () {\n    requestAnimationFrame(function () {\n      form.setFieldsValue({});\n    });\n  }, [form]);\n  return React.createElement(Form, Object.assign({\n    size: \"small\",\n    form: form,\n    layout: \"vertical\",\n    className: classNames('xflow-json-form', className)\n  }, otherProps), React.createElement(Tabs, {\n    type: \"card\",\n    defaultActiveKey: (_a = tabs[0]) === null || _a === void 0 ? void 0 : _a.name,\n    className: classNames((_classNames = {}, _defineProperty(_classNames, 'tabs', true), _defineProperty(_classNames, 'xTab', true), _defineProperty(_classNames, 'singleTab', (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 1), _defineProperty(_classNames, 'coupleTab', (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 2), _defineProperty(_classNames, 'ternateTab', (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 3), _classNames)),\n    onTabClick: onClickTab\n  }, tabs.map(function (tab) {\n    var tabName = tab.name,\n        groups = tab.groups;\n    return React.createElement(TabPane, {\n      key: tabName,\n      tab: tabName\n    }, groups.length === 0 && React.createElement(Empty, {\n      style: {\n        padding: '24px 0'\n      }\n    }), groups.length > 0 && groups.map(function (group) {\n      var _group$controls = group.controls,\n          groupControls = _group$controls === void 0 ? [] : _group$controls;\n\n      if (groupControls.length === 0) {\n        return React.createElement(Empty, {\n          style: {\n            padding: '24px 0'\n          }\n        });\n      }\n\n      return groupControls.map(function (control) {\n        var shape = control.shape,\n            controlName = control.name;\n        var ControlComponent = getControlFromMap(shape, controlMap, defaultControlRender);\n\n        if (!ControlComponent) {\n          console.error('未找到对应的控件:', shape);\n          return null;\n        }\n\n        return React.createElement(ControlComponent, {\n          key: controlName,\n          form: form,\n          controlSchema: control,\n          triggerUpdate: innerTriggerUpdate,\n          afterUpdatingCb: afterUpdatingCb\n        });\n      });\n    }));\n  })));\n};","map":{"version":3,"sources":["../../../src/canvas-json-schema-form/schema-form/index.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React, { useCallback, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { Empty, Form, Tabs } from 'antd';\nimport { xflowDefaultControls, makeControlMap, getControlFromMap } from './control-map/index';\nexport { FormItemWrapper } from './common/form-item-wrapper';\nconst { TabPane } = Tabs;\nexport const SchemaForm = props => {\n    var _a;\n    const { schema, form: formInstance, className, triggerUpdate, defaultControlRender, afterUpdatingCb, controlMap: controlMapfromParent } = props, otherProps = __rest(props, [\"schema\", \"form\", \"className\", \"triggerUpdate\", \"defaultControlRender\", \"afterUpdatingCb\", \"controlMap\"]);\n    const { tabs } = schema;\n    const [form] = Form.useForm(formInstance);\n    const controlMap = React.useMemo(() => (props.controlMap ? props.controlMap : makeControlMap(xflowDefaultControls)), [props.controlMap]);\n    const innerTriggerUpdate = useCallback((values) => {\n        if (typeof triggerUpdate === 'function') {\n            triggerUpdate(form, values);\n        }\n    }, [form, triggerUpdate]);\n    /** 初次挂载时设置一次值以激活首次联动 */\n    useEffect(() => {\n        form.setFieldsValue({});\n    }, [form]);\n    /** 切换标签时激活联动 */\n    const onClickTab = useCallback(() => {\n        requestAnimationFrame(() => {\n            form.setFieldsValue({});\n        });\n    }, [form]);\n    return (React.createElement(Form, Object.assign({ size: \"small\", form: form, layout: \"vertical\", className: classNames('xflow-json-form', className) }, otherProps),\n        React.createElement(Tabs, { type: \"card\", defaultActiveKey: (_a = tabs[0]) === null || _a === void 0 ? void 0 : _a.name, className: classNames({\n                ['tabs']: true,\n                ['xTab']: true,\n                ['singleTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 1,\n                ['coupleTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 2,\n                ['ternateTab']: (tabs === null || tabs === void 0 ? void 0 : tabs.length) === 3,\n            }), onTabClick: onClickTab }, tabs.map((tab) => {\n            const { name: tabName, groups } = tab;\n            return (React.createElement(TabPane, { key: tabName, tab: tabName },\n                groups.length === 0 && React.createElement(Empty, { style: { padding: '24px 0' } }),\n                groups.length > 0 &&\n                    groups.map(group => {\n                        const { controls: groupControls = [] } = group;\n                        if (groupControls.length === 0) {\n                            return React.createElement(Empty, { style: { padding: '24px 0' } });\n                        }\n                        return groupControls.map(control => {\n                            const { shape, name: controlName } = control;\n                            const ControlComponent = getControlFromMap(shape, controlMap, defaultControlRender);\n                            if (!ControlComponent) {\n                                console.error('未找到对应的控件:', shape);\n                                return null;\n                            }\n                            return (React.createElement(ControlComponent, { key: controlName, form: form, controlSchema: control, triggerUpdate: innerTriggerUpdate, afterUpdatingCb: afterUpdatingCb }));\n                        });\n                    })));\n        }))));\n};\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}