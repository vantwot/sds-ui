{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\nimport { mix } from '@antv/util'; // 五角星shape\n\nregisterNode('star', {\n  // 自定义节点时的配置\n  options: {\n    size: 60,\n    style: {\n      stroke: Global.defaultNode.style.stroke,\n      fill: Global.defaultNode.style.fill,\n      lineWidth: Global.defaultNode.style.lineWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.nodeLabel.style.fill,\n        fontSize: Global.nodeLabel.style.fontSize,\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: Global.defaultNode.linkPoints.size,\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\n      fill: Global.defaultNode.linkPoints.fill,\n      stroke: Global.defaultNode.linkPoints.stroke\n    },\n    // 节点中icon配置\n    icon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: false,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\n      width: 20,\n      height: 20\n    },\n    stateStyles: __assign({}, Global.nodeStateStyles)\n  },\n  shapeType: 'star',\n  // 文本位置\n  labelPosition: 'center',\n  drawShape: function drawShape(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).icon,\n        icon = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var keyShape = group.addShape('path', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    group['shapeMap'][this.type + \"-keyShape\"] = keyShape;\n    var w = icon.width,\n        h = icon.height,\n        show = icon.show,\n        text = icon.text;\n\n    if (show) {\n      if (text) {\n        group['shapeMap'][this.type + \"-icon\"] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      } else {\n        group['shapeMap'][this.type + \"-icon\"] = group.addShape('image', {\n          attrs: __assign({\n            x: -w / 2,\n            y: -h / 2\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      }\n    }\n\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        leftBottom = linkPoints.leftBottom,\n        rightBottom = linkPoints.rightBottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n\n    if (right) {\n      // right circle\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right'\n      });\n    }\n\n    if (top) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\n\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top'\n      });\n    }\n\n    if (left) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\n\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left'\n      });\n    }\n\n    if (leftBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group['shapeMap']['link-point-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom'\n      });\n    }\n\n    if (rightBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group['shapeMap']['link-point-right-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom'\n      });\n    }\n  },\n  getPath: function getPath(cfg) {\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var defaultInnerR = outerR * 3 / 8;\n    var innerR = cfg.innerR || defaultInnerR;\n    var path = [];\n\n    for (var i = 0; i < 5; i++) {\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\n\n      if (i === 0) {\n        path.push(['M', x1, -y1]);\n      } else {\n        path.push(['L', x1, -y1]);\n      }\n\n      path.push(['L', x2, -y2]);\n    }\n\n    path.push(['Z']);\n    return path;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = (this.mergeStyle || this.getOptions(cfg)).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var path = this.getPath(cfg);\n\n    var styles = __assign({\n      path: path\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item, updateType) {\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\n\n    var defaultStyle = this.getOptions({}).style;\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\n\n    var strokeStyle = {\n      stroke: cfg.color,\n      path: path\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\n\n    var keyShape = item.get('keyShape');\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\n    style = mix(style, cfg.style);\n    this.updateShape(cfg, item, style, true, updateType);\n    this.updateLinkPoints(cfg, group);\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\n    var markLeft = group['shapeMap']['link-point-left'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group['shapeMap']['link-point-right'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group['shapeMap']['link-point-top'] || group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markLeftBottom = group['shapeMap']['link-point-left-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left-bottom';\n    });\n    var markRightBottom = group['shapeMap']['link-point-left-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right-bottom';\n    });\n    var currentLinkPoints = defaultLinkPoints;\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\n\n    if (existLinkPoint) {\n      currentLinkPoints = existLinkPoint.attr();\n    }\n\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      leftBottom: undefined,\n      rightBottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        leftBottom = _a.leftBottom,\n        rightBottom = _a.rightBottom;\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n        delete group['shapeMap']['link-point-right'];\n      } else {\n        markRight.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (right) {\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n        delete group['shapeMap']['link-point-top'];\n      } else {\n        markTop.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (top) {\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n        delete group['shapeMap']['link-point-left'];\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (left) {\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\n\n    if (markLeftBottom) {\n      if (!leftBottom && leftBottom !== undefined) {\n        markLeftBottom.remove();\n        delete group['shapeMap']['link-point-left-bottom'];\n      } else {\n        markLeftBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (leftBottom) {\n      group['shapeMap']['link-point-left-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\n\n    if (markRightBottom) {\n      if (!rightBottom && rightBottom !== undefined) {\n        markLeftBottom.remove();\n        delete group['shapeMap']['link-point-right-bottom'];\n      } else {\n        markRightBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (rightBottom) {\n      group['shapeMap']['link-point-right-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom',\n        isAnchorPoint: true\n      });\n    }\n  }\n}, 'single-node');","map":{"version":3,"sources":["/home/manolo/sds-ui/node_modules/@antv/g6-element/es/nodes/star.js"],"names":["__assign","__rest","registerNode","BaseGlobal","Global","mix","options","size","style","stroke","defaultNode","fill","lineWidth","labelCfg","nodeLabel","fontSize","fontFamily","windowFontFamily","linkPoints","top","right","bottom","left","icon","show","img","width","height","stateStyles","nodeStateStyles","shapeType","labelPosition","drawShape","cfg","group","_a","mergeStyle","getOptions","getShapeStyle","keyShape","addShape","attrs","className","type","name","draggable","w","h","text","x","y","textBaseline","textAlign","drawLinkPoints","leftBottom","rightBottom","markSize","markR","r","markStyle","getSize","outerR","x1","Math","cos","PI","y1","sin","getPath","defaultInnerR","innerR","path","i","x2","y2","push","defaultStyle","strokeStyle","color","styles","update","item","updateType","getContainer","get","attr","updateShape","updateLinkPoints","defaultLinkPoints","markLeft","find","element","markRight","markTop","markLeftBottom","markRightBottom","currentLinkPoints","existLinkPoint","markFill","markStroke","borderWidth","undefined","remove","isAnchorPoint"],"mappings":"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","sourcesContent":["import { __assign, __rest } from \"tslib\";\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\nimport { mix } from '@antv/util'; // 五角星shape\n\nregisterNode('star', {\n  // 自定义节点时的配置\n  options: {\n    size: 60,\n    style: {\n      stroke: Global.defaultNode.style.stroke,\n      fill: Global.defaultNode.style.fill,\n      lineWidth: Global.defaultNode.style.lineWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.nodeLabel.style.fill,\n        fontSize: Global.nodeLabel.style.fontSize,\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: Global.defaultNode.linkPoints.size,\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\n      fill: Global.defaultNode.linkPoints.fill,\n      stroke: Global.defaultNode.linkPoints.stroke\n    },\n    // 节点中icon配置\n    icon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: false,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\n      width: 20,\n      height: 20\n    },\n    stateStyles: __assign({}, Global.nodeStateStyles)\n  },\n  shapeType: 'star',\n  // 文本位置\n  labelPosition: 'center',\n  drawShape: function drawShape(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).icon,\n        icon = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var keyShape = group.addShape('path', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    group['shapeMap'][this.type + \"-keyShape\"] = keyShape;\n    var w = icon.width,\n        h = icon.height,\n        show = icon.show,\n        text = icon.text;\n\n    if (show) {\n      if (text) {\n        group['shapeMap'][this.type + \"-icon\"] = group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      } else {\n        group['shapeMap'][this.type + \"-icon\"] = group.addShape('image', {\n          attrs: __assign({\n            x: -w / 2,\n            y: -h / 2\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      }\n    }\n\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\n   * 绘制节点上的LinkPoints\n   * @param {Object} cfg data数据配置项\n   * @param {Group} group Group实例\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = (this.mergeStyle || this.getOptions(cfg)).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        leftBottom = linkPoints.leftBottom,\n        rightBottom = linkPoints.rightBottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n\n    if (right) {\n      // right circle\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right'\n      });\n    }\n\n    if (top) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\n\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top'\n      });\n    }\n\n    if (left) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\n\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left'\n      });\n    }\n\n    if (leftBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group['shapeMap']['link-point-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom'\n      });\n    }\n\n    if (rightBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group['shapeMap']['link-point-right-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom'\n      });\n    }\n  },\n  getPath: function getPath(cfg) {\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var defaultInnerR = outerR * 3 / 8;\n    var innerR = cfg.innerR || defaultInnerR;\n    var path = [];\n\n    for (var i = 0; i < 5; i++) {\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\n\n      if (i === 0) {\n        path.push(['M', x1, -y1]);\n      } else {\n        path.push(['L', x1, -y1]);\n      }\n\n      path.push(['L', x2, -y2]);\n    }\n\n    path.push(['Z']);\n    return path;\n  },\n\n  /**\n   * 获取节点的样式，供基于该节点自定义时使用\n   * @param {Object} cfg 节点数据模型\n   * @return {Object} 节点的样式\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = (this.mergeStyle || this.getOptions(cfg)).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var path = this.getPath(cfg);\n\n    var styles = __assign({\n      path: path\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item, updateType) {\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\n\n    var defaultStyle = this.getOptions({}).style;\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\n\n    var strokeStyle = {\n      stroke: cfg.color,\n      path: path\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\n\n    var keyShape = item.get('keyShape');\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\n    style = mix(style, cfg.style);\n    this.updateShape(cfg, item, style, true, updateType);\n    this.updateLinkPoints(cfg, group);\n  },\n\n  /**\n   * 更新linkPoints\n   * @param {Object} cfg 节点数据配置项\n   * @param {Group} group Item所在的group\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\n    var markLeft = group['shapeMap']['link-point-left'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group['shapeMap']['link-point-right'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group['shapeMap']['link-point-top'] || group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markLeftBottom = group['shapeMap']['link-point-left-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-left-bottom';\n    });\n    var markRightBottom = group['shapeMap']['link-point-left-bottom'] || group.find(function (element) {\n      return element.get('className') === 'link-point-right-bottom';\n    });\n    var currentLinkPoints = defaultLinkPoints;\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\n\n    if (existLinkPoint) {\n      currentLinkPoints = existLinkPoint.attr();\n    }\n\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      leftBottom: undefined,\n      rightBottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        leftBottom = _a.leftBottom,\n        rightBottom = _a.rightBottom;\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n        delete group['shapeMap']['link-point-right'];\n      } else {\n        markRight.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (right) {\n      group['shapeMap']['link-point-right'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n        delete group['shapeMap']['link-point-top'];\n      } else {\n        markTop.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (top) {\n      group['shapeMap']['link-point-top'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n        delete group['shapeMap']['link-point-left'];\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (left) {\n      group['shapeMap']['link-point-left'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\n\n    if (markLeftBottom) {\n      if (!leftBottom && leftBottom !== undefined) {\n        markLeftBottom.remove();\n        delete group['shapeMap']['link-point-left-bottom'];\n      } else {\n        markLeftBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (leftBottom) {\n      group['shapeMap']['link-point-left-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\n\n    if (markRightBottom) {\n      if (!rightBottom && rightBottom !== undefined) {\n        markLeftBottom.remove();\n        delete group['shapeMap']['link-point-right-bottom'];\n      } else {\n        markRightBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (rightBottom) {\n      group['shapeMap']['link-point-right-bottom'] = group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom',\n        isAnchorPoint: true\n      });\n    }\n  }\n}, 'single-node');"]},"metadata":{},"sourceType":"module"}