{"ast":null,"code":"import _regeneratorRuntime from \"/home/manolo/sds-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport React from 'react';\nimport { createModule } from '../module';\nimport { insertCss } from '@antv/xflow-core';\nimport { XFlowAppExtensionMoudle, usePositionStyle } from '@antv/xflow-core';\nimport { SimpleNodeView } from '../x6-node-view';\n/** 配置类型 */\n\nexport var CONFIG_TYPE = 'CanvasMiniMap';\n/** 获取默认配置 */\n\nexport var getDefaultMinimapOptions = function getDefaultMinimapOptions() {\n  return {\n    grid: false,\n    enabled: true,\n    width: 200,\n    height: 120,\n    padding: 8,\n    graphOptions: {\n      async: true,\n      getCellView: function getCellView(cell) {\n        if (cell.isNode()) {\n          return SimpleNodeView;\n        }\n      },\n      createCellView: function createCellView(cell) {\n        if (cell.isEdge()) {\n          return null;\n        }\n      }\n    }\n  };\n};\nexport var CanvasMiniMap = function CanvasMiniMap(props) {\n  var nodeFillColor = props.nodeFillColor,\n      _props$borderColor = props.borderColor,\n      borderColor = _props$borderColor === void 0 ? '#ced4de' : _props$borderColor,\n      _props$handlerColor = props.handlerColor,\n      handlerColor = _props$handlerColor === void 0 ? 'rgba(0,0,0,.3)' : _props$handlerColor,\n      _props$miniMapClz = props.miniMapClz,\n      miniMapClz = _props$miniMapClz === void 0 ? '' : _props$miniMapClz,\n      _props$position = props.position,\n      position = _props$position === void 0 ? {\n    bottom: 12,\n    right: 12\n  } : _props$position,\n      _props$minimapOptions = props.minimapOptions,\n      minimapOptions = _props$minimapOptions === void 0 ? {} : _props$minimapOptions;\n  /** x6画布的dom节点 */\n\n  var minimapRef = React.useRef(null);\n  var minimapConfigRef = React.useRef(props.minimapOptions);\n  var classNameSet = React.useMemo(function () {\n    return new Set([miniMapClz, 'xflow-minimap', 'minimap-instacne-' + Date.now().toString()]);\n  }, [miniMapClz]);\n  var getConfig = React.useMemo(function () {\n    return function () {\n      return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", Object.assign(Object.assign(Object.assign({}, getDefaultMinimapOptions()), minimapConfigRef.current), {\n                  container: minimapRef.current\n                }));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n    };\n  }, [minimapRef]);\n  var style = usePositionStyle(position);\n  React.useEffect(function () {\n    /** 设置minimap容器 */\n    minimapConfigRef.current = minimapOptions;\n  }, [minimapConfigRef, minimapOptions]);\n  React.useEffect(function () {\n    /** 设置Node样式 */\n    if (nodeFillColor) {\n      SimpleNodeView.setNodeFillColor(nodeFillColor);\n    }\n  }, [nodeFillColor]);\n  React.useEffect(function () {\n    var containerSelector = Array.from(classNameSet).reduce(function (acc, clz) {\n      return clz ? \"\".concat(acc, \".\").concat(clz) : acc;\n    }, '');\n    var cssString = \"\\n      \".concat(containerSelector, \" .x6-widget-minimap-viewport {\\n        border: 1px solid \").concat(borderColor, \";\\n        margin: 0;\\n      }\\n      \").concat(containerSelector, \" .x6-widget-minimap-viewport-zoom {\\n        border: 1px solid \").concat(handlerColor, \"; \\n      }\\n    \");\n    var $style = insertCss(cssString);\n    return function () {\n      document.head.removeChild($style);\n    };\n  }, [borderColor, classNameSet, handlerColor]);\n  var clzName = Array.from(classNameSet).join(' ');\n  return React.createElement(XFlowAppExtensionMoudle, {\n    config: {\n      getConfig: getConfig,\n      CONFIG_TYPE: CONFIG_TYPE\n    },\n    createModule: createModule\n  }, React.createElement(\"div\", {\n    ref: minimapRef,\n    className: clzName,\n    style: style\n  }));\n};","map":{"version":3,"sources":["../../../src/canvas-mini-map/components/index.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAP,MAAkB,OAAlB;AACA,SAAS,YAAT,QAA6B,WAA7B;AAEA,SAAS,SAAT,QAA0B,kBAA1B;AACA,SAAS,uBAAT,EAAkC,gBAAlC,QAA0D,kBAA1D;AACA,SAAS,cAAT,QAA+B,iBAA/B;AAGA;;AACA,OAAO,IAAM,WAAW,GAAG,eAApB;AAEP;;AACA,OAAO,IAAM,wBAAwB,GAAG,SAA3B,wBAA2B,GAAK;AAC3C,SAAO;AACL,IAAA,IAAI,EAAE,KADD;AAEL,IAAA,OAAO,EAAE,IAFJ;AAGL,IAAA,KAAK,EAAE,GAHF;AAIL,IAAA,MAAM,EAAE,GAJH;AAKL,IAAA,OAAO,EAAE,CALJ;AAML,IAAA,YAAY,EAAE;AACZ,MAAA,KAAK,EAAE,IADK;AAEZ,MAAA,WAFY,uBAEA,IAFA,EAEI;AACd,YAAI,IAAI,CAAC,MAAL,EAAJ,EAAmB;AACjB,iBAAO,cAAP;AACD;AACF,OANW;AAOZ,MAAA,cAPY,0BAOG,IAPH,EAOO;AACjB,YAAI,IAAI,CAAC,MAAL,EAAJ,EAAmB;AACjB,iBAAO,IAAP;AACD;AACF;AAXW;AANT,GAAP;AAoBD,CArBM;AAiCP,OAAO,IAAM,aAAa,GAAqB,SAAlC,aAAkC,CAAA,KAAK,EAAG;AACrD,MACE,aADF,GAOI,KAPJ,CACE,aADF;AAAA,2BAOI,KAPJ,CAEE,WAFF;AAAA,MAEE,WAFF,mCAEgB,SAFhB;AAAA,4BAOI,KAPJ,CAGE,YAHF;AAAA,MAGE,YAHF,oCAGiB,gBAHjB;AAAA,0BAOI,KAPJ,CAIE,UAJF;AAAA,MAIE,UAJF,kCAIe,EAJf;AAAA,wBAOI,KAPJ,CAKE,QALF;AAAA,MAKE,QALF,gCAKa;AAAE,IAAA,MAAM,EAAE,EAAV;AAAc,IAAA,KAAK,EAAE;AAArB,GALb;AAAA,8BAOI,KAPJ,CAME,cANF;AAAA,MAME,cANF,sCAMmB,EANnB;AAQA;;AACA,MAAM,UAAU,GAAG,KAAK,CAAC,MAAN,CAA6B,IAA7B,CAAnB;AACA,MAAM,gBAAgB,GAAG,KAAK,CAAC,MAAN,CAA8B,KAAK,CAAC,cAApC,CAAzB;AACA,MAAM,YAAY,GAAG,KAAK,CAAC,OAAN,CAAc,YAAK;AACtC,WAAO,IAAI,GAAJ,CAAgB,CACrB,UADqB,EAErB,eAFqB,EAGrB,sBAAsB,IAAI,CAAC,GAAL,GAAW,QAAX,EAHD,CAAhB,CAAP;AAKD,GANoB,EAMlB,CAAC,UAAD,CANkB,CAArB;AAOA,MAAM,SAAS,GAAG,KAAK,CAAC,OAAN,CAChB;AAAA,WAAM;AAAA,aAAW,SAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,wCAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDACf,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EACK,wBAAwB,EAD7B,CAAA,EAEK,gBAAgB,CAAC,OAFtB,CAAA,EAE6B;AAC3B,kBAAA,SAAS,EAAE,UAAU,CAAC;AADK,iBAF7B,CADe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA,EAAX;AAAA,KAAN;AAAA,GADgB,EAQhB,CAAC,UAAD,CARgB,CAAlB;AAUA,MAAM,KAAK,GAAG,gBAAgB,CAAC,QAAD,CAA9B;AAEA,EAAA,KAAK,CAAC,SAAN,CAAgB,YAAK;AACnB;AACA,IAAA,gBAAgB,CAAC,OAAjB,GAA2B,cAA3B;AACD,GAHD,EAGG,CAAC,gBAAD,EAAmB,cAAnB,CAHH;AAKA,EAAA,KAAK,CAAC,SAAN,CAAgB,YAAK;AACnB;AACA,QAAI,aAAJ,EAAmB;AACjB,MAAA,cAAc,CAAC,gBAAf,CAAgC,aAAhC;AACD;AACF,GALD,EAKG,CAAC,aAAD,CALH;AAOA,EAAA,KAAK,CAAC,SAAN,CAAgB,YAAK;AACnB,QAAM,iBAAiB,GAAG,KAAK,CAAC,IAAN,CAAW,YAAX,EAAyB,MAAzB,CACxB,UAAC,GAAD,EAAM,GAAN;AAAA,aAAe,GAAG,aAAM,GAAN,cAAa,GAAb,IAAqB,GAAvC;AAAA,KADwB,EAExB,EAFwB,CAA1B;AAIA,QAAM,SAAS,qBACX,iBADW,uEAES,WAFT,mDAKX,iBALW,4EAMS,YANT,sBAAf;AASA,QAAM,MAAM,GAAG,SAAS,CAAC,SAAD,CAAxB;AAEA,WAAO,YAAK;AACV,MAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,MAA1B;AACD,KAFD;AAGD,GAnBD,EAmBG,CAAC,WAAD,EAAc,YAAd,EAA4B,YAA5B,CAnBH;AAqBA,MAAM,OAAO,GAAG,KAAK,CAAC,IAAN,CAAW,YAAX,EAAyB,IAAzB,CAA8B,GAA9B,CAAhB;AAEA,SACE,KAAA,CAAA,aAAA,CAAC,uBAAD,EAAwB;AACtB,IAAA,MAAM,EAAE;AACN,MAAA,SAAS,EAAT,SADM;AAEN,MAAA,WAAW,EAAX;AAFM,KADc;AAKtB,IAAA,YAAY,EAAE;AALQ,GAAxB,EAOE,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,GAAG,EAAE,UAAV;AAAsB,IAAA,SAAS,EAAE,OAAjC;AAA0C,IAAA,KAAK,EAAE;AAAjD,GAAA,CAPF,CADF;AAWD,CA7EM","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport React from 'react';\nimport { createModule } from '../module';\nimport { insertCss } from '@antv/xflow-core';\nimport { XFlowAppExtensionMoudle, usePositionStyle } from '@antv/xflow-core';\nimport { SimpleNodeView } from '../x6-node-view';\n/** 配置类型 */\nexport const CONFIG_TYPE = 'CanvasMiniMap';\n/** 获取默认配置 */\nexport const getDefaultMinimapOptions = () => {\n    return {\n        grid: false,\n        enabled: true,\n        width: 200,\n        height: 120,\n        padding: 8,\n        graphOptions: {\n            async: true,\n            getCellView(cell) {\n                if (cell.isNode()) {\n                    return SimpleNodeView;\n                }\n            },\n            createCellView(cell) {\n                if (cell.isEdge()) {\n                    return null;\n                }\n            },\n        },\n    };\n};\nexport const CanvasMiniMap = props => {\n    const { nodeFillColor, borderColor = '#ced4de', handlerColor = 'rgba(0,0,0,.3)', miniMapClz = '', position = { bottom: 12, right: 12 }, minimapOptions = {}, } = props;\n    /** x6画布的dom节点 */\n    const minimapRef = React.useRef(null);\n    const minimapConfigRef = React.useRef(props.minimapOptions);\n    const classNameSet = React.useMemo(() => {\n        return new Set([\n            miniMapClz,\n            'xflow-minimap',\n            'minimap-instacne-' + Date.now().toString(),\n        ]);\n    }, [miniMapClz]);\n    const getConfig = React.useMemo(() => () => __awaiter(void 0, void 0, void 0, function* () {\n        return Object.assign(Object.assign(Object.assign({}, getDefaultMinimapOptions()), minimapConfigRef.current), { container: minimapRef.current });\n    }), [minimapRef]);\n    const style = usePositionStyle(position);\n    React.useEffect(() => {\n        /** 设置minimap容器 */\n        minimapConfigRef.current = minimapOptions;\n    }, [minimapConfigRef, minimapOptions]);\n    React.useEffect(() => {\n        /** 设置Node样式 */\n        if (nodeFillColor) {\n            SimpleNodeView.setNodeFillColor(nodeFillColor);\n        }\n    }, [nodeFillColor]);\n    React.useEffect(() => {\n        const containerSelector = Array.from(classNameSet).reduce((acc, clz) => (clz ? `${acc}.${clz}` : acc), '');\n        const cssString = `\n      ${containerSelector} .x6-widget-minimap-viewport {\n        border: 1px solid ${borderColor};\n        margin: 0;\n      }\n      ${containerSelector} .x6-widget-minimap-viewport-zoom {\n        border: 1px solid ${handlerColor}; \n      }\n    `;\n        const $style = insertCss(cssString);\n        return () => {\n            document.head.removeChild($style);\n        };\n    }, [borderColor, classNameSet, handlerColor]);\n    const clzName = Array.from(classNameSet).join(' ');\n    return (React.createElement(XFlowAppExtensionMoudle, { config: {\n            getConfig,\n            CONFIG_TYPE,\n        }, createModule: createModule },\n        React.createElement(\"div\", { ref: minimapRef, className: clzName, style: style })));\n};\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}