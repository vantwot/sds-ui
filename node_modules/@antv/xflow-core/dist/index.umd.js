!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@antv/x6"),require("react-dom"),require("@antv/x6-react-shape"),require("@antv/layout"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","react","@antv/x6","react-dom","@antv/x6-react-shape","@antv/layout","lodash"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).XFlowCore={},e.React,e.X6,e.ReactDOM,e.X6ReactShape,e.layout,e.lodash)}(this,(function(e,t,n,i,o,r,s){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var u=a(t),d=c(t),l=a(i),h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f={},p={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.NON_CUSTOM_TAG_KEYS=[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]}(p);var g={},v={},y={};Object.defineProperty(y,"__esModule",{value:!0}),y.TargetTypeEnum=y.BindingTypeEnum=y.BindingScopeEnum=void 0;y.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};y.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};y.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.id=void 0;var b=0;m.id=function(){return b++},Object.defineProperty(v,"__esModule",{value:!0}),v.Binding=void 0;var _=y,E=m,C=function(){function e(e,t){this.id=E.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=_.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===_.BindingScopeEnum.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();v.Binding=C;var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.STACK_OVERFLOW=w.CIRCULAR_DEPENDENCY_IN_FACTORY=w.POST_CONSTRUCT_ERROR=w.MULTIPLE_POST_CONSTRUCT_METHODS=w.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=w.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=w.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=w.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=w.ARGUMENTS_LENGTH_MISMATCH=w.INVALID_DECORATOR_OPERATION=w.INVALID_TO_SELF_VALUE=w.INVALID_FUNCTION_BINDING=w.INVALID_MIDDLEWARE_RETURN=w.NO_MORE_SNAPSHOTS_AVAILABLE=w.INVALID_BINDING_TYPE=w.NOT_IMPLEMENTED=w.CIRCULAR_DEPENDENCY=w.UNDEFINED_INJECT_ANNOTATION=w.MISSING_INJECT_ANNOTATION=w.MISSING_INJECTABLE_ANNOTATION=w.NOT_REGISTERED=w.CANNOT_UNBIND=w.AMBIGUOUS_MATCH=w.KEY_NOT_FOUND=w.NULL_ARGUMENT=w.DUPLICATED_METADATA=w.DUPLICATED_INJECTABLE_DECORATOR=void 0,w.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",w.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",w.NULL_ARGUMENT="NULL argument",w.KEY_NOT_FOUND="Key Not Found",w.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",w.CANNOT_UNBIND="Could not unbind serviceIdentifier:",w.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",w.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",w.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";w.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},w.CIRCULAR_DEPENDENCY="Circular dependency found:",w.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",w.INVALID_BINDING_TYPE="Invalid binding type:",w.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",w.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",w.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",w.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",w.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";w.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},w.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",w.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",w.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",w.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",w.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";w.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]};w.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},w.STACK_OVERFLOW="Maximum call stack size exceeded";var O={};Object.defineProperty(O,"__esModule",{value:!0}),O.MetadataReader=void 0;var x=p,A=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(x.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(x.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(x.TAGGED_PROP,e)||[]},e}();O.MetadataReader=A;var T={},S={};Object.defineProperty(S,"__esModule",{value:!0}),S.BindingCount=void 0;S.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};var N={};Object.defineProperty(N,"__esModule",{value:!0}),N.isStackOverflowExeption=void 0;var P=w;N.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===P.STACK_OVERFLOW};var I={};Object.defineProperty(I,"__esModule",{value:!0}),I.circularDependencyToException=I.listMetadataForTarget=I.listRegisteredBindingsForServiceIdentifier=I.getServiceIdentifierAsString=I.getFunctionName=void 0;var k=w;function M(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function D(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||D(e.parentRequest,t))}function R(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}I.getServiceIdentifierAsString=M,I.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var i="",o=n(e,t);return 0!==o.length&&(i="\nRegistered bindings:",o.forEach((function(e){var t="Object";null!==e.implementationType&&(t=R(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i},I.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(D(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var i=M(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(k.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},I.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),o=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==o&&o.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},I.getFunctionName=R;var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.Context=void 0;var G=m,F=function(){function e(e){this.id=G.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();j.Context=F;var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.Metadata=void 0;var L=p,B=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===L.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();U.Metadata=B;var H={};Object.defineProperty(H,"__esModule",{value:!0}),H.Plan=void 0;var V=function(e,t){this.parentContext=e,this.rootRequest=t};H.Plan=V;var X={},z={},K={};Object.defineProperty(K,"__esModule",{value:!0}),K.tagProperty=K.tagParameter=K.decorate=void 0;var W=w,Y=p;function q(e,t,n,i,o){var r={},s="number"==typeof o,a=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(W.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(r=Reflect.getMetadata(e,t));var c=r[a];if(Array.isArray(c))for(var u=0,d=c;u<d.length;u++){var l=d[u];if(l.key===i.key)throw new Error(W.DUPLICATED_METADATA+" "+l.key.toString())}else c=[];c.push(i),r[a]=c,Reflect.defineMetadata(e,r,t)}function $(e,t){Reflect.decorate(e,t)}function J(e,t){return function(n,i){t(n,i,e)}}K.tagParameter=function(e,t,n,i){q(Y.TAGGED,e,t,i,n)},K.tagProperty=function(e,t,n){q(Y.TAGGED_PROP,e.constructor,t,n)},K.decorate=function(e,t,n){"number"==typeof n?$([J(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):$([e],t)},Object.defineProperty(z,"__esModule",{value:!0}),z.inject=z.LazyServiceIdentifer=void 0;var Z=w,Q=p,ee=U,te=K,ne=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();z.LazyServiceIdentifer=ne,z.inject=function(e){return function(t,n,i){if(void 0===e)throw new Error(Z.UNDEFINED_INJECT_ANNOTATION(t.name));var o=new ee.Metadata(Q.INJECT_TAG,e);"number"==typeof i?te.tagParameter(t,n,i,o):te.tagProperty(t,n,o)}};var ie={},oe={};Object.defineProperty(oe,"__esModule",{value:!0}),oe.QueryableString=void 0;var re=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();oe.QueryableString=re,Object.defineProperty(ie,"__esModule",{value:!0}),ie.Target=void 0;var se=p,ae=m,ce=U,ue=oe,de=function(){function e(e,t,n,i){this.id=ae.id(),this.type=e,this.serviceIdentifier=n,this.name=new ue.QueryableString(t||""),this.metadata=new Array;var o=null;"string"==typeof i?o=new ce.Metadata(se.NAMED_TAG,i):i instanceof ce.Metadata&&(o=i),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(se.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(se.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(se.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return se.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(se.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===se.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return se.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(se.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var r=o[i];if(r.key===e&&r.value===n)return!0}return!1}},e}();ie.Target=de,function(e){var t=h&&h.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=e.getBaseClassDependencyCount=e.getDependencies=void 0;var n=z,i=w,o=y,r=p,s=I;Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return s.getFunctionName}});var a=ie;function c(e,n,o,r){var s=e.getConstructorMetadata(o),a=s.compilerGeneratedMetadata;if(void 0===a){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+n+".";throw new Error(c)}var l=s.userGeneratedMetadata,h=Object.keys(l),f=0===o.length&&h.length>0,p=h.length>o.length,g=function(e,t,n,i,o){for(var r=[],s=0;s<o;s++){var a=u(s,e,t,n,i);null!==a&&r.push(a)}return r}(r,n,a,l,f||p?h.length:o.length),v=d(e,o);return t(t([],g),v)}function u(e,t,r,s,c){var u=c[e.toString()]||[],d=l(u),h=!0!==d.unmanaged,f=s[e],p=d.inject||d.multiInject;if((f=p||f)instanceof n.LazyServiceIdentifer&&(f=f.unwrap()),h){if(!t&&(f===Object||f===Function||void 0===f)){var g=i.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+r+".";throw new Error(g)}var v=new a.Target(o.TargetTypeEnum.ConstructorArgument,d.targetName,f);return v.metadata=u,v}return null}function d(e,n){for(var i=e.getPropertiesMetadata(n),r=[],s=0,c=Object.keys(i);s<c.length;s++){var u=c[s],h=i[u],f=l(i[u]),p=f.targetName||u,g=f.inject||f.multiInject,v=new a.Target(o.TargetTypeEnum.ClassProperty,p,g);v.metadata=h,r.push(v)}var y=Object.getPrototypeOf(n.prototype).constructor;if(y!==Object){var m=d(e,y);r=t(t([],r),m)}return r}function l(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[r.INJECT_TAG],multiInject:t[r.MULTI_INJECT_TAG],targetName:t[r.NAME_TAG],unmanaged:t[r.UNMANAGED_TAG]}}e.getDependencies=function(e,t){return c(e,s.getFunctionName(t),t,!1)},e.getBaseClassDependencyCount=function e(t,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var o=c(t,s.getFunctionName(i),i,!0),a=o.map((function(e){return e.metadata.filter((function(e){return e.key===r.UNMANAGED_TAG}))})),u=[].concat.apply([],a).length,d=o.length-u;return d>0?d:e(t,i)}return 0}}(X);var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.Request=void 0;var he=m,fe=function(){function e(e,t,n,i,o){this.id=he.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var o=new e(t,this.parentContext,this,n,i);return this.childRequests.push(o),o},e}();le.Request=fe,Object.defineProperty(T,"__esModule",{value:!0}),T.getBindingDictionary=T.createMockRequest=T.plan=void 0;var pe=S,ge=w,ve=y,ye=p,me=N,be=I,_e=j,Ee=U,Ce=H,we=X,Oe=le,xe=ie;function Ae(e){return e._bindingDictionary}function Te(e,t,n,i,o){var r=Ne(n.container,o.serviceIdentifier),s=[];return r.length===pe.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof o.serviceIdentifier&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),r=Ne(n.container,o.serviceIdentifier)),s=t?r:r.filter((function(e){var t=new Oe.Request(e.serviceIdentifier,n,i,e,o);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case pe.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var o=be.getServiceIdentifierAsString(e),r=ge.NOT_REGISTERED;throw r+=be.listMetadataForTarget(o,n),r+=be.listRegisteredBindingsForServiceIdentifier(i,o,Ne),new Error(r);case pe.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case pe.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;o=be.getServiceIdentifierAsString(e),r=ge.AMBIGUOUS_MATCH+" "+o;throw r+=be.listRegisteredBindingsForServiceIdentifier(i,o,Ne),new Error(r)}}(o.serviceIdentifier,s,o,n.container),s}function Se(e,t,n,i,o,r){var s,a;if(null===o){s=Te(e,t,i,null,r),a=new Oe.Request(n,i,null,s,r);var c=new Ce.Plan(i,a);i.addPlan(c)}else s=Te(e,t,i,o,r),a=o.addChildRequest(r.serviceIdentifier,s,r);s.forEach((function(t){var n=null;if(r.isArray())n=a.addChildRequest(t.serviceIdentifier,t,r);else{if(t.cache)return;n=a}if(t.type===ve.BindingTypeEnum.Instance&&null!==t.implementationType){var o=we.getDependencies(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var s=we.getBaseClassDependencyCount(e,t.implementationType);if(o.length<s){var c=ge.ARGUMENTS_LENGTH_MISMATCH(we.getFunctionName(t.implementationType));throw new Error(c)}}o.forEach((function(t){Se(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function Ne(e,t){var n=[],i=Ae(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=Ne(e.parent,t)),n}T.getBindingDictionary=Ae,T.plan=function(e,t,n,i,o,r,s,a){void 0===a&&(a=!1);var c=new _e.Context(t),u=function(e,t,n,i,o,r){var s=e?ye.MULTI_INJECT_TAG:ye.INJECT_TAG,a=new Ee.Metadata(s,n),c=new xe.Target(t,i,n,a);if(void 0!==o){var u=new Ee.Metadata(o,r);c.metadata.push(u)}return c}(n,i,o,"",r,s);try{return Se(e,a,o,c,null,u),c}catch(e){throw me.isStackOverflowExeption(e)&&c.plan&&be.circularDependencyToException(c.plan.rootRequest),e}},T.createMockRequest=function(e,t,n,i){var o=new xe.Target(ve.TargetTypeEnum.Variable,"",t,new Ee.Metadata(n,i)),r=new _e.Context(e);return new Oe.Request(t,r,null,[],o)};var Pe={},Ie={},ke=h&&h.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.resolveInstance=void 0;var Me=w,De=y,Re=p;Ie.resolveInstance=function(e,t,n){var i,o,r=null;if(t.length>0){var s=t.filter((function(e){return null!==e.target&&e.target.type===De.TargetTypeEnum.ConstructorArgument})).map(n);o=s,r=function(e,t,n){var i=t.filter((function(e){return null!==e.target&&e.target.type===De.TargetTypeEnum.ClassProperty})),o=i.map(n);return i.forEach((function(t,n){var i;i=t.target.name.value();var r=o[n];e[i]=r})),e}(r=new((i=e).bind.apply(i,ke([void 0],o))),t,n)}else r=new e;return function(e,t){if(Reflect.hasMetadata(Re.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(Re.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(Me.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,r),r},Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.resolve=void 0;var je=w,Ge=y,Fe=N,Ue=I,Le=Ie,Be=function(e,t,n){try{return n()}catch(n){throw Fe.isStackOverflowExeption(n)?new Error(je.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},He=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,o=t.target&&t.target.isArray(),r=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(o&&r)return i.map((function(t){return He(e)(t)}));var s=null;if(!t.target.isOptional()||0!==n.length){var a=n[0],c=a.scope===Ge.BindingScopeEnum.Singleton,u=a.scope===Ge.BindingScopeEnum.Request;if(c&&a.activated)return a.cache;if(u&&null!==e&&e.has(a.id))return e.get(a.id);if(a.type===Ge.BindingTypeEnum.ConstantValue)s=a.cache,a.activated=!0;else if(a.type===Ge.BindingTypeEnum.Function)s=a.cache,a.activated=!0;else if(a.type===Ge.BindingTypeEnum.Constructor)s=a.implementationType;else if(a.type===Ge.BindingTypeEnum.DynamicValue&&null!==a.dynamicValue)s=Be("toDynamicValue",a.serviceIdentifier,(function(){return a.dynamicValue(t.parentContext)}));else if(a.type===Ge.BindingTypeEnum.Factory&&null!==a.factory)s=Be("toFactory",a.serviceIdentifier,(function(){return a.factory(t.parentContext)}));else if(a.type===Ge.BindingTypeEnum.Provider&&null!==a.provider)s=Be("toProvider",a.serviceIdentifier,(function(){return a.provider(t.parentContext)}));else{if(a.type!==Ge.BindingTypeEnum.Instance||null===a.implementationType){var d=Ue.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(je.INVALID_BINDING_TYPE+" "+d)}s=Le.resolveInstance(a.implementationType,i,He(e))}return"function"==typeof a.onActivation&&(s=a.onActivation(t.parentContext,s)),c&&(a.cache=s,a.activated=!0),u&&null!==e&&!e.has(a.id)&&e.set(a.id,s),s}}};Pe.resolve=function(e){return He(e.plan.rootRequest.requestScope)(e.plan.rootRequest)};var Ve={},Xe={},ze={},Ke={},We={},Ye={},qe={};Object.defineProperty(qe,"__esModule",{value:!0}),qe.typeConstraint=qe.namedConstraint=qe.taggedConstraint=qe.traverseAncerstors=void 0;var $e=p,Je=U,Ze=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Ze(n,t))};qe.traverseAncerstors=Ze;var Qe=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new Je.Metadata(e,t),n}};qe.taggedConstraint=Qe;var et=Qe($e.NAMED_TAG);qe.namedConstraint=et;qe.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.BindingWhenSyntax=void 0;var tt=We,nt=qe,it=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=nt.namedConstraint(e),new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new tt.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=nt.taggedConstraint(e)(t),new tt.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return nt.typeConstraint(e)(t.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return nt.namedConstraint(e)(t.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return nt.taggedConstraint(e)(t)(n.parentRequest)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,nt.typeConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,nt.typeConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,nt.namedConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,nt.namedConstraint(e))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return nt.traverseAncerstors(n,nt.taggedConstraint(e)(t))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!nt.traverseAncerstors(n,nt.taggedConstraint(e)(t))},new tt.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return nt.traverseAncerstors(t,e)},new tt.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!nt.traverseAncerstors(t,e)},new tt.BindingOnSyntax(this._binding)},e}();Ye.BindingWhenSyntax=it,Object.defineProperty(We,"__esModule",{value:!0}),We.BindingOnSyntax=void 0;var ot=Ye,rt=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ot.BindingWhenSyntax(this._binding)},e}();We.BindingOnSyntax=rt,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.BindingWhenOnSyntax=void 0;var st=We,at=Ye,ct=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new at.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new st.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();Ke.BindingWhenOnSyntax=ct,Object.defineProperty(ze,"__esModule",{value:!0}),ze.BindingInSyntax=void 0;var ut=y,dt=Ke,lt=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=ut.BindingScopeEnum.Request,new dt.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=ut.BindingScopeEnum.Singleton,new dt.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=ut.BindingScopeEnum.Transient,new dt.BindingWhenOnSyntax(this._binding)},e}();ze.BindingInSyntax=lt,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.BindingInWhenOnSyntax=void 0;var ht=ze,ft=We,pt=Ye,gt=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new pt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new ft.BindingOnSyntax(this._binding),this._bindingInSyntax=new ht.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();Xe.BindingInWhenOnSyntax=gt,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.BindingToSyntax=void 0;var vt=w,yt=y,mt=Xe,bt=Ke,_t=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=yt.BindingTypeEnum.Instance,this._binding.implementationType=e,new mt.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+vt.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=yt.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=yt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=yt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new mt.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=yt.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=yt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=yt.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=yt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(vt.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=yt.BindingTypeEnum.Function,this._binding.scope=yt.BindingScopeEnum.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=yt.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=yt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=yt.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=yt.BindingScopeEnum.Singleton,new bt.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();Ve.BindingToSyntax=_t;var Et={};Object.defineProperty(Et,"__esModule",{value:!0}),Et.ContainerSnapshot=void 0;var Ct=function(){function e(){}return e.of=function(t,n){var i=new e;return i.bindings=t,i.middleware=n,i},e}();Et.ContainerSnapshot=Ct;var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.Lookup=void 0;var Ot=w,xt=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(Ot.NULL_ARGUMENT);if(null==t)throw new Error(Ot.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(Ot.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(Ot.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(Ot.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Ot.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,i){var o=n.filter((function(t){return!e(t)}));o.length>0?t._map.set(i,o):t._map.delete(i)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(Ot.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();wt.Lookup=xt;var At=h&&h.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},Tt=h&&h.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},St=h&&h.__spreadArray||function(e,t){for(var n=0,i=t.length,o=e.length;n<i;n++,o++)e[o]=t[n];return e};Object.defineProperty(g,"__esModule",{value:!0}),g.Container=void 0;var Nt=v,Pt=w,It=y,kt=p,Mt=O,Dt=T,Rt=Pe,jt=Ve,Gt=m,Ft=I,Ut=Et,Lt=wt,Bt=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error(""+Pt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=It.BindingScopeEnum.Transient;else if(t.defaultScope!==It.BindingScopeEnum.Singleton&&t.defaultScope!==It.BindingScopeEnum.Transient&&t.defaultScope!==It.BindingScopeEnum.Request)throw new Error(""+Pt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+Pt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+Pt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Gt.id(),this._bindingDictionary=new Lt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Mt.MetadataReader}return e.merge=function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=new e,s=St([t,n],i).map((function(e){return Dt.getBindingDictionary(e)})),a=Dt.getBindingDictionary(r);function c(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s.forEach((function(e){c(e,a)})),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var r=o[i],s=n(r.id);r.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return At(this,void 0,void 0,(function(){var t,n,i,o,r;return Tt(this,(function(s){switch(s.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,s.label=1;case 1:return n<i.length?(o=i[n],r=t(o.id),[4,o.registry(r.bindFunction,r.unbindFunction,r.isboundFunction,r.rebindFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=i(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||It.BindingScopeEnum.Transient,n=new Nt.Binding(e,t);return this._bindingDictionary.add(e,n),new jt.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Pt.CANNOT_UNBIND+" "+Ft.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Lt.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,kt.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),r=Dt.createMockRequest(this,e,t,n);i=o.some((function(e){return e.constraint(r)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(Ut.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(Pt.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,It.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,It.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,kt.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,It.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,It.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,kt.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var o=e.rebind.bind(e)(i);return t(o,n),o}};return function(i){return{bindFunction:(o=i,function(n){var i=e.bind.bind(e)(n);return t(i,o),i}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(i),unbindFunction:function(t){e.unbind.bind(e)(t)}};var o}},e.prototype._get=function(e,t,n,i,o,r){var s=null,a={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:o,serviceIdentifier:i,targetType:n,value:r};if(this._middleware){if(null==(s=this._middleware(a)))throw new Error(Pt.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(a);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=Dt.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),Rt.resolve(n)}},e}();g.Container=Bt;var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.AsyncContainerModule=Ht.ContainerModule=void 0;var Vt=m,Xt=function(e){this.id=Vt.id(),this.registry=e};Ht.ContainerModule=Xt;var zt=function(e){this.id=Vt.id(),this.registry=e};Ht.AsyncContainerModule=zt;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.injectable=void 0;var Wt=w,Yt=p;Kt.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(Yt.PARAM_TYPES,e))throw new Error(Wt.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(Yt.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(Yt.PARAM_TYPES,t,e),e}};var qt={};Object.defineProperty(qt,"__esModule",{value:!0}),qt.tagged=void 0;var $t=U,Jt=K;qt.tagged=function(e,t){return function(n,i,o){var r=new $t.Metadata(e,t);"number"==typeof o?Jt.tagParameter(n,i,o,r):Jt.tagProperty(n,i,r)}};var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.named=void 0;var Qt=p,en=U,tn=K;Zt.named=function(e){return function(t,n,i){var o=new en.Metadata(Qt.NAMED_TAG,e);"number"==typeof i?tn.tagParameter(t,n,i,o):tn.tagProperty(t,n,o)}};var nn={};Object.defineProperty(nn,"__esModule",{value:!0}),nn.optional=void 0;var on=p,rn=U,sn=K;nn.optional=function(){return function(e,t,n){var i=new rn.Metadata(on.OPTIONAL_TAG,!0);"number"==typeof n?sn.tagParameter(e,t,n,i):sn.tagProperty(e,t,i)}};var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.unmanaged=void 0;var cn=p,un=U,dn=K;an.unmanaged=function(){return function(e,t,n){var i=new un.Metadata(cn.UNMANAGED_TAG,!0);dn.tagParameter(e,t,n,i)}};var ln={};Object.defineProperty(ln,"__esModule",{value:!0}),ln.multiInject=void 0;var hn=p,fn=U,pn=K;ln.multiInject=function(e){return function(t,n,i){var o=new fn.Metadata(hn.MULTI_INJECT_TAG,e);"number"==typeof i?pn.tagParameter(t,n,i,o):pn.tagProperty(t,n,o)}};var gn={};Object.defineProperty(gn,"__esModule",{value:!0}),gn.targetName=void 0;var vn=p,yn=U,mn=K;gn.targetName=function(e){return function(t,n,i){var o=new yn.Metadata(vn.NAME_TAG,e);mn.tagParameter(t,n,i,o)}};var bn={};Object.defineProperty(bn,"__esModule",{value:!0}),bn.postConstruct=void 0;var _n=w,En=p,Cn=U;bn.postConstruct=function(){return function(e,t,n){var i=new Cn.Metadata(En.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(En.POST_CONSTRUCT,e.constructor))throw new Error(_n.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(En.POST_CONSTRUCT,i,e.constructor)}};var wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.multiBindToService=void 0;var On,xn,An;function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){Mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}function Pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function In(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kn(e,t,n){return t&&In(e.prototype,t),n&&In(e,n),e}function Mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e){return function(e){if(Array.isArray(e))return Rn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */()}function Rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function jn(e,t){return t.lifecycle===xn.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function Gn(e,t){e.whenTargetNamed(Ln(t))}function Fn(e,t){return t.container.bind(Bn(e))}function Un(e,t){var n=t.container.parent,i=n&&n.isBound(Bn(e));return t.container.isBound(Bn(e))&&!i?t.container.rebind(Bn(e)):t.container.bind(Bn(e))}function Ln(e){return An.isDefinedToken(e)?e.symbol:e}function Bn(e){return An.isDefinedToken(e)?e.symbol:e}wn.multiBindToService=function(e){return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){return e.bind(n).toService(t)}))}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=e.getServiceIdentifierAsString=e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=e.decorate=e.id=e.MetadataReader=e.postConstruct=e.targetName=e.multiInject=e.unmanaged=e.optional=e.LazyServiceIdentifer=e.inject=e.named=e.tagged=e.injectable=e.ContainerModule=e.AsyncContainerModule=e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=e.Container=e.METADATA_KEY=void 0;var t=p;e.METADATA_KEY=t;var n=g;Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return n.Container}});var i=y;Object.defineProperty(e,"BindingScopeEnum",{enumerable:!0,get:function(){return i.BindingScopeEnum}}),Object.defineProperty(e,"BindingTypeEnum",{enumerable:!0,get:function(){return i.BindingTypeEnum}}),Object.defineProperty(e,"TargetTypeEnum",{enumerable:!0,get:function(){return i.TargetTypeEnum}});var o=Ht;Object.defineProperty(e,"AsyncContainerModule",{enumerable:!0,get:function(){return o.AsyncContainerModule}}),Object.defineProperty(e,"ContainerModule",{enumerable:!0,get:function(){return o.ContainerModule}});var r=Kt;Object.defineProperty(e,"injectable",{enumerable:!0,get:function(){return r.injectable}});var s=qt;Object.defineProperty(e,"tagged",{enumerable:!0,get:function(){return s.tagged}});var a=Zt;Object.defineProperty(e,"named",{enumerable:!0,get:function(){return a.named}});var c=z;Object.defineProperty(e,"inject",{enumerable:!0,get:function(){return c.inject}}),Object.defineProperty(e,"LazyServiceIdentifer",{enumerable:!0,get:function(){return c.LazyServiceIdentifer}});var u=nn;Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return u.optional}});var d=an;Object.defineProperty(e,"unmanaged",{enumerable:!0,get:function(){return d.unmanaged}});var l=ln;Object.defineProperty(e,"multiInject",{enumerable:!0,get:function(){return l.multiInject}});var h=gn;Object.defineProperty(e,"targetName",{enumerable:!0,get:function(){return h.targetName}});var f=bn;Object.defineProperty(e,"postConstruct",{enumerable:!0,get:function(){return f.postConstruct}});var v=O;Object.defineProperty(e,"MetadataReader",{enumerable:!0,get:function(){return v.MetadataReader}});var b=m;Object.defineProperty(e,"id",{enumerable:!0,get:function(){return b.id}});var _=K;Object.defineProperty(e,"decorate",{enumerable:!0,get:function(){return _.decorate}});var E=qe;Object.defineProperty(e,"traverseAncerstors",{enumerable:!0,get:function(){return E.traverseAncerstors}}),Object.defineProperty(e,"taggedConstraint",{enumerable:!0,get:function(){return E.taggedConstraint}}),Object.defineProperty(e,"namedConstraint",{enumerable:!0,get:function(){return E.namedConstraint}}),Object.defineProperty(e,"typeConstraint",{enumerable:!0,get:function(){return E.typeConstraint}});var C=I;Object.defineProperty(e,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return C.getServiceIdentifierAsString}});var w=wn;Object.defineProperty(e,"multiBindToService",{enumerable:!0,get:function(){return w.multiBindToService}})}(f),function(e){!function(t){var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!r&&!s,c={create:r?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(d||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,i){if(R(n)){if(!X(e))throw new TypeError;if(!K(t))throw new TypeError;return O(e,t)}if(!X(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(i)&&!R(i)&&!j(i))throw new TypeError;return j(i)&&(i=void 0),x(e,t,n=V(n),i)}function g(e,t){function n(n,i){if(!F(n))throw new TypeError;if(!R(i)&&!W(i))throw new TypeError;I(e,t,n,i)}return n}function v(e,t,n,i){if(!F(n))throw new TypeError;return R(i)||(i=V(i)),I(e,t,n,i)}function y(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),T(e,t,n)}function m(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),S(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),N(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),P(e,t,n)}function E(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),k(e,t)}function C(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),M(e,t)}function w(e,t,n){if(!F(t))throw new TypeError;R(n)||(n=V(n));var i=A(t,n,!1);if(R(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var o=f.get(t);return o.delete(n),o.size>0||f.delete(t),!0}function O(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!R(i)&&!j(i)){if(!K(i))throw new TypeError;t=i}}return t}function x(e,t,n,i){for(var o=e.length-1;o>=0;--o){var r=(0,e[o])(t,n,i);if(!R(r)&&!j(r)){if(!F(r))throw new TypeError;i=r}}return i}function A(e,t,n){var i=f.get(e);if(R(i)){if(!n)return;i=new l,f.set(e,i)}var o=i.get(t);if(R(o)){if(!n)return;o=new l,i.set(t,o)}return o}function T(e,t,n){if(S(e,t,n))return!0;var i=Q(t);return!j(i)&&T(e,i,n)}function S(e,t,n){var i=A(t,n,!1);return!R(i)&&B(i.has(e))}function N(e,t,n){if(S(e,t,n))return P(e,t,n);var i=Q(t);return j(i)?void 0:N(e,i,n)}function P(e,t,n){var i=A(t,n,!1);if(!R(i))return i.get(e)}function I(e,t,n,i){A(n,i,!0).set(e,t)}function k(e,t){var n=M(e,t),i=Q(e);if(null===i)return n;var o=k(i,t);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new h,s=[],a=0,c=n;a<c.length;a++){var u=c[a];r.has(u)||(r.add(u),s.push(u))}for(var d=0,l=o;d<l.length;d++){u=l[d];r.has(u)||(r.add(u),s.push(u))}return s}function M(e,t){var n=[],i=A(e,t,!1);if(R(i))return n;for(var o=q(i.keys()),r=0;;){var s=J(o);if(!s)return n.length=r,n;var a=$(s);try{n[r]=a}catch(e){try{Z(o)}finally{throw e}}r++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function R(e){return void 0===e}function j(e){return null===e}function G(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",o=Y(e,i);if(void 0!==o){var r=o.call(e,n);if(F(r))throw new TypeError;return r}return L(e,"default"===n?"number":n)}function L(e,t){if("string"===t){var n=e.toString;if(z(n))if(!F(o=n.call(e)))return o;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o}else{var i;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o;var o,r=e.toString;if(z(r))if(!F(o=r.call(e)))return o}throw new TypeError}function B(e){return!!e}function H(e){return""+e}function V(e){var t=U(e,3);return G(t)?t:H(t)}function X(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function K(e){return"function"==typeof e}function W(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function q(e){var t=Y(e,o);if(!z(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function $(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var o=i.constructor;return"function"!=typeof o||o===e?t:o}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,o=n+1;o<i;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,r)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function r(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=o();return function(){function e(){this._key=o()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=o()},e}();function o(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function r(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var o=t[i];4!==i&&6!==i&&8!==i||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",v),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",E),e("getOwnMetadataKeys",C),e("deleteMetadata",w)}(i)}()}(On||(On={})),function(e){e.defineToken=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,n)};var t;e.DefinedToken=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Pn(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var i=n.multiple,o=void 0!==i&&i;this.name=t,this.symbol=Symbol(this.name),this.multiple=o},e.isModule=function(e){return!!e&&"object"===Nn(e)&&"id"in e&&"registry"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(xn||(xn={})),function(e){e.maybeArrayToArray=function(e){return e instanceof Array?e:void 0!==e?[e]:[]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===Nn(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==Nn(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===Nn(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(An||(An={}));var Hn=new f.Container;function Vn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=f.injectable();return function(n){Reflect.defineMetadata(xn.ClassOptionSymbol,Sn(Sn({},e),{},{target:n}),n),t(n)}}function Xn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vn(Sn(Sn({},e),{},{lifecycle:xn.Lifecycle.singleton}))}function zn(e){return f.inject(Bn(e))}function Kn(e){return f.named(Ln(e))}var Wn=Symbol("SyringeOptionSymbol");var Yn=function(){function e(t,n,i){Pn(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=t,this.token=n,this.option=i,this.rawToken=An.isNamedToken(n)?n.token:n,this.named=An.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||An.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return kn(e,[{key:"resolve",value:function(){var e,t=this,n=this.context;(e=n)&&"object"===Nn(e)&&"container"in e&&"inversify"in e&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(e){An.isMultipleEnabled(e)?Fn(e,n).toService(t.generalToken):Un(e,n).toService(t.generalToken)}))))}},{key:"resolveMono",value:function(e){var t=this;if("useValue"in this.option)return Un(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var n=this.option.useDynamic[this.option.useDynamic.length-1];return jn(Un(this.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),this.option)}if(this.option.useFactory.length>0){var i=this.option.useFactory[this.option.useFactory.length-1];return Un(this.generalToken,e).toFactory((function(){return i({container:t.context})}))}if(this.option.useClass.length>0){var o=this.option.useClass[this.option.useClass.length-1];return jn(Un(this.generalToken,e).to(o),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,n=this.option.useClass.map((function(n){return jn(Fn(t.generalToken,e).to(n),t.option)})),i=this.option.useDynamic.map((function(n){return jn(Fn(t.generalToken,e).toDynamicValue((function(){return n({container:t.context})})),t.option)})),o=this.option.useFactory.map((function(n){return Fn(t.generalToken,e).toFactory((function(){return n({container:t.context})}))})),r="useValue"in this.option?Fn(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(e){return t.named&&Gn(e,t.named)})),i.forEach((function(e){return t.named&&Gn(e,t.named)})),o.forEach((function(e){return t.named&&Gn(e,t.named)})),r&&Gn(r,this.named))}}],[{key:"resolveTarget",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var o=Reflect.getMetadata(Wn,n);o&&e.resolveOption(t,o)}catch(e){}if(An.isClass(n))if(i.useClass){var r=An.maybeArrayToArray(i.useClass);r.unshift(n),i.useClass=r}else i.useClass=[n];var s;try{s=Reflect.getMetadata(xn.ClassOptionSymbol,n)}catch(e){}if((s=Sn(Sn({},s||{}),i)).token){var a=An.maybeArrayToArray(s.token);a.unshift(n),s.token=a}else s.token=[n];e.resolveOption(t,s)}catch(e){}}},{key:"resolveOption",value:function(t,n){var i=function(e){var t=An.maybeArrayToArray(e.token),n=An.maybeArrayToArray(e.useClass),i=An.maybeArrayToArray(e.useDynamic),o=An.maybeArrayToArray(e.useFactory),r=An.maybeArrayToArray(e.contrib),s=e.lifecycle||xn.Lifecycle.transient,a={token:t,useClass:n,lifecycle:r.length>0?xn.Lifecycle.singleton:s,contrib:r,useDynamic:i,useFactory:o};return"useValue"in e&&(a.useValue=e.useValue),a}(Sn(Sn({},e.globalConfig),n));(0!==i.useClass.length||0!==i.useDynamic.length||0!==i.useFactory.length||"useValue"in i)&&i.token.forEach((function(n){new e(t,n,Sn({},i)).resolve()}))}}]),e}();Yn.globalConfig=xn.DefaultOption;var qn=function(){function e(t){Pn(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new f.Container}return kn(e,[{key:"load",value:function(e,t){!t&&this.loadedModules.includes(e.id)||(e.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(e.id))}},{key:"remove",value:function(e){return this.container.unbind(Bn(e))}},{key:"get",value:function(e){return this.container.get(Bn(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(Bn(e),Ln(t))}},{key:"getAll",value:function(e){return this.container.getAll(Bn(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(Bn(e),Ln(t))}},{key:"isBound",value:function(e){return this.container.isBound(Bn(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(Bn(e),Ln(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};An.isInjectOption(e)?Yn.resolveOption(this,e):Yn.resolveTarget(this,e,t)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(e){Yn.globalConfig=e}}]),e}(),$n=new qn(Hn),Jn=$n.register.bind($n),Zn=xn.defineToken("ContributionProvider"),Qn=function(){function e(t,n,i){Pn(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=n,this.serviceIdentifier=t,i&&(this.option=Sn(Sn({},this.option),i))}return kn(e,[{key:"setServices",value:function(e){for(var t=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var i=n.getAll(this.serviceIdentifier);t.push.apply(t,Dn(i))}n=e?n.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Sn(Sn({},this.option),e),n=t.cache,i=t.recursive;return n&&void 0!==this.services||(this.services=this.setServices(!!i)),this.services}}]),e}();function ei(e,t){return{token:{token:Zn,named:e},useDynamic:function(n){return new Qn(e,n.container,t)},lifecycle:xn.Lifecycle.singleton}}function ti(e,t,n){e({token:{token:Zn,named:t},useDynamic:function(e){return new Qn(t,e.container,n)},lifecycle:xn.Lifecycle.singleton})}var ni=function(){function e(t){Pn(this,e),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,e.moduleId+=1,this.id=e.moduleId,this.baseRegistry=t}return kn(e,[{key:"registry",get:function(){var e=this;return function(t,n){e.baseRegistry&&e.baseRegistry(t,n),e.optionCollection&&e.optionCollection.forEach((function(e){return t(e)}))}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){return e.options.push(t)})),this}},{key:"contribution",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.forEach((function(t){return e.options.push(ei(t))})),this}}]),e}();function ii(e){return new ni(e)}ni.moduleId=0;var oi,ri=function(e){return function(t,n,i){Kn(e)(t,n,i),zn(Zn)(t,n,i)}};!function(e){e.Provider=Zn,e.register=ti}(oi||(oi={}));var si,ai,ci,ui=Object.freeze({__proto__:null,Container:qn,get Contribution(){return oi},DefaultContributionProvider:Qn,GlobalContainer:$n,Module:ii,OptionSymbol:Wn,Provider:Zn,get Syringe(){return xn},SyringeModule:ni,get Utils(){return An},contrib:ri,inject:zn,injectable:Vn,named:Kn,register:Jn,registerSideOption:function(e,t){Reflect.defineMetadata(Wn,e,t)},singleton:Xn,transient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vn(Sn(Sn({},e),{},{lifecycle:xn.Lifecycle.transient}))},decorate:f.decorate,optional:f.optional,postConstruct:f.postConstruct,unmanaged:f.unmanaged});e.NsGraph=void 0,si=e.NsGraph||(e.NsGraph={}),(ai=si.AnchorGroup||(si.AnchorGroup={})).TOP="top",ai.BOTTOM="bottom",ai.RIGHT="right",ai.LEFT="left",(ci=si.AnchorType||(si.AnchorType={})).INPUT="input",ci.OUTPUT="output";
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */
var di=function(e,t){return di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},di(e,t)};function li(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}di(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function hi(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function fi(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function pi(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}var gi={exports:{}};
/*!
	  Copyright (c) 2018 Jed Watson.
	  Licensed under the MIT License (MIT), see
	  http://jedwatson.github.io/classnames
	*/!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var r=typeof o;if("string"===r||"number"===r)e.push(o);else if(Array.isArray(o)){if(o.length){var s=n.apply(null,o);s&&e.push(s)}}else if("object"===r)if(o.toString===Object.prototype.toString)for(var a in o)t.call(o,a)&&o[a]&&e.push(a);else e.push(o.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(gi);var vi,yi,mi,bi=gi.exports;
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function _i(e){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(e)}function Ei(e,t,n,i,o,r,s){try{var a=e[r](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,o)}function Ci(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oi(e,t,n){return t&&wi(e.prototype,t),n&&wi(e,n),e}function xi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ai(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}!function(e){!function(t){var n="object"==typeof h?h:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!r&&!s,c={create:r?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(d||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,i){if(R(n)){if(!X(e))throw new TypeError;if(!K(t))throw new TypeError;return O(e,t)}if(!X(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(i)&&!R(i)&&!j(i))throw new TypeError;return j(i)&&(i=void 0),x(e,t,n=V(n),i)}function g(e,t){function n(n,i){if(!F(n))throw new TypeError;if(!R(i)&&!W(i))throw new TypeError;I(e,t,n,i)}return n}function v(e,t,n,i){if(!F(n))throw new TypeError;return R(i)||(i=V(i)),I(e,t,n,i)}function y(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),T(e,t,n)}function m(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),S(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),N(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return R(n)||(n=V(n)),P(e,t,n)}function E(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),k(e,t)}function C(e,t){if(!F(e))throw new TypeError;return R(t)||(t=V(t)),M(e,t)}function w(e,t,n){if(!F(t))throw new TypeError;R(n)||(n=V(n));var i=A(t,n,!1);if(R(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var o=f.get(t);return o.delete(n),o.size>0||f.delete(t),!0}function O(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!R(i)&&!j(i)){if(!K(i))throw new TypeError;t=i}}return t}function x(e,t,n,i){for(var o=e.length-1;o>=0;--o){var r=(0,e[o])(t,n,i);if(!R(r)&&!j(r)){if(!F(r))throw new TypeError;i=r}}return i}function A(e,t,n){var i=f.get(e);if(R(i)){if(!n)return;i=new l,f.set(e,i)}var o=i.get(t);if(R(o)){if(!n)return;o=new l,i.set(t,o)}return o}function T(e,t,n){if(S(e,t,n))return!0;var i=Q(t);return!j(i)&&T(e,i,n)}function S(e,t,n){var i=A(t,n,!1);return!R(i)&&B(i.has(e))}function N(e,t,n){if(S(e,t,n))return P(e,t,n);var i=Q(t);return j(i)?void 0:N(e,i,n)}function P(e,t,n){var i=A(t,n,!1);if(!R(i))return i.get(e)}function I(e,t,n,i){A(n,i,!0).set(e,t)}function k(e,t){var n=M(e,t),i=Q(e);if(null===i)return n;var o=k(i,t);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new h,s=[],a=0,c=n;a<c.length;a++){var u=c[a];r.has(u)||(r.add(u),s.push(u))}for(var d=0,l=o;d<l.length;d++){u=l[d];r.has(u)||(r.add(u),s.push(u))}return s}function M(e,t){var n=[],i=A(e,t,!1);if(R(i))return n;for(var o=q(i.keys()),r=0;;){var s=J(o);if(!s)return n.length=r,n;var a=$(s);try{n[r]=a}catch(e){try{Z(o)}finally{throw e}}r++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function R(e){return void 0===e}function j(e){return null===e}function G(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function U(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",o=Y(e,i);if(void 0!==o){var r=o.call(e,n);if(F(r))throw new TypeError;return r}return L(e,"default"===n?"number":n)}function L(e,t){if("string"===t){var n=e.toString;if(z(n))if(!F(o=n.call(e)))return o;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o}else{var i;if(z(i=e.valueOf))if(!F(o=i.call(e)))return o;var o,r=e.toString;if(z(r))if(!F(o=r.call(e)))return o}throw new TypeError}function B(e){return!!e}function H(e){return""+e}function V(e){var t=U(e,3);return G(t)?t:H(t)}function X(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function K(e){return"function"==typeof e}function W(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function q(e){var t=Y(e,o);if(!z(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function $(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var o=i.constructor;return"function"!=typeof o||o===e?t:o}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,o=n+1;o<i;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,r)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function r(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=o();return function(){function e(){this._key=o()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=o()},e}();function o(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function r(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var o=t[i];4!==i&&6!==i&&8!==i||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",g),e("defineMetadata",v),e("hasMetadata",y),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",_),e("getMetadataKeys",E),e("getOwnMetadataKeys",C),e("deleteMetadata",w)}(i)}()}(vi||(vi={})),function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"===_i(e)&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NONE=t((function(){}))}(yi||(yi={})),function(e){e.None=function(){return yi.NONE},e.map=function(e,t){return function(n,i){return e((function(e){return n.call(i,t(e))}),void 0)}}}(mi||(mi={}));var Ti=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ci(this,t),this.mono=void 0,this._callbacks=void 0,this.mono=e}return Oi(t,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=[]),this._callbacks}},{key:"length",get:function(){return this.callbacks.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.callbacks.push([e,t])}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!this.isEmpty()){for(var n=!1,i=0;i<this.length;i+=1)if(this.callbacks[i][0]===e){if(this.callbacks[i][1]===t)return void this.callbacks.splice(i,1);n=!0}if(n)throw new Error("You should remove it with the same context you add it")}}},{key:e,value:function(){return this.isEmpty()?[][Symbol.iterator]():this.callbacks.slice(0).map((function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e[0].apply(e[1],n)}}))[Symbol.iterator]()}},{key:"invoke",value:function(){var e,t=[],n=Ai(this);try{for(n.s();!(e=n.n()).done;){var i=e.value;try{t.push(i.apply(void 0,arguments))}catch(e){console.error(e)}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"isEmpty",value:function(){return 0===this.callbacks.length}},{key:"dispose",value:function(){this._callbacks=void 0}}]),t}(Symbol.iterator),Si=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ci(this,e),this.options=void 0,this._event=void 0,this._callbacks=void 0,this.disposed=!1,this.options=t}var t;return Oi(e,[{key:"callbacks",get:function(){return this._callbacks||(this._callbacks=new Ti),this._callbacks}},{key:"event",get:function(){var t=this;return this._event||(this._event=function(n,i){t.options.onFirstListenerAdd&&t.callbacks.isEmpty()&&t.options.onFirstListenerAdd(t),t.callbacks.add(n,i);var o={dispose:function(){o.dispose=e.noop,t.disposed||(t.callbacks.remove(n,i),o.dispose=e.noop,t.options.onLastListenerRemove&&t.callbacks.isEmpty()&&t.options.onLastListenerRemove(t))}};return o}),this._event}},{key:"fire",value:function(e){this._callbacks&&this.callbacks.invoke(e)}},{key:"sequence",value:(t=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function s(e){Ei(r,i,o,s,a,"next",e)}function a(e){Ei(r,i,o,s,a,"throw",e)}s(void 0)}))}}(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Ai(this.callbacks),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=12;break}return o=i.value,e.next=7,t(o);case 7:if(e.sent){e.next=10;break}return e.abrupt("break",12);case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[1,14,17,20]])}))),function(e){return t.apply(this,arguments)})},{key:"dispose",value:function(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0),this.disposed=!0}}]),e}();Si.noop=function(){};var Ni,Pi=Object.freeze(Object.assign((function(e,t){var n=setTimeout(e.bind(t),0);return{dispose:function(){clearTimeout(n)}}}),{maxListeners:0}));!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:mi.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Pi})}(Ni||(Ni={})),e.Disposable=void 0,function(e){function t(e){return{dispose:e}}e.is=function(e){return!!e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose},e.create=t,e.NULL=t((()=>{}))}(e.Disposable||(e.Disposable={}));class Ii{constructor(...e){this.disposables=[],this.onDisposeEmitter=new Si,this.disposingElements=!1,e.forEach((e=>this.push(e)))}get onDispose(){return this.onDisposeEmitter.event}checkDisposed(){this.disposed&&!this.disposingElements&&(this.onDisposeEmitter.fire(void 0),this.onDisposeEmitter.dispose())}get disposed(){return 0===this.disposables.length}dispose(){return pi(this,void 0,void 0,(function*(){if(!this.disposed&&!this.disposingElements){for(this.disposingElements=!0;!this.disposed;)try{const e=this.disposables.pop();yield e.dispose()}catch(e){console.error(e)}this.disposingElements=!1,this.checkDisposed()}}))}push(t){const{disposables:n}=this;n.push(t);const i=t.dispose.bind(t),o=e.Disposable.create((()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1),this.checkDisposed()}));return t.dispose=()=>{o.dispose(),i()},o}pushAll(e){return e.map((e=>this.push(e)))}}class ki{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=(...t)=>{this.isResolved=!0,e(...t)},this.reject=(...e)=>{this.isRejected=!0,t(...e)}}))}}const Mi="xflow",Di=.01,Ri="XFLOW_DEFAULT_NODE",ji="XFLOW_DEFAULT_GROUP_NODE",Gi="XFLOW_DEFAULT_EDGE",Fi="XFLOW_COPY_ITEMS",Ui={width:180,height:36};var Li=Object.freeze({__proto__:null,X6_NODE_PORTAL_NODE_VIEW:"X6_NODE_PORTAL_NODE_VIEW",XFLOW_PREFIX_CLS:Mi,MIN_ZOOM:Di,MAX_ZOOM:1.5,XFLOW_DEFAULT_NODE:Ri,XFLOW_DEFAULT_GROUP_NODE:ji,XFLOW_DEFAULT_EDGE:Gi,LOCAL_STORAGE_KEY:Fi,DEFAULT_NODE_HEIGHT:36,DEFAULT_NODE_WIDTH:180,XFLOW_GROUP_DEFAULT_COLLAPSED_SIZE:Ui});function Bi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}var Hi=t.createContext({});function Vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xi(Object(n),!0).forEach((function(t){Vi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Wi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ki(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ki(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yi(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function qi(e){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qi(e)}function $i(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function Ji(e){return e<=1?100*Number(e)+"%":e}function Zi(e){return 1===e.length?"0"+e:String(e)}function Qi(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function eo(e){return to(e)/255}function to(e){return parseInt(e,16)}var no={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function io(e){var t={r:0,g:0,b:0},n=1,i=null,o=null,r=null,s=!1,a=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(no[e])e=no[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=ao.rgb.exec(e);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=ao.rgba.exec(e))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=ao.hsl.exec(e))return{h:n[1],s:n[2],l:n[3]};if(n=ao.hsla.exec(e))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=ao.hsv.exec(e))return{h:n[1],s:n[2],v:n[3]};if(n=ao.hsva.exec(e))return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=ao.hex8.exec(e))return{r:to(n[1]),g:to(n[2]),b:to(n[3]),a:eo(n[4]),format:t?"name":"hex8"};if(n=ao.hex6.exec(e))return{r:to(n[1]),g:to(n[2]),b:to(n[3]),format:t?"name":"hex"};if(n=ao.hex4.exec(e))return{r:to(n[1]+n[1]),g:to(n[2]+n[2]),b:to(n[3]+n[3]),a:eo(n[4]+n[4]),format:t?"name":"hex8"};if(n=ao.hex3.exec(e))return{r:to(n[1]+n[1]),g:to(n[2]+n[2]),b:to(n[3]+n[3]),format:t?"name":"hex"};return!1}(e)),"object"==typeof e&&(co(e.r)&&co(e.g)&&co(e.b)?(t=function(e,t,n){return{r:255*$i(e,255),g:255*$i(t,255),b:255*$i(n,255)}}(e.r,e.g,e.b),s=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):co(e.h)&&co(e.s)&&co(e.v)?(i=Ji(e.s),o=Ji(e.v),t=function(e,t,n){e=6*$i(e,360),t=$i(t,100),n=$i(n,100);var i=Math.floor(e),o=e-i,r=n*(1-t),s=n*(1-o*t),a=n*(1-(1-o)*t),c=i%6;return{r:255*[n,s,r,r,a,n][c],g:255*[a,n,n,s,r,r][c],b:255*[r,r,a,n,n,s][c]}}(e.h,i,o),s=!0,a="hsv"):co(e.h)&&co(e.s)&&co(e.l)&&(i=Ji(e.s),r=Ji(e.l),t=function(e,t,n){var i,o,r;if(e=$i(e,360),t=$i(t,100),n=$i(n,100),0===t)o=n,r=n,i=n;else{var s=n<.5?n*(1+t):n+t-n*t,a=2*n-s;i=Qi(a,s,e+1/3),o=Qi(a,s,e),r=Qi(a,s,e-1/3)}return{r:255*i,g:255*o,b:255*r}}(e.h,i,r),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(n),{ok:s,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var oo="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",ro="[\\s|\\(]+("+oo+")[,|\\s]+("+oo+")[,|\\s]+("+oo+")\\s*\\)?",so="[\\s|\\(]+("+oo+")[,|\\s]+("+oo+")[,|\\s]+("+oo+")[,|\\s]+("+oo+")\\s*\\)?",ao={CSS_UNIT:new RegExp(oo),rgb:new RegExp("rgb"+ro),rgba:new RegExp("rgba"+so),hsl:new RegExp("hsl"+ro),hsla:new RegExp("hsla"+so),hsv:new RegExp("hsv"+ro),hsva:new RegExp("hsva"+so),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function co(e){return Boolean(ao.CSS_UNIT.exec(String(e)))}var uo=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function lo(e){var t=function(e,t,n){e=$i(e,255),t=$i(t,255),n=$i(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),r=0,s=i,a=i-o,c=0===i?0:a/i;if(i===o)r=0;else{switch(i){case e:r=(t-n)/a+(t<n?6:0);break;case t:r=(n-e)/a+2;break;case n:r=(e-t)/a+4}r/=6}return{h:r,s:c,v:s}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function ho(e){var t=e.r,n=e.g,i=e.b;return"#".concat(function(e,t,n,i){var o=[Zi(Math.round(e).toString(16)),Zi(Math.round(t).toString(16)),Zi(Math.round(n).toString(16))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}(t,n,i,!1))}function fo(e,t,n){var i=n/100;return{r:(t.r-e.r)*i+e.r,g:(t.g-e.g)*i+e.g,b:(t.b-e.b)*i+e.b}}function po(e,t,n){var i;return(i=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?i+=360:i>=360&&(i-=360),i}function go(e,t,n){return 0===e.h&&0===e.s?e.s:((i=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(i=1),n&&5===t&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2)));var i}function vo(e,t,n){var i;return(i=n?e.v+.05*t:e.v-.15*t)>1&&(i=1),Number(i.toFixed(2))}function yo(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],i=io(e),o=5;o>0;o-=1){var r=lo(i),s=ho(io({h:po(r,o,!0),s:go(r,o,!0),v:vo(r,o,!0)}));n.push(s)}n.push(ho(i));for(var a=1;a<=4;a+=1){var c=lo(i),u=ho(io({h:po(c,a),s:go(c,a),v:vo(c,a)}));n.push(u)}return"dark"===t.theme?uo.map((function(e){var i=e.index,o=e.opacity;return ho(fo(io(t.backgroundColor||"#141414"),io(n[i]),100*o))})):n}var mo={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},bo={},_o={};Object.keys(mo).forEach((function(e){bo[e]=yo(mo[e]),bo[e].primary=bo[e][5],_o[e]=yo(mo[e],{theme:"dark",backgroundColor:"#141414"}),_o[e].primary=_o[e][5]})),bo.red,bo.volcano,bo.gold,bo.orange,bo.yellow,bo.lime,bo.green,bo.cyan,bo.blue,bo.geekblue,bo.purple,bo.magenta,bo.grey;var Eo={};function Co(e,t){}function wo(e,t){!function(e,t,n){t||Eo[n]||(e(!1,n),Eo[n]=!0)}(Co,e,t)}function Oo(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}var xo="rc-util-key";function Ao(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function To(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Oo())return null;var i,o=document.createElement("style");(null===(t=n.csp)||void 0===t?void 0:t.nonce)&&(o.nonce=null===(i=n.csp)||void 0===i?void 0:i.nonce);o.innerHTML=e;var r=Ao(n),s=r.firstChild;return n.prepend&&r.prepend?r.prepend(o):n.prepend&&s?r.insertBefore(o,s):r.appendChild(o),o}var So=new Map;function No(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Ao(n);if(!So.has(i)){var o=To("",n),r=o.parentNode;So.set(i,r),r.removeChild(o)}var s=Array.from(So.get(i).children).find((function(e){return"STYLE"===e.tagName&&e[xo]===t}));if(s){var a,c,u;if((null===(a=n.csp)||void 0===a?void 0:a.nonce)&&s.nonce!==(null===(c=n.csp)||void 0===c?void 0:c.nonce))s.nonce=null===(u=n.csp)||void 0===u?void 0:u.nonce;return s.innerHTML!==e&&(s.innerHTML=e),s}var d=To(e,n);return d[xo]=t,d}function Po(e){return"object"===qi(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===qi(e.icon)||"function"==typeof e.icon)}function Io(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){var i=e[n];if("class"===n)t.className=i,delete t.class;else t[n]=i;return t}),{})}function ko(e,t,n){return n?u.default.createElement(e.tag,zi(zi({key:t},Io(e.attrs)),n),(e.children||[]).map((function(n,i){return ko(n,"".concat(t,"-").concat(e.tag,"-").concat(i))}))):u.default.createElement(e.tag,zi({key:t},Io(e.attrs)),(e.children||[]).map((function(n,i){return ko(n,"".concat(t,"-").concat(e.tag,"-").concat(i))})))}function Mo(e){return yo(e)[0]}function Do(e){return e?Array.isArray(e)?e:[e]:[]}var Ro="\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",jo=["icon","className","onClick","style","primaryColor","secondaryColor"],Go={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var Fo=function(e){var n,i,o=e.icon,r=e.className,s=e.onClick,a=e.style,c=e.primaryColor,u=e.secondaryColor,d=Yi(e,jo),l=Go;if(c&&(l={primaryColor:c,secondaryColor:u||Mo(c)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ro,n=t.useContext(Hi).csp;t.useEffect((function(){No(e,"@ant-design-icons",{prepend:!0,csp:n})}),[])}(),n=Po(o),i="icon should be icon definiton, but got ".concat(o),wo(n,"[@ant-design/icons] ".concat(i)),!Po(o))return null;var h=o;return h&&"function"==typeof h.icon&&(h=zi(zi({},h),{},{icon:h.icon(l.primaryColor,l.secondaryColor)})),ko(h.icon,"svg-".concat(h.name),zi({className:r,onClick:s,style:a,"data-icon":h.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},d))};Fo.displayName="IconReact",Fo.getTwoToneColors=function(){return zi({},Go)},Fo.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;Go.primaryColor=t,Go.secondaryColor=n||Mo(t),Go.calculated=!!n};var Uo=Fo;function Lo(e){var t=Wi(Do(e),2),n=t[0],i=t[1];return Uo.setTwoToneColors({primaryColor:n,secondaryColor:i})}var Bo=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Lo("#1890ff");var Ho=d.forwardRef((function(e,t){var n,i=e.className,o=e.icon,r=e.spin,s=e.rotate,a=e.tabIndex,c=e.onClick,u=e.twoToneColor,l=Yi(e,Bo),h=d.useContext(Hi).prefixCls,f=void 0===h?"anticon":h,p=bi(f,(Vi(n={},"".concat(f,"-").concat(o.name),!!o.name),Vi(n,"".concat(f,"-spin"),!!r||"loading"===o.name),n),i),g=a;void 0===g&&c&&(g=-1);var v=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,y=Wi(Do(u),2),m=y[0],b=y[1];return d.createElement("span",zi(zi({role:"img","aria-label":o.name},l),{},{ref:t,tabIndex:g,onClick:c,className:p}),d.createElement(Uo,{icon:o,primaryColor:m,secondaryColor:b,style:v}))}));Ho.displayName="AntdIcon",Ho.getTwoToneColor=function(){var e=Uo.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},Ho.setTwoToneColor=Lo;var Vo=Ho,Xo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},zo=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:Xo}))};zo.displayName="CheckCircleOutlined";var Ko=d.forwardRef(zo),Wo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}},{tag:"path",attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"close-circle",theme:"outlined"},Yo=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:Wo}))};Yo.displayName="CloseCircleOutlined";var qo=d.forwardRef(Yo),$o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"},Jo=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:$o}))};Jo.displayName="DatabaseOutlined";var Zo=d.forwardRef(Jo),Qo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},er=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:Qo}))};er.displayName="ExclamationCircleOutlined";var tr=d.forwardRef(er),nr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},ir=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:nr}))};ir.displayName="InfoCircleOutlined";var or=d.forwardRef(ir),rr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"},sr=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:rr}))};sr.displayName="MinusSquareOutlined";var ar=d.forwardRef(sr),cr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"},ur=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:cr}))};ur.displayName="PlusSquareOutlined";var dr=d.forwardRef(ur),lr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},hr=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:lr}))};hr.displayName="QuestionCircleOutlined";var fr=d.forwardRef(hr),pr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},gr=function(e,t){return d.createElement(Vo,zi(zi({},e),{},{ref:t,icon:pr}))};gr.displayName="RedoOutlined";var vr=d.forwardRef(gr);const yr=u.default.createContext(null);yr.displayName="XFlowAppContext";const mr=()=>{const e=u.default.useContext(yr);return e&&e.getApp?e.getApp():null};class br{constructor(e=!1){this.cache=null,this.setApp=e=>{this.cache=e,this.onAppChangeCallback&&this.onAppChangeCallback(e)},this.isUserDefined=()=>this.isUserDefinedFlag,this.getApp=()=>this.cache,this.onAppChange=e=>{this.onAppChangeCallback=e},this.dispose=()=>{this.cache=null},this.isUserDefinedFlag=e}}const _r=e=>{const t=u.default.useContext(yr),[,n]=u.default.useState(null),i=u.default.useMemo((()=>t&&t.isUserDefined()?t:new br(!1)),[]);return i.isUserDefined()||i.onAppChange((()=>n(0))),u.default.useEffect((()=>{e.app&&i.setApp(e.app)}),[e.app]),i.isUserDefined()?u.default.createElement(u.default.Fragment,null,e.children):u.default.createElement(yr.Provider,{value:Object.assign({},i)},e.children)};_r.displayName="XFlowAppInternalProvider";const Er=({children:e})=>{const[,t]=u.default.useState(null),n=u.default.useMemo((()=>new br(!0)),[]);return n.onAppChange((()=>t(0))),u.default.createElement(yr.Provider,{value:Object.assign({},n)},e)};Er.displayName="XFlowAppProvider",e.XFlowNodeCommands=void 0,function(e){const t="节点操作";e.ADD_NODE={id:"xflow:add-node",label:"添加节点",category:t},e.MOVE_NODE={id:"xflow:move-node",label:"Move Node",category:t},e.DEL_NODE={id:"xflow:del-node",label:"删除节点",category:t},e.UPDATE_NODE={id:"xflow:update-node",label:"更新节点",category:t},e.HIGHLIGHT_NODE={id:"xflow:highlight-node",label:"高亮节点",category:t},e.SELECT_NODE={id:"xflow:select-node",label:"选中节点",category:t},e.CENTER_NODE={id:"xflow:center-node",label:"居中节点",category:t},e.FRONT_NODE={id:"xflow:front-node",label:"前置节点",category:t},e.BACK_NODE={id:"xflow:back-node",label:"后置节点",category:t}}(e.XFlowNodeCommands||(e.XFlowNodeCommands={})),e.XFlowEdgeCommands=void 0,function(e){const t="边操作";e.ADD_EDGE={id:"xflow:add-edge",label:"添加边",category:t},e.DEL_EDGE={id:"xflow:del-edge",label:"删除边",category:t},e.UPDATE_EDGE={id:"xflow:update-edge",label:"更新边",category:t},e.HIGHLIGHT_EDGE={id:"xflow:highlight-edge",label:"高亮边",category:t},e.FRONT_EDGE={id:"xflow:front-edge",label:"前置变",category:t},e.BACK_EDGE={id:"xflow:back-edge",label:"后置边",category:t}}(e.XFlowEdgeCommands||(e.XFlowEdgeCommands={})),e.XFlowGraphCommands=void 0,function(e){const t="画布操作";e.LOAD_META={id:"xflow:load-meta",label:"获取元数据",category:t},e.LOAD_DATA={id:"xflow:load-data",label:"获取图数据",category:t},e.SAVE_GRAPH_DATA={id:"xflow:save-graph-data",label:"保存",category:t},e.GRAPH_LAYOUT={id:"xflow:layout",label:"计算布局",category:t},e.GRAPH_RENDER={id:"xflow:graph-render",label:"渲染画布",category:t},e.UNDO_CMD={id:"xflow:undo-cmd",label:"撤销",category:t},e.REDO_CMD={id:"xflow:redo-cmd",label:"重做",category:t},e.GRAPH_INSTANCE_COMMAND={id:"xflow:graph-instacne-cmd",label:"Graph通用Command",category:t},e.GRAPH_ZOOM={id:"xflow:graph-zoom",label:"缩放画布",category:t},e.GRAPH_RESIZE={id:"xflow:graph-resize",label:"调整窗口大小",category:t},e.GRAPH_COPY={id:"xflow:graph-copy-selection",label:"复制",category:t},e.GRAPH_PASTE={id:"xflow:graph-paste-selection",label:"粘贴",category:t},e.GRAPH_TOGGLE_MULTI_SELECT={id:"xflow:graph-toggle-multi-select",label:"启用框选",category:t},e.GRAPH_ADD_TOOL={id:"xflow:add-tool",label:"添加工具",category:t},e.GRAPH_DEL_TOOL={id:"xflow:del-tool",label:"删除工具",category:t},e.GRAPH_HISTORY_UNDO={id:"xflow:history-undo",label:"history undo",category:t},e.GRAPH_HISTORY_REDO={id:"xflow:history-redo",label:"history redo",category:t},e.GRAPH_HISTORY_RESET={id:"xflow:history-reset",label:"history reset",category:t},e.GRAPH_HISTORY_TOGGLE={id:"xflow:history-toggle",label:"history toggle",category:t}}(e.XFlowGraphCommands||(e.XFlowGraphCommands={})),e.XFlowModelCommands=void 0,(e.XFlowModelCommands||(e.XFlowModelCommands={})).UPDATE_MODEL={id:"xflow:update-model",label:"设置状态值",category:"状态操作"},e.XFlowGroupCommands=void 0,function(e){const t="群组操作";e.INIT_GROUP={id:"xflow:init-group",label:"初始化群组",category:t},e.ADD_GROUP={id:"xflow:add-group",label:"新建群组",category:t},e.DEL_GROUP={id:"xflow:del-group",label:"解散群组",category:t},e.COLLAPSE_GROUP={id:"xflow:collapse-group",label:"折叠群组",category:t}}(e.XFlowGroupCommands||(e.XFlowGroupCommands={}));const Cr=t=>{const{cell:n}=t,i=mr(),o=t.data.isCollapsed||!1;return u.default.createElement("div",{className:"xflow-default-group-node"},u.default.createElement("div",{className:"xflow-group-header"},u.default.createElement("div",{className:"header-left"},t.data.label),u.default.createElement("div",{className:"header-right"},o&&u.default.createElement(dr,{onClick:t=>{t.preventDefault(),i.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!1})}}),!o&&u.default.createElement(ar,{onClick:t=>{t.preventDefault(),i.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:n.id,isCollapsed:!0,gap:3})}}))))};Cr.displayName="XFlowDefaultGroupNode";const wr={fontSize:"16px",color:"#3057e3"};var Or;!function(e){e.SUCCESS="success",e.PROCESSING="processing",e.ERROR="error",e.DEFAULT="default",e.WARNING="warning"}(Or||(Or={}));const xr=e=>{if(e.hide)return null;switch(e.status){case Or.PROCESSING:return u.default.createElement(vr,{spin:!0,style:{color:"#c1cdf7",fontSize:"16px"}});case Or.ERROR:return u.default.createElement(qo,{style:{color:"#ff4d4f",fontSize:"16px"}});case Or.SUCCESS:return u.default.createElement(Ko,{style:{color:"#39ca74cc",fontSize:"16px"}});case Or.WARNING:return u.default.createElement(tr,{style:{color:"#faad14",fontSize:"16px"}});case Or.DEFAULT:return u.default.createElement(or,{style:{color:"#d9d9d9",fontSize:"16px"}});default:return null}},Ar=e=>{const t=u.default.isValidElement(e.data.icon)?e.data.icon:u.default.createElement(Zo,{style:wr});return u.default.createElement("div",{className:"xflow-default-node "+(e.isNodeTreePanel?"panel-node":"")},u.default.createElement("span",{className:"icon"},t),u.default.createElement("span",{className:"label"},e.data.label),u.default.createElement("span",{className:"status"},u.default.createElement(xr,{status:e.data&&e.data.status,hide:e.isNodeTreePanel})))};var Tr;Ar.displayName="XFlowDefaultNode",function(e){e.CONFIG_TYPE="GraphConfig",e.defaultNodeTypeParser=e=>e.renderKey,e.defaultEdgeTypeParser=e=>e.renderKey,e.defaultNodeMapValue=[[Ri,Ar],[ji,Cr]]}(Tr||(Tr={}));class Sr{constructor(){this.CONFIG_TYPE=Tr.CONFIG_TYPE,this.x6Options=new ki,this.rootContainer=new ki,this.graphContainer=new ki,this.nodeRender=new Map(Tr.defaultNodeMapValue),this.edgeRender=new Map,this.nodeTypeParser=Tr.defaultNodeTypeParser,this.edgeTypeParser=Tr.defaultEdgeTypeParser,this.events=[],this.mergeX6Config=e=>pi(this,void 0,void 0,(function*(){const t=yield this.getX6Config();return Object.assign(t,e)})),this.getX6Config=()=>pi(this,void 0,void 0,(function*(){return yield this.x6Options.promise})),this.setX6Config=e=>{var t;const n=this.getDefaultGraphOptions();null===(t=this.x6Options)||void 0===t||t.resolve(Object.assign(Object.assign({},n),e))},this.setRootContainer=e=>{e&&(null==this||this.rootContainer.resolve(e))},this.setGraphContainer=e=>{var t;e&&(null===(t=this.graphContainer)||void 0===t||t.resolve(e))},this.setEvents=e=>{this.events=e},this.setDefaultNodeRender=e=>{this.nodeRender.set(Ri,e)},this.setDefaultEdgeRender=e=>{this.edgeRender.set(Gi,e)},this.setNodeRender=(e,t)=>{this.nodeRender.set(e,t)},this.setEdgeRender=(e,t)=>{this.edgeRender.set(e,t)},this.setNodeTypeParser=e=>{this.nodeTypeParser=e},this.setEdgeTypeParser=e=>{this.edgeTypeParser=e},this.getConfig=()=>pi(this,void 0,void 0,(function*(){const[e,t,n]=yield Promise.all([this.rootContainer.promise,this.graphContainer.promise,this.x6Options.promise]);return{xflowInstanceId:this.xflowInstanceId,graphId:this.graphId,nodeViewId:this.graphId,rootContainer:e,graphContainer:t,x6Options:n,events:this.events,nodeRender:this.nodeRender,edgeRender:this.edgeRender,nodeTypeParser:this.nodeTypeParser,edgeTypeParser:this.edgeTypeParser}})),this.getDefaultGraphOptions=()=>({rotating:!1,resizing:!1,connecting:{snap:!0,dangling:!1,highlight:!1,connectionPoint:"rect",router:{name:"er"},connector:{name:"rounded",args:{radius:15}}},background:{},grid:{visible:!0},selecting:{strict:!0,enabled:!0,multiple:!0,selectCellOnMoved:!0,showNodeSelectionBox:!1,rubberEdge:!0,rubberNode:!0,movable:!0},snapline:{enabled:!1},history:{enabled:!1},clipboard:{enabled:!0,useLocalStorage:!0},scroller:{enabled:!1},mousewheel:{enabled:!0,minScale:Di,maxScale:1.5,factor:1.1,modifiers:["ctrl","meta"]},panning:{enabled:!0},scaling:{min:Di,max:1.5},keyboard:{enabled:!0},interacting:{nodeMovable:!0,edgeLabelMovable:!1},async:!1}),this.dispose=()=>{this.rootContainer=new ki,this.graphContainer=new ki,this.x6Options=new ki},this.graphId=Bi()}}const Nr=Symbol("IGraphOptionProvider");function Pr(e){return"function"==typeof e}var Ir=!1,kr={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;Ir=e},get useDeprecatedSynchronousErrorHandling(){return Ir}};function Mr(e){setTimeout((function(){throw e}),0)}var Dr={closed:!0,next:function(e){},error:function(e){if(kr.useDeprecatedSynchronousErrorHandling)throw e;Mr(e)},complete:function(){}},Rr=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function jr(e){return null!==e&&"object"==typeof e}var Gr=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),Fr=Gr,Ur=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,i=n._parentOrParents,o=n._ctorUnsubscribe,r=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(var a=0;a<i.length;++a){i[a].remove(this)}if(Pr(r)){o&&(this._unsubscribe=void 0);try{r.call(this)}catch(e){t=e instanceof Fr?Lr(e.errors):[e]}}if(Rr(s)){a=-1;for(var c=s.length;++a<c;){var u=s[a];if(jr(u))try{u.unsubscribe()}catch(e){t=t||[],e instanceof Fr?t=t.concat(Lr(e.errors)):t.push(e)}}}if(t)throw new Fr(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function Lr(e){return e.reduce((function(e,t){return e.concat(t instanceof Fr?t.errors:t)}),[])}var Br=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Hr=function(e){function t(n,i,o){var r=e.call(this)||this;switch(r.syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,arguments.length){case 0:r.destination=Dr;break;case 1:if(!n){r.destination=Dr;break}if("object"==typeof n){n instanceof t?(r.syncErrorThrowable=n.syncErrorThrowable,r.destination=n,n.add(r)):(r.syncErrorThrowable=!0,r.destination=new Vr(r,n));break}default:r.syncErrorThrowable=!0,r.destination=new Vr(r,n,i,o)}return r}return li(t,e),t.prototype[Br]=function(){return this},t.create=function(e,n,i){var o=new t(e,n,i);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Ur),Vr=function(e){function t(t,n,i,o){var r,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return Pr(n)?r=n:n&&(r=n.next,i=n.error,o=n.complete,n!==Dr&&(Pr((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=r,s._error=i,s._complete=o,s}return li(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;kr.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=kr.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Mr(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Mr(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};kr.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),kr.useDeprecatedSynchronousErrorHandling)throw e;Mr(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!kr.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return kr.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(Mr(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Hr);var Xr=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function zr(e){return e}function Kr(e){return 0===e.length?zr:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Wr=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i=this.operator,o=function(e,t,n){if(e){if(e instanceof Hr)return e;if(e[Br])return e[Br]()}return e||t||n?new Hr(e,t,n):new Hr(Dr)}(e,t,n);if(i?o.add(i.call(o,this.source)):o.add(this.source||kr.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),kr.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){kr.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,i=t.destination,o=t.isStopped;if(n||o)return!1;e=i&&i instanceof Hr?i:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Yr(t))((function(t,i){var o;o=n.subscribe((function(t){try{e(t)}catch(e){i(e),o&&o.unsubscribe()}}),i,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[Xr]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:Kr(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Yr(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function Yr(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var qr=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),$r=function(e){function t(t,n){var i=e.call(this)||this;return i.subject=t,i.subscriber=n,i.closed=!1,i}return li(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(Ur),Jr=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return li(t,e),t}(Hr),Zr=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return li(t,e),t.prototype[Br]=function(){return new Jr(this)},t.prototype.lift=function(e){var t=new Qr(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new qr;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),o=0;o<n;o++)i[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new qr;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),o=0;o<n;o++)i[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new qr;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new qr;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new qr;return this.hasError?(e.error(this.thrownError),Ur.EMPTY):this.isStopped?(e.complete(),Ur.EMPTY):(this.observers.push(e),new $r(this,e))},t.prototype.asObservable=function(){var e=new Wr;return e.source=this,e},t.create=function(e,t){return new Qr(e,t)},t}(Wr),Qr=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return li(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Ur.EMPTY},t}(Zr),es=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return li(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new qr;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Zr),ts=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return li(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,i=void 0;try{this.work(e)}catch(e){n=!0,i=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),i},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return li(t,e),t.prototype.schedule=function(e,t){return this},t}(Ur)),ns=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),is=function(e){function t(n,i){void 0===i&&(i=ns.now);var o=e.call(this,n,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():i()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return li(t,e),t.prototype.schedule=function(n,i,o){return void 0===i&&(i=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,i,o):e.prototype.schedule.call(this,n,i,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(ns),os=new is(ts),rs=os;var ss=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new as(e,this.predicate,this.thisArg))},e}(),as=function(e){function t(t,n,i){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=i,o.count=0,o}return li(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Hr);var cs=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new us(e,this.compare,this.keySelector))},e}(),us=function(e){function t(t,n,i){var o=e.call(this,t)||this;return o.keySelector=i,o.hasKey=!1,"function"==typeof n&&(o.compare=n),o}return li(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var i=!1;if(this.hasKey)try{i=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))},t}(Hr),ds={leading:!0,trailing:!1};var ls=function(){function e(e,t,n,i){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=i}return e.prototype.call=function(e,t){return t.subscribe(new hs(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),hs=function(e){function t(t,n,i,o,r){var s=e.call(this,t)||this;return s.duration=n,s.scheduler=i,s.leading=o,s.trailing=r,s._hasTrailingValue=!1,s._trailingValue=null,s}return li(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(fs,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(Hr);function fs(e){e.subscriber.clearThrottle()}function ps(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function gs(e){return!!e&&!!e[ea]}function vs(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&Function.toString.call(n)===na}(e)||Array.isArray(e)||!!e[Qs]||!!e.constructor[Qs]||Es(e)||Cs(e))}function ys(e,t,n){void 0===n&&(n=!1),0===ms(e)?(n?Object.keys:ia)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function ms(e){var t=e[ea];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Es(e)?2:Cs(e)?3:0}function bs(e,t){return 2===ms(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _s(e,t,n){var i=ms(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function Es(e){return qs&&e instanceof Map}function Cs(e){return $s&&e instanceof Set}function ws(e){return e.o||e.t}function Os(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=oa(e);delete t[ea];for(var n=ia(t),i=0;i<n.length;i++){var o=n[i],r=t[o];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[o]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function xs(e,t){return void 0===t&&(t=!1),Ts(e)||gs(e)||!vs(e)||(ms(e)>1&&(e.set=e.add=e.clear=e.delete=As),Object.freeze(e),t&&ys(e,(function(e,t){return xs(t,!0)}),!0)),e}function As(){ps(2)}function Ts(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Ss(e){var t=ra[e];return t||ps(18,e),t}function Ns(){return Ws}function Ps(e,t){t&&(Ss("Patches"),e.u=[],e.s=[],e.v=t)}function Is(e){ks(e),e.p.forEach(Ds),e.p=null}function ks(e){e===Ws&&(Ws=e.l)}function Ms(e){return Ws={p:[],l:Ws,h:e,m:!0,_:0}}function Ds(e){var t=e[ea];0===t.i||1===t.i?t.j():t.g=!0}function Rs(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.O||Ss("ES5").S(t,e,i),i?(n[ea].P&&(Is(t),ps(4)),vs(e)&&(e=js(t,e),t.l||Fs(t,e)),t.u&&Ss("Patches").M(n[ea],e,t.u,t.s)):e=js(t,n,[]),Is(t),t.u&&t.v(t.u,t.s),e!==Zs?e:void 0}function js(e,t,n){if(Ts(t))return t;var i=t[ea];if(!i)return ys(t,(function(o,r){return Gs(e,i,t,o,r,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return Fs(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=4===i.i||5===i.i?i.o=Os(i.k):i.o;ys(3===i.i?new Set(o):o,(function(t,r){return Gs(e,i,o,t,r,n)})),Fs(e,o,!1),n&&e.u&&Ss("Patches").R(i,n,e.u,e.s)}return i.o}function Gs(e,t,n,i,o,r){if(gs(o)){var s=js(e,o,r&&t&&3!==t.i&&!bs(t.D,i)?r.concat(i):void 0);if(_s(n,i,s),!gs(s))return;e.m=!1}if(vs(o)&&!Ts(o)){if(!e.h.F&&e._<1)return;js(e,o),t&&t.A.l||Fs(e,o)}}function Fs(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&xs(t,n)}function Us(e,t){var n=e[ea];return(n?ws(n):e)[t]}function Ls(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function Bs(e){e.P||(e.P=!0,e.l&&Bs(e.l))}function Hs(e){e.o||(e.o=Os(e.t))}function Vs(e,t,n){var i=Es(t)?Ss("MapSet").N(t,n):Cs(t)?Ss("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:Ns(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=i,r=sa;n&&(o=[i],r=aa);var s=Proxy.revocable(o,r),a=s.revoke,c=s.proxy;return i.k=c,i.j=a,c}(t,n):Ss("ES5").J(t,n);return(n?n.A:Ns()).p.push(i),i}function Xs(e){return gs(e)||ps(22,e),function e(t){if(!vs(t))return t;var n,i=t[ea],o=ms(t);if(i){if(!i.P&&(i.i<4||!Ss("ES5").K(i)))return i.t;i.I=!0,n=zs(t,o),i.I=!1}else n=zs(t,o);return ys(n,(function(t,o){i&&function(e,t){return 2===ms(e)?e.get(t):e[t]}(i.t,t)===o||_s(n,t,e(o))})),3===o?new Set(n):n}(e)}function zs(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Os(e)}var Ks,Ws,Ys="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),qs="undefined"!=typeof Map,$s="undefined"!=typeof Set,Js="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Zs=Ys?Symbol.for("immer-nothing"):((Ks={})["immer-nothing"]=!0,Ks),Qs=Ys?Symbol.for("immer-draftable"):"__$immer_draftable",ea=Ys?Symbol.for("immer-state"):"__$immer_state",ta="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",na=""+Object.prototype.constructor,ia="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,oa=Object.getOwnPropertyDescriptors||function(e){var t={};return ia(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},ra={},sa={get:function(e,t){if(t===ea)return e;var n=ws(e);if(!bs(n,t))return function(e,t,n){var i,o=Ls(t,n);return o?"value"in o?o.value:null===(i=o.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!vs(i)?i:i===Us(e.t,t)?(Hs(e),e.o[t]=Vs(e.A.h,i,e)):i},has:function(e,t){return t in ws(e)},ownKeys:function(e){return Reflect.ownKeys(ws(e))},set:function(e,t,n){var i=Ls(ws(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var o=Us(ws(e),t),r=null==o?void 0:o[ea];if(r&&r.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,o)&&(void 0!==n||bs(e.t,t)))return!0;Hs(e),Bs(e)}return e.o[t]===n&&"number"!=typeof n||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Us(e.t,t)||t in e.t?(e.D[t]=!1,Hs(e),Bs(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=ws(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){ps(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){ps(12)}},aa={};ys(sa,(function(e,t){aa[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),aa.deleteProperty=function(e,t){return sa.deleteProperty.call(this,e[0],t)},aa.set=function(e,t,n){return sa.set.call(this,e[0],t,n,e[0])};var ca=function(){function e(e){var t=this;this.O=Js,this.F=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var r=t;return function(e){var t=this;void 0===e&&(e=o);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return r.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&ps(6),void 0!==i&&"function"!=typeof i&&ps(7),vs(e)){var a=Ms(t),c=Vs(t,e,void 0),u=!0;try{s=n(c),u=!1}finally{u?Is(a):ks(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return Ps(a,i),Rs(e,a)}),(function(e){throw Is(a),e})):(Ps(a,i),Rs(s,a))}if(!e||"object"!=typeof e){if((s=n(e))===Zs)return;return void 0===s&&(s=e),t.F&&xs(s,!0),s}ps(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))}:[t.produce(e,n,(function(e,t){i=e,o=t})),i,o];var i,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){vs(e)||ps(8),gs(e)&&(e=Xs(e));var t=Ms(this),n=Vs(this,e,void 0);return n[ea].C=!0,ks(t),n},t.finishDraft=function(e,t){var n=(e&&e[ea]).A;return Ps(n,t),Rs(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Js&&ps(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}var o=Ss("Patches").$;return gs(e)?o(e,t):this.produce(e,(function(e){return o(e,t.slice(n+1))}))},e}(),ua=new ca,da=ua.produce;ua.produceWithPatches.bind(ua);var la=ua.setAutoFreeze.bind(ua);ua.setUseProxies.bind(ua),ua.applyPatches.bind(ua);var ha=ua.createDraft.bind(ua),fa=ua.finishDraft.bind(ua);!function(){function e(e,t){function n(){this.constructor=e}o(e,t),e.prototype=(n.prototype=t.prototype,new n)}function t(e){e.o||(e.D=new Map,e.o=new Map(e.t))}function n(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(vs(t)){var n=Vs(e.A.h,t,e);e.p.set(t,n),e.o.add(n)}else e.o.add(t)})))}function i(e){e.g&&ps(3,JSON.stringify(ws(e)))}var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},r=function(){function n(e,t){return this[ea]={i:2,l:t,A:t?t.A:Ns(),P:!1,I:!1,o:void 0,D:void 0,t:e,k:this,C:!1,g:!1},this}e(n,Map);var o=n.prototype;return Object.defineProperty(o,"size",{get:function(){return ws(this[ea]).size}}),o.has=function(e){return ws(this[ea]).has(e)},o.set=function(e,n){var o=this[ea];return i(o),ws(o).has(e)&&ws(o).get(e)===n||(t(o),Bs(o),o.D.set(e,!0),o.o.set(e,n),o.D.set(e,!0)),this},o.delete=function(e){if(!this.has(e))return!1;var n=this[ea];return i(n),t(n),Bs(n),n.D.set(e,!1),n.o.delete(e),!0},o.clear=function(){var e=this[ea];i(e),ws(e).size&&(t(e),Bs(e),e.D=new Map,ys(e.t,(function(t){e.D.set(t,!1)})),e.o.clear())},o.forEach=function(e,t){var n=this;ws(this[ea]).forEach((function(i,o){e.call(t,n.get(o),o,n)}))},o.get=function(e){var n=this[ea];i(n);var o=ws(n).get(e);if(n.I||!vs(o))return o;if(o!==n.t.get(e))return o;var r=Vs(n.A.h,o,n);return t(n),n.o.set(e,r),r},o.keys=function(){return ws(this[ea]).keys()},o.values=function(){var e,t=this,n=this.keys();return(e={})[ta]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},o.entries=function(){var e,t=this,n=this.keys();return(e={})[ta]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var i=t.get(e.value);return{done:!1,value:[e.value,i]}},e},o[ta]=function(){return this.entries()},n}(),s=function(){function t(e,t){return this[ea]={i:3,l:t,A:t?t.A:Ns(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,g:!1,C:!1},this}e(t,Set);var o=t.prototype;return Object.defineProperty(o,"size",{get:function(){return ws(this[ea]).size}}),o.has=function(e){var t=this[ea];return i(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},o.add=function(e){var t=this[ea];return i(t),this.has(e)||(n(t),Bs(t),t.o.add(e)),this},o.delete=function(e){if(!this.has(e))return!1;var t=this[ea];return i(t),n(t),Bs(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},o.clear=function(){var e=this[ea];i(e),ws(e).size&&(n(e),Bs(e),e.o.clear())},o.values=function(){var e=this[ea];return i(e),n(e),e.o.values()},o.entries=function(){var e=this[ea];return i(e),n(e),e.o.entries()},o.keys=function(){return this.values()},o[ta]=function(){return this.values()},o.forEach=function(e,t){for(var n=this.values(),i=n.next();!i.done;)e.call(t,i.value,i.value,this),i=n.next()},t}();!function(e,t){ra[e]||(ra[e]=t)}("MapSet",{N:function(e,t){return new r(e,t)},T:function(e,t){return new s(e,t)}})}(),la(!1),e.NsModel=void 0,function(e){function t(t){return t!==e.EMPTY_VALUE}e.EMPTY_VALUE=Symbol("EMPTY_MODEL_VALUE"),e.isValidValue=t,e.defaultPipeFunction=function(e){return e.pipe((function(e){return e.lift(new cs(o,r))}),(n=e=>t(e),function(e){return e.lift(new ss(n,i))}),function(e,t,n){return void 0===t&&(t=rs),void 0===n&&(n=ds),function(i){return i.lift(new ls(e,t,n.leading,n.trailing))}}(17,os,{leading:!1,trailing:!0}));var n,i,o,r}}(e.NsModel||(e.NsModel={}));class pa{constructor(t=e.NsModel.EMPTY_VALUE,n=30){this.toDispose=new Ii,this.watch=(t,n=e.NsModel.defaultPipeFunction)=>{this.subject$.observers.length+1>this.maxSubscription&&console.warn(`${this.subject$} reach maxSubscription limitation, please check`);const i=(n?n(this.subject$):this.subject$).subscribe(t);return e.Disposable.create((()=>{i.unsubscribe()}))},this.getValue=()=>this.subject$.getValue(),this.setValue=t=>{if(this.subject$)if("function"!=typeof t)this.subject$.next(t);else{const n=this.subject$.getValue(),i=da(n,(e=>{t(e)}));e.NsModel.isValidValue(i)&&this.setValue(i)}},this.hasValidValue=()=>{const t=this.getValue();return e.NsModel.isValidValue(t)},this.getValidValue=()=>pi(this,void 0,void 0,(function*(){const t=new ki;if(this.hasValidValue())return this.getValue();const n=this.watch((i=>{e.NsModel.isValidValue(i)&&(t.resolve(i),n.dispose())}));return t.promise})),this.dispose=()=>{this.toDispose.dispose()},this.subject$=new es(t||e.NsModel.EMPTY_VALUE),this.maxSubscription=n,this.toDispose.push(e.Disposable.create((()=>{this.subject$.complete(),this.subject$.unsubscribe(),this.subject$=null})))}}const ga=xn.defineToken("IFrontendApplicationContribution"),va=Symbol("IGraphCommandService"),ya=xn.defineToken("ICommandHandler"),ma=Symbol("ICommandContextProvider"),ba=Symbol("IGraphCommandFactory"),_a=xn.defineToken("IGraphCommandContribution");var Ea,Ca,wa;!function(e){e.is=function(e){return!!e&&e===Object(e)&&"id"in e},e.compareCommands=function(e,t){if(e.label&&t.label){const n=(e.category?`${e.category}: ${e.label}`:e.label).toLowerCase(),i=(t.category?`${t.category}: ${t.label}`:t.label).toLowerCase();return n.localeCompare(i)}return 0},e.equals=function(e,t){return e.id===t.id&&e.label===t.label&&e.iconName===t.iconName&&e.category===t.category}}(Ea||(Ea={})),e.GraphCommandRegistry=class{constructor(e){this.contributionProvider=e,this.redoStack=[],this.undoStack=[],this.commands=new Map,this.factories=new Map,this.disposables=new Map,this.cmdChangeEvent=new pa(null),this.Globals=new pa(new Map),this.setGlobal=(e,t)=>{this.Globals.setValue((n=>{n.set(e,t)}))},this.getGlobal=e=>this.Globals.getValue().get(e),this.undoCommand=()=>pi(this,void 0,void 0,(function*(){const e=this.undoStack.pop();e?(yield e.undo(),this.redoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.redoCommand=()=>pi(this,void 0,void 0,(function*(){const e=this.redoStack.pop();e?(yield e.redo(),this.undoStack.push(e),this.cmdChangeEvent.setValue(null)):console.error("empty undo stack")})),this.registerDisposableCommand=e=>{const t=new Ii;return e({registerCommand:(e,n)=>{const i=this.registerCommand(e,n);return t.push(i),i}}),t}}get watchChange(){return this.cmdChangeEvent.watch}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerGraphCommands(this)}executeCommandPipeline(e){return pi(this,void 0,void 0,(function*(){let t=null;for(const n of e){const e=null==t?void 0:t.contextProvider(),{args:i,hooks:o}=yield null==n?void 0:n.getCommandOption(e);t=yield this.executeCommand(null==n?void 0:n.commandId,i,o)}return this.cmdChangeEvent.setValue(null),t}))}executeCommand(e,t,n=[]){return pi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o.isUndoable()&&this.undoStack.push(o),this.cmdChangeEvent.setValue(null),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}executeUndoCommand(e,t,n=[]){return pi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){const o=yield i.createCommand(e,t,n);return yield o.execute(),o}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}createCommand(e,t,n=[]){return pi(this,void 0,void 0,(function*(){const i=this.getFactory(e);if(i){return yield i.createCommand(e,t,n)}throw Object.assign(new Error(`The command '${e}' cannot be executed. There are no active handlers available for the command.`),{code:"NO_ACTIVE_HANDLER"})}))}get isUndoable(){return this.undoStack.length>0}get isRedoable(){return this.redoStack.length>0}hasCommand(e){return this.commands.has(e)}getCommand(e){return this.commands.get(e)}registerCommand(t,n){if(this.factories.has(t.id))return console.warn(`A command ${t.id} is already registered.`),e.Disposable.NULL;const i=new Ii(this.doRegisterCommand(t),this.registerFactory(t.id,n),e.Disposable.create((()=>this.disposables.delete(t.id))));return this.disposables.set(t.id,i),i}doRegisterCommand(t){return this.commands.set(t.id,t),e.Disposable.create((()=>this.disposables.delete(t.id)))}unregisterCommand(e){const t=Ea.is(e)?e.id:e,n=this.disposables.get(t);n&&n.dispose()}hasFactory(e){return!!this.factories.get(e)}getFactory(e){return this.factories.get(e)}registerFactory(t,n,i=!1){return this.hasFactory(t)&&!1===i&&console.error("cannot register command:",t),this.factories.set(t,n),e.Disposable.create((()=>{this.factories.delete(t)}))}getAllFactories(){return Array.from(this.factories.entries())}},e.GraphCommandRegistry=hi([Xn({contrib:[ga,va]}),(Ca=0,wa=ri(_a),function(e,t){wa(e,t,Ca)}),fi("design:paramtypes",[Object])],e.GraphCommandRegistry);const Oa=ii((t=>{oi.register(t,_a),t(e.GraphCommandRegistry)})),xa=xn.defineToken("IModelService"),Aa=xn.defineToken("IModelContribution"),Ta=Symbol("IModelOptionProvider");var Sa;!function(e){e.ASYNC_SRRIES="ASYNC_SRRIES",e.ASYNC_PARALLEL="ASYNC_PARALLEL"}(Sa||(Sa={}));var Na={exports:{}};function Pa(e,t){var n=e.length,i=new Array(n),o={},r=n,s=function(e){for(var t=new Map,n=0,i=e.length;n<i;n++){var o=e[n];t.has(o[0])||t.set(o[0],new Set),t.has(o[1])||t.set(o[1],new Set),t.get(o[0]).add(o[1])}return t}(t),a=function(e){for(var t=new Map,n=0,i=e.length;n<i;n++)t.set(e[n],n);return t}(e);for(t.forEach((function(e){if(!a.has(e[0])||!a.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));r--;)o[r]||c(e[r],r,new Set);return i;function c(e,t,r){if(r.has(e)){var u;try{u=", node was:"+JSON.stringify(e)}catch(e){u=""}throw new Error("Cyclic dependency"+u)}if(!a.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!o[t]){o[t]=!0;var d=s.get(e)||new Set;if(t=(d=Array.from(d)).length){r.add(e);do{var l=d[--t];c(l,a.get(l),r)}while(t);r.delete(e)}i[--n]=e}}}Na.exports=function(e){return Pa(function(e){for(var t=new Set,n=0,i=e.length;n<i;n++){var o=e[n];t.add(o[0]),t.add(o[1])}return Array.from(t)}(e),e)},Na.exports.array=Pa;var Ia,ka,Ma=Na.exports;!function(e){let t;!function(e){e.INVALID_HOOK_BEFORE="INVALID_HOOK_BEFORE",e.INVALID_HOOK_AFTER="INVALID_HOOK_AFTER",e.INVALID_HOOK_ARGS_LENGTH="INVALID_HOOK_ARGS_LENGTH"}(t=e.ErrorEnum||(e.ErrorEnum={}));class n extends Error{constructor(e,t,...i){Array.isArray(t)&&(t=t.filter((function(e){return!!e})).join(" ")),super(`${e}: ${t}`),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.code=e,this.contexts={},i.forEach((e=>{"object"==typeof e&&Object.entries(e).forEach((e=>{const[t,n]=e;"key"!==t&&n&&(this.contexts[t]=JSON.parse(JSON.stringify(n)))}))}))}toString(){return`${this.code}: ${this.message}`}}e.HookError=n;const i=(e,t,...i)=>new n(e,t,...i);e.HookBeforeError=()=>i(t.INVALID_HOOK_BEFORE,["hook require a before dependency but not exist in hookmap"]),e.HookAfterError=()=>i(t.INVALID_HOOK_AFTER,["hook require a after dependency but not exist in hookmap"]),e.InvalidHookArguments=e=>i(t.INVALID_HOOK_ARGS_LENGTH,["hook handlers must have 0 to 2 arguments",`but got ${e.handler.length}`])}(Ia||(Ia={})),function(e){e.normalize=(e=[],t)=>{const n=Array.isArray(e)?e:[e],i=[];return t.forEach((e=>{i.push(e)})),[...i,...n].filter((e=>e&&!!e.handler))},e.sort=(e=[],t)=>{const n=[];e.forEach((e=>{if(e.before){if(!t.has(e.before))throw Ia.HookBeforeError();const i=[t.get(e.before),e];n.push(i)}if(e.after){if(!t.has(e.after))throw Ia.HookBeforeError();const i=[e,t.get(e.after)];n.push(i)}}));const i=Ma(n);return i.reverse(),i}}(ka||(ka={}));class Da{constructor(){this.isResolved=!1,this.isRejected=!1,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.isResolved=!0,e(t)},this.reject=e=>{this.isRejected=!0,t(e)}}))}}var Ra=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class ja{constructor(e){this.scheduleType=Sa.ASYNC_SRRIES,this.hasHook=e=>this.hookMap.has(e),this.getHooks=(e=[],t=!0)=>{const n=ka.normalize(e,this.hookMap);return t?(ka.sort(n,this.hookMap),n):n},this.registerHook=e=>(this.hookMap.has(e.name)&&console.error(`${e.name} is duplicated in hookmap`),this.hookMap.set(e.name,e),{dispose:()=>{this.hookMap.delete(e.name)}}),this.call=(e,t=(e=>Ra(this,void 0,void 0,(function*(){return e}))),n=[])=>Ra(this,void 0,void 0,(function*(){const i=this.getHooks(n);return(0,this.schedulers[this.scheduleType])(e,t,i)})),this.schedulers={[Sa.ASYNC_SRRIES]:(e,t,n=[])=>Ra(this,void 0,void 0,(function*(){let i=t;for(const t of n){if([0,1].includes(t.handler.length)){yield t.handler.call(this,e);continue}if([2].includes(t.handler.length)&&null!==i){const n=yield t.handler.call(this,e,i);if(null===n){i=null;break}if("function"==typeof n){i=n;continue}}throw Ia.InvalidHookArguments(t)}if(i)return yield i.call(this,e)})),[Sa.ASYNC_PARALLEL]:(e,t,n=[])=>Ra(this,void 0,void 0,(function*(){const i=n.map((n=>{if([0,1].includes(n.handler.length))return n.handler.call(this,e);if([2].includes(n.handler.length))return n.handler.call(this,e,t);throw Ia.InvalidHookArguments(n)})),o=new Da;if(Promise.all(i).then((e=>o.resolve(e))),t)return yield t.call(this,o)}))},this.hookMap=new Map,e&&e.type&&(this.scheduleType=e.type)}}const Ga=xn.defineToken("IHookService"),Fa=xn.defineToken("IHookContribution"),Ua=()=>({dispose:()=>{}});var La;!function(e){e.CONFIG_TYPE="XFlowHook"}(La||(La={}));class Ba{constructor(){this.CONFIG_TYPE=La.CONFIG_TYPE,this.time=Date.now(),this.setRegisterHook=e=>{this.hookRegisterFunc=e},this.setRegisterHookhub=e=>{this.hookhubRegisterFn=e},this.getConfig=()=>pi(this,void 0,void 0,(function*(){return{CONFIG_TYPE:this.CONFIG_TYPE,hookRegisterFn:this.hookRegisterFunc||Ua,hookhubRegisterFn:this.hookhubRegisterFn||Ua}})),this.dispose=()=>{}}}let Ha=class{constructor(){this.toDispose=new Ii,this.hookProvider=()=>this.hooks,this.registerHook=e=>e(this.hooks),this.registerHookHub=(e,t)=>(this.hooks[e]=t,{dispose:()=>{delete this.hooks[e]}}),this.onStart=()=>pi(this,void 0,void 0,(function*(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerHookHub(this);for(const t of e)t.registerHook(this.hooks)})),this.hooks={graphOptions:new ja,reactNodeRender:new ja,reactEdgeLabelRender:new ja,afterGraphInit:new ja,beforeGraphDestory:new ja,x6Events:new ja}}onStop(){this.toDispose.dispose()}};var Va;hi([ri(Fa),fi("design:type",Object)],Ha.prototype,"contributionProvider",void 0),Ha=hi([Xn({contrib:[ga,Ga]}),fi("design:paramtypes",[])],Ha),function(e){e.pluginId="GraphEventPlugin"}(Va||(Va={}));let Xa=class{constructor(){this.toDispose=new Ii,this.registerHook=t=>pi(this,void 0,void 0,(function*(){const{hookRegisterFn:n}=yield this.hookConfig.getConfig(),i=n(t);return e.Disposable.create((()=>{i.dispose()}))})),this.registerHookHub=t=>pi(this,void 0,void 0,(function*(){const{hookhubRegisterFn:n}=yield this.hookConfig.getConfig(),i=n(t);return e.Disposable.create((()=>{i.dispose()}))}))}};hi([zn(Ba),fi("design:type",Ba)],Xa.prototype,"hookConfig",void 0),Xa=hi([Xn({contrib:Fa})],Xa);const za={dispose:()=>null};var Ka;!function(e){e.pluginId="GraphEventPlugin"}(Ka||(Ka={}));let Wa=class{constructor(){this.toDispose=new Ii,this.registerHookHub=()=>pi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{}))})),this.registerHook=t=>pi(this,void 0,void 0,(function*(){const n=new Ii,i=[t.x6Events.registerHook({name:Ka.pluginId,handler:e=>pi(this,void 0,void 0,(function*(){const{events:t}=yield this.graphOptions.getOptions();t.forEach((t=>{e.push(t)}))}))}),t.afterGraphInit.registerHook({name:Ka.pluginId,handler:e=>pi(this,void 0,void 0,(function*(){const{commandService:i,modelService:o,graph:r}=e,s=yield t.x6Events.call([],(e=>pi(this,void 0,void 0,(function*(){return e.map((e=>{const t=t=>{e.callback(t,i,o)};return r.on(e.eventName,t),{dispose:()=>{r.off(e.eventName,t)}}}))}))));n.pushAll(s)}))}),t.afterGraphInit.registerHook({name:"add auto resize event",handler:t=>pi(this,void 0,void 0,(function*(){const{commandService:i}=t,o=function(e){let t;return()=>{t||(t=requestAnimationFrame((()=>{t=null,e()})))}}((()=>{i.executeCommand(e.XFlowGraphCommands.GRAPH_RESIZE.id,{})}));window.addEventListener("resize",o),n.push(e.Disposable.create((()=>{window.removeEventListener("resize",o)})))}))}),t.beforeGraphDestory.registerHook({name:Ka.pluginId,handler:()=>pi(this,void 0,void 0,(function*(){n.dispose()}))})];return n.pushAll(i),n}))}};hi([zn(Nr),fi("design:type",Object)],Wa.prototype,"graphOptions",void 0),Wa=hi([Xn({contrib:Fa})],Wa);const Ya=e=>ii((t=>{oi.register(t,Fa),t(Xa),t(Wa),t(Ha),t(Ba,{useValue:e})}));class qa{constructor(){this.extensions=[],this.containerClassNames=new Set,this.addCoreModule=t=>(this.extensions.unshift(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.addExtension=t=>(this.extensions.push(t),e.Disposable.create((()=>{this.removeExtension(t)}))),this.removeExtension=e=>{const t=this.extensions.indexOf(e);t>-1&&this.extensions.splice(t,1)},this.getInstaceId=()=>this.instanceId,this.addContainerClassNames=e=>this.containerClassNames.add(e),this.getContainerClassNames=()=>Array.from(this.containerClassNames),this.getAllExtensions=()=>this.extensions,this.getAllExtensionConfigs=()=>this.extensions.map((e=>e.config)),this.instanceId=Bi()}has(e){return this.extensions.some((t=>t.config.CONFIG_TYPE===e))}}const $a=u.default.createContext({}),Ja=()=>u.default.useContext($a),Za=e=>{const t=Ja(),n=u.default.useMemo((()=>e.config?e.config:new Ba),[]);return u.default.useEffect((()=>{const e=t.addCoreModule({config:n,createModule:Ya});return()=>{e.dispose(),n.dispose()}}),[t,n]),null},Qa=u.default.createContext({cell:null,x6Graph:null,commands:null,modelService:null});function ec(e,t,n){return function(i){const o=this,r=null==i?void 0:i.getData(),s=null==i?void 0:i.getSize(),a=null==i?void 0:i.getPosition();return u.default.createElement((()=>u.default.createElement(Qa.Provider,{value:{cell:i,x6Graph:o,commands:t,modelService:n}},u.default.createElement(e,{cell:i,data:r,size:s,position:a}))),null)}}const tc=Symbol("IGraphProvider"),nc=Symbol("ICommandServiceProvider"),ic=Symbol("IModelServiceProvider");let oc=class{constructor(){this.toDisposce=new Ii,this.graphMap=new Map,this.getGraph=t=>pi(this,void 0,void 0,(function*(){let i=this.graphMap.get(t);if(!i){i=new ki,this.graphMap.set(t,i);const o=yield this.optionProvider.getOptions(),r=this.hookService.hookProvider(),s=yield r.graphOptions.call(o.x6Options),{graphContainer:a,edgeRender:c,nodeRender:u,edgeTypeParser:d}=o,l=yield r.reactEdgeLabelRender.call(c);yield r.reactNodeRender.call(u);const{clientHeight:h,clientWidth:f}=a,p=yield this.commandServiceProvider.getCommandService(),g=yield this.modelServiceProvider.getModelService(),v=new n.Graph(Object.assign(Object.assign({container:a,width:f,height:h},s),{onEdgeLabelRendered:e=>{const{edge:t,container:n}=e;this.renderEdgeReactLabel({edge:t,container:n,edgeRenderMap:l,edgeTypeParser:d,modelService:g,commandService:p})}}));yield r.afterGraphInit.call({graph:v,commandService:p,modelService:g}),i.resolve(v),v.on("node:moved",(({node:e})=>{const t=e.getData(),n=e.position();e.setData(Object.assign(Object.assign({},t),{x:null==n?void 0:n.x,y:null==n?void 0:n.y}))})),v.on("node:resized",(({node:e})=>{const t=e.getData(),n=e.size();e.setData(Object.assign(Object.assign({},t),{width:null==n?void 0:n.width,height:null==n?void 0:n.height}))})),this.toDisposce.push(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){yield r.beforeGraphDestory.call({graph:v,commandService:p,modelService:g}),this.graphMap.delete(t),v.dispose()})))))}return i.promise})),this.renderEdgeReactLabel=e=>pi(this,void 0,void 0,(function*(){const{container:t,edgeTypeParser:n,edge:i,edgeRenderMap:o,commandService:r,modelService:s}=e,a=n(null==i?void 0:i.data)||Gi,c=o.get(a);if(c&&i&&(null==i?void 0:i.data)&&c){const e=this.edgeAppendForeignObject(i,t),n=function(e,t,n){return function(i){const o=this,r=null==i?void 0:i.getData();return u.default.createElement((()=>u.default.createElement(Qa.Provider,{value:{cell:i,x6Graph:o,commands:t,modelService:n}},u.default.createElement(e,{data:r,cell:i}))),null)}}(c,r,s)(i);l.default.render(n,e)}}))}edgeAppendForeignObject(e,t){const i=n.Dom.createSvgElement("foreignObject"),o=n.Dom.createElementNS("body",n.Dom.ns.xhtml),r=n.Dom.createElementNS("div",n.Dom.ns.xhtml),s=null==e?void 0:e.data,a=(null==s?void 0:s.edgeContentWidth)||100,c=(null==s?void 0:s.edgeContentHeigt)||30;return i.setAttribute("width",`${a}`),i.setAttribute("height",`${c}`),i.setAttribute("x",""+-1*a/2),i.setAttribute("y",""+-1*c/2),o.setAttribute("xhtmls",n.Dom.ns.xhtml),o.style.width="100%",o.style.height="100%",o.style.padding="0",o.style.margin="0",o.style.background="unset",o.style.overflow="visible",o.className="xflow-edge-label-body",r.style.width="100%",r.style.height="100%",o.appendChild(r),i.appendChild(o),t.appendChild(i),r}dispose(){this.toDisposce.dispose()}};hi([zn(Nr),fi("design:type",Object)],oc.prototype,"optionProvider",void 0),hi([zn(Ga),fi("design:type",Object)],oc.prototype,"hookService",void 0),hi([zn(nc),fi("design:type",Object)],oc.prototype,"commandServiceProvider",void 0),hi([zn(ic),fi("design:type",Object)],oc.prototype,"modelServiceProvider",void 0),oc=hi([Xn()],oc);var rc;!function(e){e.CONFIG_TYPE="MODEL_SERVICE_CONFIG"}(rc||(rc={}));const sc=()=>e.Disposable.create((()=>{}));class ac{constructor(){this.CONFIG_TYPE=rc.CONFIG_TYPE,this.registerModelFn=sc,this.isMounted=new ki,this.registerModel=e=>{this.registerModelFn=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>pi(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,modelRegisterFunc:this.registerModelFn||sc}})),this.dispose=()=>{this.registerModelFn=sc,this.isMounted=new ki}}}let cc=class{constructor(){this.toDispose=new Ii,this.deferredModelMap=new Map,this.registerModel=t=>{const{id:n,getInitialValue:i,modelFactory:o}=t,r=new Ii,s=this.ensureModel(n);if(s.isResolved)return void console.error(t,"model has been registerd");const a=i?i():e.NsModel.EMPTY_VALUE,c=o?o():new pa(a);return e.NsModel.isValidValue(a)&&s.resolve(c),t.watchChange&&t.watchChange(c,this).then((e=>{s.isResolved||s.resolve(c),this.toDispose.pushAll([e,r]),r.push(e)})),r},this.findDeferredModel=e=>this.deferredModelMap.get(e),this.awaitModel=e=>this.ensureModel(e).promise,this.registerRuntimeModel=()=>pi(this,void 0,void 0,(function*(){const{modelRegisterFunc:e}=yield this.modelOptionProvider.getOption(),t=yield this.graphProvider.getGraphInstance();e&&e(this,t)})),this.ensureModel=t=>{const n=this.deferredModelMap.get(t);if(n)return n;const i=new ki;return this.deferredModelMap.set(t,i),this.toDispose.push(e.Disposable.create((()=>this.deferredModelMap.delete(t)))),i}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerModel(this);this.registerRuntimeModel()}onStop(){this.toDispose.dispose()}};hi([ri(Aa),fi("design:type",Object)],cc.prototype,"contributionProvider",void 0),hi([zn(Ta),fi("design:type",Object)],cc.prototype,"modelOptionProvider",void 0),hi([zn(tc),fi("design:type",Object)],cc.prototype,"graphProvider",void 0),cc=hi([Xn({contrib:[ga,xa]})],cc);const uc=e=>t=>pi(void 0,void 0,void 0,(function*(){return yield t.awaitModel(e)})),dc=e=>t=>pi(void 0,void 0,void 0,(function*(){return(yield t.awaitModel(e)).getValidValue()}));var lc,hc,fc,pc,gc,vc,yc,mc,bc,_c,Ec,Cc,wc,Oc,xc,Ac,Tc,Sc,Nc,Pc;!function(e){e.id="GRAPH_ENABLE_MULTI_SELECT",e.getModel=uc(e.id),e.useValue=dc(e.id)}(lc||(lc={})),function(e){e.id="IS_NODE_SELECTED",e.getModel=uc(e.id),e.useValue=dc(e.id)}(hc||(hc={})),function(e){e.id="IS_GROUP_SELECTED",e.getModel=uc(e.id),e.useValue=dc(e.id)}(fc||(fc={})),function(e){e.id="IS_NORMAL_NODES_SELECTED",e.getModel=uc(e.id),e.useValue=dc(e.id)}(pc||(pc={})),function(e){e.id="LAST_SELECTED_CELL",e.getModel=uc(e.id),e.useValue=dc(e.id)}(gc||(gc={})),function(e){e.id="SELECTED_CELLS",e.getModel=uc(e.id),e.useValue=dc(e.id)}(vc||(vc={})),function(e){e.id="LAST_SELECTED_NODE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(yc||(yc={})),function(e){e.id="SELECTED_NODES",e.getModel=uc(e.id),e.useValue=dc(e.id)}(mc||(mc={})),function(e){e.id="SELECTED_EDGES",e.getModel=uc(e.id),e.useValue=dc(e.id)}(bc||(bc={})),function(e){e.id="SELECTED_GROUPS",e.getModel=uc(e.id),e.useValue=dc(e.id)}(_c||(_c={})),function(e){e.id="CONTEXTMENU_NODE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Ec||(Ec={})),function(e){e.id="CONTEXTMENU_EDGE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Cc||(Cc={})),function(e){e.id="CONTEXTMENU_TARGET",e.getModel=uc(e.id),e.useValue=dc(e.id)}(wc||(wc={})),function(e){e.id="GRAPH_META",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Oc||(Oc={})),function(e){e.id="GRAPH_SCALE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(xc||(xc={})),function(e){e.id="COMMAND_REDOABLE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Ac||(Ac={})),function(e){e.id="COMMAND_UNDOABLE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Tc||(Tc={})),function(e){e.id="COMMAND_GLOBALS",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Sc||(Sc={})),function(e){e.id="HISTORY_UNDOABLE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Nc||(Nc={})),function(e){e.id="HISTORY_REDOABLE",e.getModel=uc(e.id),e.useValue=dc(e.id)}(Pc||(Pc={}));var Ic=Object.freeze({__proto__:null,isModelExistUtil:e=>t=>{const n=t.findDeferredModel(e);return!(!n||!n.promise)},getModelUtil:uc,useModelValueUtil:dc,get GRAPH_ENABLE_MULTI_SELECT(){return lc},get IS_NODE_SELECTED(){return hc},get IS_GROUP_SELECTED(){return fc},get IS_NORMAL_NODES_SELECTED(){return pc},get SELECTED_CELL(){return gc},get SELECTED_CELLS(){return vc},get SELECTED_NODE(){return yc},get SELECTED_NODES(){return mc},get SELECTED_EDGES(){return bc},get SELECTED_GROUPS(){return _c},get CONTEXTMENU_NODE(){return Ec},get CONTEXTMENU_EDGE(){return Cc},get CONTEXTMENU_TARGET(){return wc},get GRAPH_META(){return Oc},get GRAPH_SCALE(){return xc},get COMMAND_REDOABLE(){return Ac},get COMMAND_UNDOABLE(){return Tc},get COMMAND_GLOBALS(){return Sc},get HISTORY_UNDOABLE(){return Nc},get HISTORY_REDOABLE(){return Pc}});let kc=class{registerModel(e){e.registerModel({id:Ac.id,getInitialValue:()=>this.commands.isRedoable,watchChange:e=>pi(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isRedoable)}))}))}),e.registerModel({id:Tc.id,getInitialValue:()=>this.commands.isUndoable,watchChange:e=>pi(this,void 0,void 0,(function*(){return this.commands.watchChange((()=>{e.setValue(this.commands.isUndoable)}))}))}),e.registerModel({id:Sc.id,modelFactory:()=>this.commands.Globals})}};hi([zn(va),fi("design:type",Object)],kc.prototype,"commands",void 0),kc=hi([Xn({contrib:Aa})],kc);const Mc=(t,n,i)=>(t.on(n,i),e.Disposable.create((()=>{t.off(n,i)})));let Dc=class{constructor(){this.getGraphInstance=()=>pi(this,void 0,void 0,(function*(){return{graph:yield this.graphProvider.getGraphInstance(),config:yield this.graphProvider.getGraphOptions()}}))}registerModel(t){t.registerModel({id:Oc.id,getInitialValue:()=>({flowId:"-1"}),watchChange:t=>pi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({flowId:"-1"})}))}))}),t.registerModel({id:lc.id,getInitialValue:()=>({isEnable:!1}),watchChange:t=>pi(this,void 0,void 0,(function*(){return e.Disposable.create((()=>{t.setValue({isEnable:!1})}))}))}),t.registerModel({id:vc.id,getInitialValue:()=>[],watchChange:t=>pi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=e=>{const{selected:n}=e;t.setValue(n)};return n.on("selection:changed",i),e.Disposable.create((()=>n.off("selection:changed",i)))}))}),t.registerModel({id:gc.id,watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield vc.getModel(t)).watch(((t=[])=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:mc.id,getInitialValue:()=>[],watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield vc.getModel(t)).watch(((t=[])=>{const n=t.filter((e=>e.isNode()));e.setValue(n)}))}))}),t.registerModel({id:yc.id,watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield mc.getModel(t)).watch((t=>{e.setValue([...t].pop()||null)}))}))}),t.registerModel({id:hc.id,watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield mc.getModel(t)).watch((t=>{e.setValue(t.length>0)}))}))}),t.registerModel({id:fc.id,getInitialValue:()=>!1,watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield vc.getModel(t)).watch((t=>{const n=t.every((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:_c.id,getInitialValue:()=>[],watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield mc.getModel(t)).watch((t=>{const n=t.filter((e=>e&&!0===e.getProp("isGroup")));e.setValue(n)}))}))}),t.registerModel({id:pc.id,getInitialValue:()=>!1,watchChange:(e,t)=>pi(this,void 0,void 0,(function*(){return(yield vc.getModel(t)).watch((t=>{const n=t.every((e=>{const t=!(e&&e.getProp("isGroup")),n=!(e&&e.getProp("group"));return t&&n})),i=t.length>0&&n;e.setValue(i)}))}))}),t.registerModel({id:xc.id,getInitialValue:()=>({zoomFactor:-1}),watchChange:t=>pi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=e=>{const i=n.zoom();t.setValue(Object.assign(Object.assign({},e),{zoomFactor:i}))};return n.on("scale",i),e.Disposable.create((()=>n.off("scale",i)))}))}),t.registerModel({id:wc.id,watchChange:e=>pi(this,void 0,void 0,(function*(){const{graph:t,config:n}=yield this.getGraphInstance(),i=i=>o=>{const{x:r,y:s}=o,a=t.localToClient({x:r,y:s}),c=n.rootContainer.getBoundingClientRect(),u={x:a.x-((null==c?void 0:c.x)||0),y:a.y-((null==c?void 0:c.y)||0)};e.setValue({type:i,anchor:u,data:o,cell:o.cell})},o=new Ii;return o.pushAll([Mc(t,"node:contextmenu",i("node")),Mc(t,"edge:contextmenu",i("edge")),Mc(t,"blank:contextmenu",i("blank"))]),o}))}),t.registerModel({id:Pc.id,getInitialValue:()=>!1,watchChange:t=>pi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const e=n.history.canRedo();t.setValue(e)};return n.history&&n.history.on("change",i),e.Disposable.create((()=>n.history.off("change",i)))}))}),t.registerModel({id:Nc.id,getInitialValue:()=>!1,watchChange:t=>pi(this,void 0,void 0,(function*(){const{graph:n}=yield this.getGraphInstance(),i=()=>{const e=n.history.canUndo();t.setValue(e)};return n.history&&n.history.on("change",i),e.Disposable.create((()=>n.history.off("change",i)))}))})}};hi([zn(tc),fi("design:type",Object)],Dc.prototype,"graphProvider",void 0),Dc=hi([Xn({contrib:Aa})],Dc);const Rc=ii((e=>{oi.register(e,Aa),e(cc),e(Dc),e(kc)})),jc=e=>ii((t=>{((e,t)=>{e({token:Ta,useDynamic:()=>({getOption:()=>pi(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:xn.Lifecycle.singleton})})(t,e)})),Gc=e=>{const{config:t}=e,n=Ja(),i=u.default.useMemo((()=>t||new ac),[]);return u.default.useEffect((()=>{const e=n.addCoreModule({config:i,createModule:jc});return i.setMountState(),()=>{e.dispose(),i.dispose()}}),[]),null};Gc.defaultProps={XFlowModuleType:"ModelServiceConfig"};const Fc=e=>{const t=[],n=[],i=e=>{e.isNode()&&t.push((e=>{const t=e.getChildren(),n=e.getSize(),i=e.getData()||{},o=e.getPosition(),r=e.getParentId(),{isCollapsed:s}=i,a=i.groupCollapsedSize||(s?n:null);return Object.assign(Object.assign({},i),{id:e.id,width:n.width,height:n.height,x:o.x,y:o.y,group:r,groupChildren:t?t.map((e=>e.id)):null,groupCollapsedSize:a})})(e)),e.isEdge()&&n.push((e=>{const t=e.getData()||{};return Object.assign({id:e.id},t)})(e))};return e.map((e=>i(e))),{nodes:t,edges:n}};e.IApplication=class{constructor(){this.getGraphData=()=>pi(this,void 0,void 0,(function*(){const e=(yield this.graphProvider.getGraphInstance()).getCells();return Fc(e)}))}start(){return pi(this,void 0,void 0,(function*(){yield this.startContributions(),this.registerEventListeners()}))}getGraphInstance(){return this.graphProvider.getGraphInstance()}getGraphConfig(){return this.graphProvider.getGraphOptions()}getAllNodes(){return pi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getNodes()}))}getNodeById(e){return pi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}getAllEdges(){return pi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getEdges()}))}getEdgeById(e){return pi(this,void 0,void 0,(function*(){return(yield this.graphProvider.getGraphInstance()).getCellById(e)}))}updateNodeAttrs(e,t){return pi(this,void 0,void 0,(function*(){if(e instanceof n.Node)e.setAttrs(t);else{(yield this.getNodeById(e)).setAttrs(t)}}))}updateEdgeAttrs(e,t){return pi(this,void 0,void 0,(function*(){if(e instanceof n.Edge)e.setAttrs(t);else{(yield this.getEdgeById(e)).setAttrs(t)}}))}translateGraph(e,t){return pi(this,void 0,void 0,(function*(){const n=yield this.graphProvider.getGraphInstance(),i=n.translate();n.translate(i.tx+e,i.ty+t)}))}executeCommand(e,t,n=[]){return this.commandService.executeCommand(e,t,n)}executeCommandPipeline(e){return this.commandService.executeCommandPipeline(e)}registerEventListeners(){window.addEventListener("unload",(()=>{this.stopContributions()}))}startContributions(){return pi(this,void 0,void 0,(function*(){console.log(this.contributions.getContributions());for(const e of this.contributions.getContributions())if(e.onStart)try{yield this.measure(`${e.constructor.name}.onStart`,(()=>e.onStart(this)))}catch(e){console.error("Could not start contribution",e)}}))}stopContributions(){console.info(">>> Stopping frontend contributions...");for(const e of this.contributions.getContributions())if(e.onStop)try{e.onStop(this)}catch(e){console.error("Could not stop contribution",e)}console.info("<<< All frontend contributions have been stopped.")}measure(e,t){return pi(this,void 0,void 0,(function*(){const n=`${e}-start`,i=`${e}-end`;performance.mark(n);const o=yield t();performance.mark(i),performance.measure(e,n,i);for(const t of performance.getEntriesByName(e)){const e=`Frontend ${t.name}`;t.duration>100?console.warn(`${e} is slow, took: ${t.duration.toFixed(1)} ms`):console.debug(`${e} took: ${t.duration.toFixed(1)} ms`)}return performance.clearMeasures(e),o}))}},hi([ri(ga),fi("design:type",Object)],e.IApplication.prototype,"contributions",void 0),hi([zn(tc),fi("design:type",Object)],e.IApplication.prototype,"graphProvider",void 0),hi([zn(va),fi("design:type",Object)],e.IApplication.prototype,"commandService",void 0),hi([zn(xa),fi("design:type",Object)],e.IApplication.prototype,"modelService",void 0),e.IApplication=hi([Xn()],e.IApplication);const Uc=ii((t=>{oi.register(t,ga),t(e.IApplication)})),Lc=u.default.createContext({configProvider:null}),Bc=e=>{const t=u.default.useContext(Lc);return u.default.useMemo((()=>t.configProvider?t.configProvider.getXflowPrefixCls(e):`xflow-${e}`),[e])};const Hc=(e={})=>t.useMemo((()=>{const t=Object.entries(e),n=t.length>0?{position:"absolute"}:{};return t.forEach((([e,t=0])=>{n[e]=`${t}px`})),n}),[e]),Vc=e=>ii((t=>{(e=>{e(oc),e(tc,{lifecycle:xn.Lifecycle.singleton,useDynamic:e=>({getGraphInstance:()=>pi(void 0,void 0,void 0,(function*(){const t=e.container.get(oc),n=e.container.get(Nr),i=yield null==n?void 0:n.getOptions();return yield null==t?void 0:t.getGraph(i.graphId)})),getGraphOptions:()=>pi(void 0,void 0,void 0,(function*(){const t=e.container.get(Nr);return null==t?void 0:t.getOptions()}))})}),e(nc,{lifecycle:xn.Lifecycle.singleton,useDynamic:e=>({getCommandService:()=>pi(void 0,void 0,void 0,(function*(){return e.container.get(va)}))})}),e(ic,{lifecycle:xn.Lifecycle.singleton,useDynamic:e=>({getModelService:()=>pi(void 0,void 0,void 0,(function*(){return e.container.get(xa)}))})})})(t),((e,t)=>{e(Nr,{lifecycle:xn.Lifecycle.singleton,useDynamic:()=>({getOptions:()=>pi(void 0,void 0,void 0,(function*(){return t.getConfig()}))})})})(t,e)})),Xc=e=>{const t=mr(),n=u.default.useRef(null),i=u.default.useRef(null),r=Ja(),s=u.default.useMemo((()=>{const t=e.config?e.config:new Sr;return t.setX6Config(),t}),[]),[a,c]=o.usePortal(s.graphId);u.default.useEffect((()=>{t&&t.getGraphInstance().then((e=>{c(e)}))}),[t,c]),u.default.useEffect((()=>{s.setRootContainer(n.current),s.setGraphContainer(i.current),s.xflowInstanceId=r.getInstaceId(),r.addCoreModule({config:s,createModule:Vc});return()=>{pi(void 0,void 0,void 0,(function*(){s.dispose()}))}}),[]);const d=Hc(e.position),l=Bc("canvas-root"),h=Bc("x6-canvas");return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{ref:n,className:l,style:d,id:s.graphId,tabIndex:0},u.default.createElement("div",{ref:i,className:h}),e.children),u.default.createElement(a,null))};Xc.defaultProps={isXFlowCanvas:!0};let zc=class{constructor(){this.toDispose=new Ii,this.runtimeHooks=[],this.getX6Graph=()=>pi(this,void 0,void 0,(function*(){if(this.graph)return this.graph;const e=yield this.graphProvider.getGraphInstance();return this.graph=e,e})),this.getGraphConfig=()=>pi(this,void 0,void 0,(function*(){return this.graphProvider.getGraphOptions()})),this.getGraphMeta=()=>pi(this,void 0,void 0,(function*(){const e=this.getModelService();return this.graphMeta||(yield Oc.useValue(e))})),this.setArgs=(e,t=[])=>(this.args=e,this.runtimeHooks=t,{args:e,hooks:t}),this.getArgs=()=>({args:Object.assign(Object.assign({},this.args),{graphMeta:this.graphMeta,modelService:this.getModelService(),commandService:this.getCommands(),getX6Graph:this.getX6Graph,getGraphConfig:this.getGraphConfig}),hooks:this.runtimeHooks}),this.setResult=e=>(this.result=e,this.result),this.getResult=()=>this.result,this.getHooks=()=>this.hookService.hookProvider(),this.getCommands=()=>this.commandService,this.getModelService=()=>this.modelService,this.addUndo=e=>{if(!Array.isArray(e))return this.addUndo([e]);this.toDispose.pushAll(e)},this.undo=()=>pi(this,void 0,void 0,(function*(){yield this.toDispose.dispose()})),this.isUndoable=()=>!this.toDispose.disposed,this.getDisposables=()=>this.toDispose,this.setGlobal=(e,t)=>{this.commandService.setGlobal(e,t)},this.getGlobal=e=>this.commandService.getGlobal(e)}init(){this.getGraphMeta().then((e=>{this.graphMeta=e}))}};hi([zn(tc),fi("design:type",Object)],zc.prototype,"graphProvider",void 0),hi([zn(Ga),fi("design:type",Object)],zc.prototype,"hookService",void 0),hi([zn(va),fi("design:type",Object)],zc.prototype,"commandService",void 0),hi([zn(xa),fi("design:type",Object)],zc.prototype,"modelService",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],zc.prototype,"init",null),zc=hi([Vn()],zc);const Kc=()=>[];class Wc{constructor(){this.setCommandContributions=e=>{this.getContributions=e},this.getCommandContributions=()=>this.getContributions(),this.registerHook=e=>pi(this,void 0,void 0,(function*(){return this.registerHookFn?this.registerHookFn(e):za})),this.registerHookHub=e=>pi(this,void 0,void 0,(function*(){return this.registerHookHubFn?this.registerHookHubFn(e):za})),this.CONFIG_TYPE="CommandConfig",this.setRegisterHookFn=e=>{this.registerHookFn=e},this.setRegisterHookHubFn=e=>{this.registerHookHubFn=e},this.getConfig=()=>pi(this,void 0,void 0,(function*(){return{registerHookFn:this.registerHookFn,getContributions:this.getContributions,CONFIG_TYPE:this.CONFIG_TYPE}})),this.getContributions=Kc}}var Yc;!function(t){t.command=e.XFlowNodeCommands.ADD_NODE,t.hookKey="addNode"}(Yc||(Yc={}));let qc=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addNode.call(n,(n=>pi(this,void 0,void 0,(function*(){const{createNodeService:i,cellFactory:o,commandService:r}=n,s=yield t.getX6Graph(),a=i?yield i(n):n.nodeConfig,c=yield this.processNodeConfig(a);let u;if(o){const e=yield o(c,this);u=s.addNode(e)}else u=s.addNode(c);return t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){const t=Object.assign({id:u.id},u.getData());r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:t})}))))),{nodeConfig:c,nodeCell:u}}))),i);return t.setResult(r),this})),this.processNodeConfig=e=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider();if(e.data=Object.assign({},e),e.shape)return e;if(!e.view){const n=yield t.getGraphConfig();e.view=n.graphId}if(!e.component){const n=yield this.getNodeReactComponent(e),i=t.getCommands(),o=t.getModelService();e.shape="react-shape",e.component=ec(n,i,o)}return e})),this.getNodeReactComponent=e=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),n=t.getHooks(),i=yield t.getGraphConfig(),o=yield n.reactNodeRender.call(i.nodeRender),r=i.nodeTypeParser(e)||Ri,s=o.get(r);return s||console.error("react node component is missing:",i.nodeRender,r,s),s})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var $c;hi([zn(ma),fi("design:type",Object)],qc.prototype,"contextProvider",void 0),qc=hi([Vn({token:{token:ya,named:Yc.command.id}})],qc),function(t){t.command=e.XFlowNodeCommands.DEL_NODE,t.hookKey="delNode",t.createHook=()=>new ja}($c||($c={}));let Jc=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.delNode.call(n,(n=>pi(this,void 0,void 0,(function*(){const{commandService:i,deleteNodeService:o}=n,r=yield t.getX6Graph();if(o){if(!(yield o(n)))return{err:" service rejected"}}const s=(n.x6Node||n.nodeConfig).id,a=r.getCellById(s);if(a&&a.isNode()){const n=[...r.getIncomingEdges(a)||[],...r.getOutgoingEdges(a)||[]];yield Promise.all(n.map((t=>i.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:t}))));const o=a.getData();return a.remove(),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){yield i.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:o})}))))),{err:null,nodeConfig:o}}return{err:"node is not exist"}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){if(this.isUndoable()){this.contextProvider().undo()}return this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Zc;hi([zn(ma),fi("design:type",Object)],Jc.prototype,"contextProvider",void 0),Jc=hi([Vn({token:{token:ya,named:$c.command.id}})],Jc),function(t){t.command=e.XFlowNodeCommands.SELECT_NODE,t.hookKey="selectNode"}(Zc||(Zc={}));let Qc=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.selectNode.call(t,(t=>pi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),i=n.getSelectedCells().map((e=>e.id)),{nodeIds:o,resetSelection:r,commandService:s}=t;return r?n.resetSelection(o):n.select(o),this.ctx.addUndo({dispose:()=>{s.executeUndoCommand(e.XFlowNodeCommands.SELECT_NODE.id,{nodeIds:i,resetSelection:!0})}}),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var eu;hi([zn(ma),fi("design:type",Object)],Qc.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],Qc.prototype,"init",null),Qc=hi([Vn({token:{token:ya,named:Zc.command.id}})],Qc),function(t){t.command=e.XFlowNodeCommands.MOVE_NODE,t.hookKey="moveNode",t.createHook=()=>new ja}(eu||(eu={}));let tu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.moveNode.call(n,(n=>pi(this,void 0,void 0,(function*(){const{nodePositionService:i}=n;if(i){if(!(yield i(n)))return{err:"service rejected"}}const{dx:o=0,dy:r=0,x:s,y:a,duration:c=150}=n.position,u=(yield t.getX6Graph()).getCellById(n.id);if(u){let n=s,i=a;const{x:d,y:l}=u.position();let h=()=>{u.position(d,l,{silent:!1})};return o||r?(n=o+d,i=r+l,u.translate(o,r,{transition:{duration:c}}),h=()=>u.translate(-o,-r,{transition:{duration:c}})):u.position(n,i,{silent:!1}),t.addUndo(e.Disposable.create((()=>{h()}))),{err:null,nextX:n,nextY:i}}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var nu;hi([zn(ma),fi("design:type",Object)],tu.prototype,"contextProvider",void 0),tu=hi([Vn({token:{token:ya,named:eu.command.id}})],tu),function(t){t.command=e.XFlowNodeCommands.UPDATE_NODE,t.hookKey="updateNode",t.XFlowNodeSetOptions={overwrite:!0},t.NODE_WIDTH=200,t.NODE_HEIGHT=40}(nu||(nu={}));let iu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.updateNode.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n,options:i=nu.XFlowNodeSetOptions}=e,r=null==t?void 0:t.getCellById(null==n?void 0:n.id);return r.setData(n,i),r.setPosition((null==n?void 0:n.x)||0,(null==n?void 0:n.y)||0),r.setSize((null==n?void 0:n.width)||nu.NODE_WIDTH,(null==n?void 0:n.height)||nu.NODE_HEIGHT),r instanceof o.ReactShape||!r.getAttrByPath("text/text")||r.setAttrByPath("text/text",n.label),n.attrs&&r.setAttrs(n.attrs),{nodeConfig:n,nodeCell:r}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var ou;hi([zn(ma),fi("design:type",Object)],iu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],iu.prototype,"init",null),iu=hi([Vn({token:{token:ya,named:nu.command.id}})],iu),function(t){t.command=e.XFlowNodeCommands.CENTER_NODE,t.hookKey="centerNode"}(ou||(ou={}));let ru=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.centerNode.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{nodeConfig:n}=e,i=null==t?void 0:t.getCellById(null==n?void 0:n.id);return null==t||t.centerCell(i),{x6Node:i}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var su;hi([zn(ma),fi("design:type",Object)],ru.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],ru.prototype,"init",null),ru=hi([Vn({token:{token:ya,named:ou.command.id}})],ru),function(t){t.command=e.XFlowNodeCommands.FRONT_NODE,t.hookKey="frontNode"}(su||(su={}));let au=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.frontNode.call(n,(n=>pi(this,void 0,void 0,(function*(){const i=yield this.ctx.getX6Graph(),{nodeId:o}=n,r=null==i?void 0:i.getCellById(o);return r?(r.toFront(),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){n.commandService.executeCommand(e.XFlowNodeCommands.BACK_NODE.id,{nodeId:o})})))))):console.error(o,"this nodeId is not exist"),{}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var cu;hi([zn(ma),fi("design:type",Object)],au.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],au.prototype,"init",null),au=hi([Vn({token:{token:ya,named:su.command.id}})],au),function(t){t.command=e.XFlowNodeCommands.BACK_NODE,t.hookKey="backNode"}(cu||(cu={}));let uu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.backNode.call(t,(t=>pi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toBack(),this.ctx.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowNodeCommands.FRONT_NODE.id,{nodeId:i})})))))):console.error(i,"this nodeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var du;hi([zn(ma),fi("design:type",Object)],uu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],uu.prototype,"init",null),uu=hi([Vn({token:{token:ya,named:cu.command.id}})],uu),function(t){t.command=e.XFlowNodeCommands.HIGHLIGHT_NODE,t.hookKey="highlightNode"}(du||(du={}));let lu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.highlightNode.call(t,(t=>pi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{nodeId:i,stroke:o,strokeWidth:r}=t,s=null==n?void 0:n.getCellById(i);if(!s)return console.error(i,"this nodeId is not exist"),{err:"this nodeId is not exist"};if(null==s||s.setAttrs({body:{stroke:o||"#7c68fc",strokeWidth:r||2}}),null==t?void 0:t.isHighlightRelatedLines){const{edgeStroke:i,edgeStrokeWidth:o}=t;(null==n?void 0:n.getEdges()).forEach((n=>{const r=null==n?void 0:n.getData();null==t||t.commandService.executeCommand(e.XFlowEdgeCommands.HIGHLIGHT_EDGE.id,{edgeId:null==r?void 0:r.id,strokeColor:i,strokeWidth:o})}))}return{err:null}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};hi([zn(ma),fi("design:type",Object)],lu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],lu.prototype,"init",null),lu=hi([Vn({token:{token:ya,named:du.command.id}})],lu);const hu=[Yc,$c,Zc,eu,nu,ou,su,cu,du];var fu;!function(t){t.command=e.XFlowGraphCommands.LOAD_META,t.hookKey="graphMeta"}(fu||(fu={}));let pu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphMeta.call(e,(e=>pi(this,void 0,void 0,(function*(){var t;const{graphMetaService:n}=e,i=n?yield n(e):{flowId:null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.flowId};return{graphMeta:i,flowId:null==i?void 0:i.flowId}}))),t),o=this.ctx.getModelService();return(yield Oc.getModel(o)).setValue(i.graphMeta),this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var gu;hi([zn(ma),fi("design:type",Object)],pu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],pu.prototype,"init",null),pu=hi([Vn({token:{token:ya,named:fu.command.id}})],pu),function(t){t.command=e.XFlowGraphCommands.SAVE_GRAPH_DATA,t.hookKey="saveGrpahData"}(gu||(gu={}));let vu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const e=this.ctx,t=e.getArgs(),n=e.getHooks();return yield n.saveGrpahData.call(t.args,(t=>pi(this,void 0,void 0,(function*(){const{saveGraphDataService:n,includeAttrs:i}=t,o=yield e.getX6Graph(),r=o.getNodes(),s=o.getEdges(),a={nodes:r.map((e=>{const t=e.getData(),n=e.position(),o=e.size(),r=Object.assign(Object.assign(Object.assign({id:e.id},t),n),o);return i&&(r.attrs=e.getAttrs()),r})),edges:s.map((e=>{const t=e.getData(),n=Object.assign({id:e.id},t);return i&&(n.attrs=e.getAttrs()),n}))},c=yield Oc.useValue(e.getModelService());if(n){const e=yield n(c,a);e&&this.ctx.setResult(e)}return{}}))),t.hooks),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var yu;hi([zn(ma),fi("design:type",Object)],vu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],vu.prototype,"init",null),vu=hi([Vn({token:{token:ya,named:gu.command.id}})],vu),function(t){t.command=e.XFlowGraphCommands.LOAD_DATA,t.hookKey="loadData",t.createHook=()=>new ja}(yu||(yu={}));let mu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.loadData.call(e,(e=>pi(this,void 0,void 0,(function*(){const{loadDataService:t,graphMeta:n}=e;return{graphData:yield t(n)}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var bu;hi([zn(ma),fi("design:type",Object)],mu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],mu.prototype,"init",null),mu=hi([Vn({token:{token:ya,named:yu.command.id}})],mu),function(t){t.command=e.XFlowGraphCommands.GRAPH_LAYOUT,t.hookKey="graphLayout"}(bu||(bu={}));let _u=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphLayout.call(e,(e=>pi(this,void 0,void 0,(function*(){const{layoutType:t,layoutOptions:n,customLayout:i}=e,o=i||(e=>new(r.Registy.getLayoutByName(t))(n).layout(e));return yield o(e.graphData),{graphData:e.graphData}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Eu,Cu;hi([zn(ma),fi("design:type",Object)],_u.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],_u.prototype,"init",null),_u=hi([Vn({token:{token:ya,named:bu.command.id}})],_u),function(e){e.isNodeEqual=function(e,t){return s.isEqual(e,t)},e.isEdgeEqual=function(e,t){return s.isEqual(e,t)}}(Eu||(Eu={})),function(t){t.command=e.XFlowGraphCommands.GRAPH_RENDER,t.hookKey="graphRender"}(Cu||(Cu={}));let wu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphRender.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{graphMeta:n,beforeRender:i,graphData:o,isNodeEqual:r,isEdgeEqual:s,afterRender:a}=e;return i&&i(n),yield this.doLoadGraph(t,o,r,s),a&&a(o,n),{}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this})),this.doLoadGraph=(t,n,i,o)=>pi(this,void 0,void 0,(function*(){(null==t?void 0:t.isFrozen())||null==t||t.freeze();const r=this.ctx.getCommands(),{addNodeConfigs:s,addEdgeConfigs:a,removeNodes:c,removeEdges:u,updateNodes:d,updateEdges:l}=this.graphDataDiff(t,n,i,o);for(const t of s)yield r.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:t},{name:"remove servcie ",handler:e=>pi(this,void 0,void 0,(function*(){delete e.createNodeService}))});yield r.executeCommand(e.XFlowGroupCommands.INIT_GROUP.id,{graphData:{nodes:s,edges:[]}});for(const t of a)yield r.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:t},{name:"remove servcie ",handler:e=>pi(this,void 0,void 0,(function*(){delete e.createEdgeService}))});for(const t of c){const n=null==t?void 0:t.getData();n.isGroup?yield r.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:n}):yield r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:n})}for(const t of u){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{edgeConfig:n})}for(const t of d){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowNodeCommands.UPDATE_NODE.id,{nodeConfig:n})}for(const t of l){const n=null==t?void 0:t.getData();yield r.executeCommand(e.XFlowEdgeCommands.UPDATE_EDGE.id,{edgeConfig:n})}(null==t?void 0:t.isFrozen())&&(null==t||t.unfreeze())}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}graphDataDiff(e,t,n,i){const{nodes:o,edges:r}=t,s=[];o.forEach((t=>{e.getCellById(null==t?void 0:t.id)||s.push(t)}));const a=[],c=[],u=[];e.getNodes().forEach((e=>{const t=o.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let i=!0;n?i=n(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(i=Eu.isNodeEqual(null==e?void 0:e.data,t)),i||e.setData(t),!0===i?a.push(e):c.push(e)}else u.push(e)}));const d=[];r.forEach((t=>{e.getCellById(null==t?void 0:t.id)||d.push(t)}));const l=[],h=[],f=[];return e.getEdges().forEach((e=>{const t=r.find((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)));if(t){let n=!0;i?n=i(null==e?void 0:e.data,t):(null==e?void 0:e.data)&&t&&(n=Eu.isEdgeEqual(null==e?void 0:e.data,t)),n||e.setData(t),!0===n?l.push(e):h.push(e)}else f.push(e)})),{addNodeConfigs:s,addEdgeConfigs:d,retainNodes:a,retainEdges:l,removeNodes:u,removeEdges:f,updateNodes:c,updateEdges:h}}};var Ou;hi([zn(ma),fi("design:type",Object)],wu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],wu.prototype,"init",null),wu=hi([Vn({token:{token:ya,named:Cu.command.id}})],wu),function(t){t.command=e.XFlowGraphCommands.GRAPH_RESIZE,t.hookKey="graphResize"}(Ou||(Ou={}));let xu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield this.ctx.getGraphConfig(),o=i.rootContainer.clientHeight,r=i.rootContainer.clientWidth,s=yield n.graphResize.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{width:n=r,height:i=o}=e;return null==t||t.resize(n,i),{}}))),t);return this.ctx.setResult(s),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Au;hi([zn(ma),fi("design:type",Object)],xu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],xu.prototype,"init",null),xu=hi([Vn({token:{token:ya,named:Ou.command.id}})],xu),function(t){t.command=e.XFlowGraphCommands.GRAPH_ZOOM,t.MAX_SCALE=1.5,t.MIN_SCALE=.05,t.defaultZoomOptions={maxScale:t.MAX_SCALE,minScale:t.MIN_SCALE},t.hookKey="graphZoom"}(Au||(Au={}));let Tu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.graphZoom.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{factor:n,zoomFitPadding:i=12,zoomOptions:o=Au.defaultZoomOptions}=e;return"number"==typeof n?null==t||t.zoom(n,o||{}):"fit"===n?null==t||t.zoomToFit(Object.assign(Object.assign({},o),{padding:i})):"real"===n&&(null==t||t.scale(1),null==t||t.centerContent()),{factor:n,zoomFitPadding:i,zoomOptions:o}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Su;hi([zn(ma),fi("design:type",Object)],Tu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],Tu.prototype,"init",null),Tu=hi([Vn({token:{token:ya,named:Au.command.id}})],Tu),function(t){t.command=e.XFlowGraphCommands.GRAPH_COPY,t.hookKey="graphCopySelection"}(Su||(Su={}));let Nu=class{constructor(){this.parseCells=e=>{e.forEach((t=>{const n=t.getData();if(t.isNode()&&n.isGroup){t.getChildren().forEach((t=>{e.push(t)}))}}));const t=e.filter((e=>e.isNode())).map((e=>e.id)),n=e.reduce(((e,n)=>{if(n.isEdge()){const i=n.getSourceCellId(),o=n.getTargetCellId();i&&o&&t.includes(i)&&t.includes(o)&&e.set(n.id,n)}else e.set(n.id,n);return e}),new Map),i=Array.from(n.values());return Fc(i)},this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.graphCopySelection.call(n,(()=>pi(this,void 0,void 0,(function*(){const n=(yield t.getX6Graph()).getSelectedCells(),i=this.parseCells(n),o=window.localStorage.getItem(Fi);return window.localStorage.setItem(Fi,JSON.stringify(i)),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){window.localStorage.setItem(Fi,o)}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};hi([zn(ma),fi("design:type",Object)],Nu.prototype,"contextProvider",void 0),Nu=hi([Vn({token:{token:ya,named:Su.command.id}})],Nu);let Pu=class{constructor(){this.groupNodeMap=new Map,this.nodeMap=new Map,this.nodeMappingRecord=new Map,this.portMap=new Map,this.portMappingRecord=new Map,this.edgeMap=new Map,this.edgeMappingRecord=new Map,this.getNodesByType=e=>e.reduce(((e,t)=>(t.isGroup?e.groupNodes.push(t):e.normalNodes.push(t),e)),{normalNodes:[],groupNodes:[]}),this.getNodePorts=e=>Array.isArray(e.ports)?e.ports:e.ports&&Array.isArray(e.ports.items)?e.ports.items:[],this.addNodes=e=>{e.forEach((e=>{if(e.isGroup)this.groupNodeMap.set(e.id,e);else{const t=this.getNodePorts(e);this.nodeMap.set(e.id,e),t.forEach((e=>{this.portMap.set(e.id,e)}))}}))},this.addEdge=e=>{e.forEach((e=>{this.edgeMap.set(e.id,e)}))},this.buildNodeMapping=(e,t)=>{const n=e.id||e.originId,i=t.id;this.nodeMappingRecord.set(n,i);this.getNodePorts(e).forEach(((e,n)=>{const i=t.ports[n];i&&(this.portMap.set(i.id,i),this.portMappingRecord.set(e.id,i.id))}))},this.createEdgeBetweenNodes=e=>{const{source:t,sourcePortId:n,target:i,targetPortId:o}=e;return Object.assign(Object.assign({},e),{source:this.nodeMappingRecord.get(t),target:this.nodeMappingRecord.get(i),sourcePortId:this.portMappingRecord.get(n),targetPortId:this.portMappingRecord.get(o)})},this.buildGroupRelations=e=>{const{groupChildren:t}=e,n=t.map((e=>this.nodeMappingRecord.get(e)));return Object.assign(Object.assign({},e),{groupChildren:n})}}};var Iu,ku;function Mu(e,t=0){return Math.floor(Math.random()*(e-t)+t)}Pu=hi([Vn()],Pu),function(t){t.command=e.XFlowGraphCommands.GRAPH_PASTE,t.hookKey="graphPasteSelection"}(ku||(ku={}));let Du=Iu=class{constructor(){this.updateNodeCopiedProps=(e,t)=>{let n=Mu(100),i=Mu(100);return e&&(n=t.x-e.x+Mu(30),i=t.y-e.y+Mu(30)),t.x+=n,t.y+=i,t.originId=t.id,delete t.id,t.label=`${t.label}_copied`,t.isCollapsed=!1,t},this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks();if(Iu.doing)return this;Iu.doing=!0;const r=yield o.graphPasteSelection.call(n,(n=>pi(this,void 0,void 0,(function*(){const{commandService:i,position:o}=n,r=function(e,t=null){try{return JSON.parse(e)||t}catch(e){return console.error(e),t}}(window.localStorage.getItem(Fi),{nodes:[],edges:[]}),{nodes:s=[],edges:a=[]}=r,{normalNodes:c,groupNodes:u}=this.mappingHelper.getNodesByType(s);return this.mappingHelper.addNodes(s),yield Promise.all(c.map((t=>pi(this,void 0,void 0,(function*(){const n=(yield i.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{nodeConfig:this.updateNodeCopiedProps(o,t)})).contextProvider().getResult();this.mappingHelper.buildNodeMapping(t,n.nodeConfig)}))))),yield Promise.all(u.map((t=>pi(this,void 0,void 0,(function*(){const n=this.mappingHelper.buildGroupRelations(t);yield i.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:this.updateNodeCopiedProps(o,n)})}))))),yield Promise.all(a.map((t=>{const n=this.mappingHelper.createEdgeBetweenNodes(t);return i.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:n})}))),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){window.localStorage.setItem(Fi,null)}))))),{err:null}}))),i);return t.setResult(r),Iu.doing=!1,this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Ru;Du.doing=!1,hi([zn(ma),fi("design:type",Object)],Du.prototype,"contextProvider",void 0),hi([zn(Pu),fi("design:type",Pu)],Du.prototype,"mappingHelper",void 0),Du=Iu=hi([Vn({token:{token:ya,named:ku.command.id}})],Du),function(t){t.command=e.XFlowGraphCommands.GRAPH_TOGGLE_MULTI_SELECT,t.hookKey="toggleMultiSelect"}(Ru||(Ru={}));let ju=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.toggleMultiSelect.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),n=yield this.ctx.getGraphConfig(),{isEnable:i,modelService:o}=e,r=yield lc.getModel(o),s="boolean"==typeof i?i:!t.isRubberbandEnabled();return s?(t.enableRubberband(),t.scroller&&t.scroller.widget?t.scroller.disablePanning():t.disablePanning(),n.graphContainer.style.cursor="crosshair"):(t.disableRubberband(),t.scroller&&t.scroller.widget?t.scroller.enablePanning():t.enablePanning(),n.graphContainer.style.cursor="grab"),r.setValue({isEnable:s}),{isEnable:s}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Gu;hi([zn(ma),fi("design:type",Object)],ju.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],ju.prototype,"init",null),ju=hi([Vn({token:{token:ya,named:Ru.command.id}})],ju),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_UNDO,t.hookKey="historyUndo"}(Gu||(Gu={}));let Fu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyUndo.call(n,(n=>pi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();return!1===i.isHistoryEnabled()?{err:"history is disabled"}:(i.undo(),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_REDO.id,{})}))))),{err:null})}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Uu;hi([zn(ma),fi("design:type",Object)],Fu.prototype,"contextProvider",void 0),Fu=hi([Vn({token:{token:ya,named:Gu.command.id}})],Fu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_REDO,t.hookKey="historyRedo"}(Uu||(Uu={}));let Lu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyRedo.call(n,(n=>pi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();return!1===i.isHistoryEnabled()?{err:"history is disabled"}:(i.redo(),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_UNDO.id,{})}))))),{err:null})}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Bu;hi([zn(ma),fi("design:type",Object)],Lu.prototype,"contextProvider",void 0),Lu=hi([Vn({token:{token:ya,named:Uu.command.id}})],Lu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE,t.hookKey="historyToggle"}(Bu||(Bu={}));let Hu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.historyToggle.call(n,(n=>pi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph();if(!1===i.isHistoryEnabled())return{err:"history is disabled"};const o=i.isHistoryEnabled(),{enabled:r}=n;return i.toggleHistory(r),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){const{commandService:t}=n;t.executeCommand(e.XFlowGraphCommands.GRAPH_HISTORY_TOGGLE.id,{enabled:o})}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Vu;hi([zn(ma),fi("design:type",Object)],Hu.prototype,"contextProvider",void 0),Hu=hi([Vn({token:{token:ya,named:Bu.command.id}})],Hu),function(t){t.command=e.XFlowGraphCommands.GRAPH_HISTORY_RESET,t.hookKey="historyReset"}(Vu||(Vu={}));let Xu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks(),o=yield i.historyReset.call(t,(()=>pi(this,void 0,void 0,(function*(){return(yield e.getX6Graph()).cleanHistory(),{err:null}}))),n);return e.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var zu;hi([zn(ma),fi("design:type",Object)],Xu.prototype,"contextProvider",void 0),Xu=hi([Vn({token:{token:ya,named:Vu.command.id}})],Xu),function(t){t.command=e.XFlowGraphCommands.GRAPH_ADD_TOOL,t.hookKey="addTool"}(zu||(zu={}));let Ku=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addTool.call(n,(n=>pi(this,void 0,void 0,(function*(){const{cellId:i,toolConfig:o,commandService:r}=n,s=(yield t.getX6Graph()).getCellById(i);return s&&(s.addTools(o.items,o.options),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){Array.isArray(o.items)&&o.items.forEach((t=>{r.executeCommand(e.XFlowGraphCommands.GRAPH_DEL_TOOL.id,{cellId:i,toolname:t})}))})))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var Wu;hi([zn(ma),fi("design:type",Object)],Ku.prototype,"contextProvider",void 0),Ku=hi([Vn({token:{token:ya,named:zu.command.id}})],Ku),function(t){t.command=e.XFlowGraphCommands.GRAPH_DEL_TOOL,t.hookKey="delTool"}(Wu||(Wu={}));let Yu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider(),{args:t,hooks:n}=e.getArgs(),i=e.getHooks(),o=yield i.delTool.call(t,(t=>pi(this,void 0,void 0,(function*(){const{cellId:n,toolName:i,toolConfig:o}=t,r=(yield e.getX6Graph()).getCellById(n);return r&&("*"===i?r.removeTools(o):r.removeTool(i,o)),{err:null}}))),n);return e.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var qu;hi([zn(ma),fi("design:type",Object)],Yu.prototype,"contextProvider",void 0),Yu=hi([Vn({token:{token:ya,named:Wu.command.id}})],Yu),function(t){t.command=e.XFlowGraphCommands.REDO_CMD,t.hookKey="redoCommand"}(qu||(qu={}));let $u=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:i}=t.getArgs(),o=t.getHooks();return yield o.redoCommand.call(n,(()=>pi(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isRedoable&&n.redoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var Ju;hi([zn(ma),fi("design:type",Object)],$u.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],$u.prototype,"init",null),$u=hi([Vn({token:{token:ya,named:qu.command.id}})],$u),function(t){t.command=e.XFlowGraphCommands.UNDO_CMD,t.hookKey="undoCommand"}(Ju||(Ju={}));let Zu=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.ctx,{args:n,hooks:i}=t.getArgs(),o=t.getHooks();return yield o.undoCommand.call(n,(()=>pi(this,void 0,void 0,(function*(){const n=t.getCommands();return n.isUndoable&&n.undoCommand(),this.ctx.addUndo(e.Disposable.create((()=>{n.redoCommand()}))),{}}))),i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};hi([zn(ma),fi("design:type",Object)],Zu.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],Zu.prototype,"init",null),Zu=hi([Vn({token:{token:ya,named:Ju.command.id}})],Zu);const Qu=[fu,gu,yu,Gu,Uu,Vu,Bu,bu,Cu,Ou,qu,Ju,Au,Ru,Su,ku,zu,Wu];var ed;!function(t){t.command=e.XFlowEdgeCommands.ADD_EDGE,t.hookKey="addEdge",t.createEdgeId=e=>`${e.source}:${e.sourcePortId}-${e.target}:${e.targetPortId}`}(ed||(ed={}));let td=class{constructor(){this.processEdgeConfig=(e,t)=>pi(this,void 0,void 0,(function*(){if(!t.id){const{createIdService:n=ed.createEdgeId}=e;t.id=yield n(t)}return t})),this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.addEdge.call(t,(t=>pi(this,void 0,void 0,(function*(){const{cellFactory:n,createEdgeService:i,commandService:o}=t,r=i?yield i(t):t.edgeConfig,s=yield this.ctx.getX6Graph();let a;if(yield this.processEdgeConfig(t,r),n){const e=yield n(r,this);a=s.addEdge(e)}else a=s.addEdge(Object.assign(Object.assign({},r),{label:(null==r?void 0:r.label)||r,data:Object.assign({},r)}));const c=e.Disposable.create((()=>{o.executeCommand(e.XFlowEdgeCommands.DEL_EDGE.id,{x6Edge:a})}));return this.ctx.addUndo(c),{edgeConfig:r,edgeCell:a}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var nd;hi([zn(ma),fi("design:type",Object)],td.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],td.prototype,"init",null),td=hi([Vn({token:{token:ya,named:ed.command.id}})],td),function(t){var n;t.command=e.XFlowEdgeCommands.DEL_EDGE,t.hookKey="delEdge",(n=t.ErrEnum||(t.ErrEnum={})).EDGE_NOT_EXIST="edge is not exist",n.EDGE_INVALID_CELL="this is not a valid cell",n.X6_DELETE_FAILED="x6 throw err when call delete edge",n.SERVICE_REJECT="service reject to delete"}(nd||(nd={}));let id=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.delEdge.call(t,(t=>pi(this,void 0,void 0,(function*(){const{edgeConfig:n,x6Edge:i,deleteEdgeService:o,commandService:r}=t;let s=i;if(!s&&(s=yield this.findEdgeById(n),!s))return console.error(nd.ErrEnum.EDGE_NOT_EXIST,n),{err:nd.ErrEnum.EDGE_NOT_EXIST};if(!(s&&s.isEdge()))return console.error(nd.ErrEnum.EDGE_NOT_EXIST,s),{err:nd.ErrEnum.EDGE_NOT_EXIST};if(o){if(!(yield o(t)))return{err:nd.ErrEnum.SERVICE_REJECT}}try{const t=s.getTargetCell(),n=s.getSourceCell(),i=s.getSourcePortId(),o=s.getTargetPortId(),a=n.id,c=t.id;s.remove();const u=e.Disposable.create((()=>{r.executeCommand(e.XFlowEdgeCommands.ADD_EDGE.id,{edgeConfig:{source:a,target:c,sourcePortId:i,targetPortId:o}})}));return this.ctx.addUndo(u),{err:null,edgeConfig:{source:a,target:c,sourcePortId:i,targetPortId:o},targetCell:t,sourceCell:n,sourcePortId:i,targetPortId:o}}catch(e){return console.error(nd.ErrEnum.X6_DELETE_FAILED,e),{err:nd.ErrEnum.X6_DELETE_FAILED}}}))),n);return this.ctx.setResult(o),this})),this.findEdgeById=e=>pi(this,void 0,void 0,(function*(){return(yield this.ctx.getX6Graph()).getCellById(e.id)})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var od;hi([zn(ma),fi("design:type",Object)],id.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],id.prototype,"init",null),id=hi([Vn({token:{token:ya,named:nd.command.id}})],id),function(t){t.command=e.XFlowEdgeCommands.UPDATE_EDGE,t.hookKey="updateEdge"}(od||(od={}));let rd=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:e,hooks:t}=this.ctx.getArgs(),n=this.ctx.getHooks(),i=yield n.updateEdge.call(e,(e=>pi(this,void 0,void 0,(function*(){const t=yield this.ctx.getX6Graph(),{updateEdgeService:n}=e,i=n?yield n(e):null==e?void 0:e.edgeConfig,o=null==t?void 0:t.getCellById(null==i?void 0:i.id);return null==o||o.setData(i),null==o||o.setLabelAt(0,(null==i?void 0:i.label)||i),i.attrs&&o.setAttrs(i.attrs),{edgeConfig:i,edgeCell:o}}))),t);return this.ctx.setResult(i),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var sd;hi([zn(ma),fi("design:type",Object)],rd.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],rd.prototype,"init",null),rd=hi([Vn({token:{token:ya,named:od.command.id}})],rd),function(t){t.command=e.XFlowEdgeCommands.HIGHLIGHT_EDGE,t.hookKey="highlightEdge"}(sd||(sd={}));let ad=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.highlightEdge.call(t,(t=>pi(this,void 0,void 0,(function*(){var n,i;const o=yield this.ctx.getX6Graph(),{edgeId:r,strokeColor:s,strokeWidth:a}=t,c=o.getEdges(),u=c.find((e=>e.id===r)),d=c.filter((e=>e.id!==r));if(u){const o=u.getAttrs();(null===(n=null==o?void 0:o.line)||void 0===n?void 0:n.stroke)===s&&(null===(i=null==o?void 0:o.line)||void 0===i?void 0:i.strokeWidth)===a||(null==u||u.setAttrs({line:{stroke:s,strokeWidth:a||2}}),d.forEach((e=>{e.setAttrs({line:null==o?void 0:o.line})})),t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:r}))}else console.error(r,"this edgeId is not exist");return{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var cd;hi([zn(ma),fi("design:type",Object)],ad.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],ad.prototype,"init",null),ad=hi([Vn({token:{token:ya,named:sd.command.id}})],ad),function(t){t.command=e.XFlowEdgeCommands.FRONT_EDGE,t.hookKey="frontEdge"}(cd||(cd={}));let ud=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.frontEdge.call(t,(t=>pi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toFront(),this.ctx.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.BACK_EDGE.id,{edgeId:i})})))))):console.error(i,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};var dd;hi([zn(ma),fi("design:type",Object)],ud.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],ud.prototype,"init",null),ud=hi([Vn({token:{token:ya,named:cd.command.id}})],ud),function(t){t.command=e.XFlowEdgeCommands.BACK_EDGE,t.hookKey="frontEdge"}(dd||(dd={}));let ld=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.frontEdge.call(t,(t=>pi(this,void 0,void 0,(function*(){const n=yield this.ctx.getX6Graph(),{edgeId:i}=t,o=null==n?void 0:n.getCellById(i);return o?(o.toBack(),this.ctx.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){t.commandService.executeCommand(e.XFlowEdgeCommands.FRONT_EDGE.id,{edgeId:i})})))))):console.error(i,"this edgeId is not exist"),{}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};hi([zn(ma),fi("design:type",Object)],ld.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],ld.prototype,"init",null),ld=hi([Vn({token:{token:ya,named:dd.command.id}})],ld);const hd=[ed,nd,od,sd,cd,dd];var fd;!function(t){t.command=e.XFlowGroupCommands.ADD_GROUP,t.hookKey="addGroup",t.GROUP_PADDING=12,t.GROUP_HEADER_HEIGHT=40}(fd||(fd={}));let pd=class{constructor(){this.getBBox=(e,t,n)=>{const{groupHeaderHeight:i=fd.GROUP_HEADER_HEIGHT,groupPadding:o=fd.GROUP_PADDING}=t,r=n.getCellsBBox(e.children);return r.moveAndExpand({x:-o,y:-(o+i),width:2*o,height:2*o+i}),r},this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.addGroup.call(n,(n=>pi(this,void 0,void 0,(function*(){const{nodeConfig:i,createService:o,cellFactory:r,commandService:s}=n,a=yield t.getX6Graph(),c=yield s.executeCommand(e.XFlowNodeCommands.ADD_NODE.id,{cellFactory:r,createNodeService:o,nodeConfig:i}),{nodeCell:u}=c.contextProvider().getResult(),{id:d}=u,{groupChildren:l}=i;if(l.length){l.forEach((e=>{const t=a.getCellById(e);t&&(t.setData(Object.assign(Object.assign({},t.getData()),{group:d,isCollapsed:!1})),t.prop("group",d),u.addChild(t),a.unselect(t))}));const e=this.getBBox(u,i,a);u.position(e.x,e.y),u.size(e.width,e.height),u.setZIndex(0),u.prop("isGroup",!0),u.setData(Object.assign(Object.assign({},u.getData()),{width:e.width,height:e.height,groupChildrenSize:{width:e.width,height:e.height},x:e.x,y:e.y,isGroup:!0})),a.select(u)}return i.isCollapsed&&(yield s.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:i.id,isCollapsed:i.isCollapsed})),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){s.executeCommand(e.XFlowGroupCommands.DEL_GROUP.id,{nodeConfig:i})}))))),{nodeConfig:i,nodeCell:u}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var gd;hi([zn(ma),fi("design:type",Object)],pd.prototype,"contextProvider",void 0),pd=hi([Vn({token:{token:ya,named:fd.command.id}})],pd),function(t){t.command=e.XFlowGroupCommands.DEL_GROUP,t.hookKey="delGroup"}(gd||(gd={}));let vd=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.delGroup.call(n,(n=>pi(this,void 0,void 0,(function*(){const i=yield t.getX6Graph(),{nodeConfig:o,commandService:r,deleteService:s}=n,{id:a}=o,c=i.getCellById(a);if(s){if(!(yield s(n)))return{err:"service rejected"}}if(!c)return{err:"target node is not exist"};if(!0!==c.getProp("isGroup"))return{err:"target node is not group"};const{isCollapsed:u}=c.getData();u&&(yield r.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{nodeId:c.id,isCollapsed:!1,collapsedSize:{width:0,height:0}}));const d=c.getChildren();return d&&d.forEach((e=>{c.unembed(e),e.prop("group",""),e.setData(Object.assign(Object.assign({},e.getData()),{group:""}))})),yield r.executeCommand(e.XFlowNodeCommands.DEL_NODE.id,{nodeConfig:o}),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){r.executeCommand(e.XFlowGroupCommands.ADD_GROUP.id,{nodeConfig:o})}))))),{err:null}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var yd;hi([zn(ma),fi("design:type",Object)],vd.prototype,"contextProvider",void 0),vd=hi([Vn({token:{token:ya,named:gd.command.id}})],vd),function(t){t.command=e.XFlowGroupCommands.INIT_GROUP,t.hookKey="initGroup"}(yd||(yd={}));let md=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.initGroup.call(n,(n=>pi(this,void 0,void 0,(function*(){const{graphData:i,commandService:o}=n,r=yield t.getX6Graph(),{nodes:s}=i,a={};return s.forEach((e=>{const{id:t,group:n}=e;n&&(a[n]?a[n].push(t):a[n]=[t])})),Object.keys(a).forEach((t=>pi(this,void 0,void 0,(function*(){const i=r.getCellById(t),s=i.getData(),c=a[t]||[];i.prop("isGroup",!0),i.setData(Object.assign(Object.assign({},s),{isGroup:!0,groupChildren:c})),c.forEach((e=>{const t=r.getCellById(e);i.embed(t)})),i.toBack();const{isCollapsed:u,groupCollapsedSize:d}=s;if(u){const t=n.collapsedSize||d||Ui;yield o.executeCommand(e.XFlowGroupCommands.COLLAPSE_GROUP.id,{collapsedSize:t,isCollapsed:!0,nodeId:i.id})}})))),{}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};var bd;hi([zn(ma),fi("design:type",Object)],md.prototype,"contextProvider",void 0),md=hi([Vn({token:{token:ya,named:yd.command.id}})],md),function(t){t.command=e.XFlowGroupCommands.COLLAPSE_GROUP,t.hookKey="collapseGroup"}(bd||(bd={}));let _d=class{constructor(){this.toggleVisible=(e,t,n)=>{e.forEach((e=>{n.findViewByCell(e).container.style.visibility=t?"visible":"hidden"}))},this.toggleCollapse=(e,t,n)=>{const i=e.getChildren().filter((e=>e.isNode())),o=e.getData(),{isCollapsed:r,gap:s=0}=n;if(r){const t=n.collapsedSize||o.groupCollapsedSize||Ui;e.prop("previousSize",e.size()),e.size(t)}else e.size(e.prop("previousSize"));i&&i.forEach((n=>{const o=e.position(),a=t.getConnectedEdges(n).filter((e=>{const t=e.getSourceNode(),n=e.getTargetNode();return i.includes(t)&&i.includes(n)}));if(r){this.toggleVisible([n,...a],!1,t),n.prop("previousSize",n.size()),n.prop("previousRelativePosition",n.position({relative:!0})),n.position(o.x+s,o.y+s);const i=e.size();n.size({width:i.width-2*s,height:i.height-2*s})}else{this.toggleVisible([n,...a],!0,t);const e=n.prop("previousRelativePosition"),i=n.prop("previousSize");n.position(e.x,e.y,{relative:!0}),n.size(i)}})),e.prop("isCollapsed",r),e.setData(Object.assign(Object.assign({},e.getData()),{isCollapsed:r}))},this.execute=()=>pi(this,void 0,void 0,(function*(){const{args:t,hooks:n}=this.ctx.getArgs(),i=this.ctx.getHooks(),o=yield i.collapseGroup.call(t,(n=>pi(this,void 0,void 0,(function*(){const i=yield this.ctx.getX6Graph(),o=i.getCellById(t.nodeId),{toggleService:r}=n;if(r){if(!(yield r(n)))return{err:"service rejected"}}return o&&(this.toggleCollapse(o,i,t),this.ctx.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){o&&this.toggleCollapse(o,i,Object.assign(t,{isCollapsed:!t.isCollapsed}))})))))),{err:null}}))),n);return this.ctx.setResult(o),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.ctx.isUndoable||(yield this.execute()),this}))}init(){this.ctx=this.contextProvider()}isUndoable(){return this.ctx.isUndoable()}};hi([zn(ma),fi("design:type",Object)],_d.prototype,"contextProvider",void 0),hi([f.postConstruct(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],_d.prototype,"init",null),_d=hi([Vn({token:{token:ya,named:bd.command.id}})],_d);const Ed=[fd,gd,yd,bd];var Cd;!function(t){t.command=e.XFlowModelCommands.UPDATE_MODEL,t.hookKey="updateModel"}(Cd||(Cd={}));let wd=class{constructor(){this.execute=()=>pi(this,void 0,void 0,(function*(){const t=this.contextProvider(),{args:n,hooks:i}=t.getArgs(),o=t.getHooks(),r=yield o.updateModel.call(n,(n=>pi(this,void 0,void 0,(function*(){const{updateModel:i,getModel:o,modelService:r}=n,s=yield o(r),a=s.getValue(),c=ha(a);yield i(c);const u=fa(c);return s.setValue(u),t.addUndo(e.Disposable.create((()=>pi(this,void 0,void 0,(function*(){s.setValue(u)}))))),{model:s,value:u}}))),i);return t.setResult(r),this})),this.undo=()=>pi(this,void 0,void 0,(function*(){const e=this.contextProvider();return this.isUndoable()&&e.undo(),this})),this.redo=()=>pi(this,void 0,void 0,(function*(){return this.isUndoable()||(yield this.execute()),this}))}isUndoable(){return this.contextProvider().isUndoable()}};hi([zn(ma),fi("design:type",Object)],wd.prototype,"contextProvider",void 0),wd=hi([Vn({token:{token:ya,named:Cd.command.id}})],wd);const Od=[...hu,...hd,...Ed,...Qu,...[Cd]],xd=()=>new ja;let Ad=class{constructor(){this.registerHook=t=>pi(this,void 0,void 0,(function*(){const n=t.x6Events.registerHook({name:"bind group node move event",handler:e=>pi(this,void 0,void 0,(function*(){const t={eventName:"node:moving",callback:({node:e})=>pi(this,void 0,void 0,(function*(){if(e.prop("isGroup"))return void e.prop("originPosition",e.getPosition());const t=e.model.graph,{group:n}=e.getData(),i=t.getNodes().find((e=>e.id===n));if(!i)return;const o=i.getProp("isCollapsed");let r=i.getProp("originSize"),s=!1;null==r&&(r=i.size(),i.prop("originSize",r));let a=i.prop("originPosition");null==a&&(a=i.getPosition(),i.prop("originPosition",a));let c=a.x,u=a.y,d=a.x+r.width,l=a.y+r.height;const h=i.getChildren();if(h&&h.forEach((e=>{const t=e.getBBox().inflate(12),n=t.getCorner();t.x<c&&(c=t.x,s=!0),t.y<u&&(u=t.y,s=!0),n.x>d&&(d=n.x,s=!0),n.y>l&&(l=n.y,s=!0)})),s){i.prop({position:{x:c,y:u},size:{width:d-c,height:l-u}});const e=Object.assign(Object.assign({},i.getData()),{x:c,y:u,width:d-c,height:l-u});!0!==o&&(e.groupChildrenSize={width:d-c,height:l-u}),i.setData(e)}}))};e.push(t)}))});return e.Disposable.create((()=>{n.dispose()}))})),this.registerHookHub=e=>pi(this,void 0,void 0,(function*(){const t=new Ii;return Od.forEach((({hookKey:n,createHook:i=xd})=>{const o=e.registerHookHub(n,i());t.push(o)})),this.commandConfig.getConfig().then((({getContributions:n})=>{n().forEach((({hookKey:n,createHook:i=xd})=>{const o=e.registerHookHub(n,i());t.push(o)}))})),t}))}registerGraphCommands(e){Od.forEach((({command:t})=>{e.registerCommand(t,{createCommand:this.commandFactory})})),this.commandConfig.getConfig().then((({getContributions:t})=>{t().forEach((t=>{e.registerCommand(t.command,{createCommand:this.commandFactory})}))}))}};hi([zn(ba),fi("design:type",Function)],Ad.prototype,"commandFactory",void 0),hi([zn(Wc),fi("design:type",Wc)],Ad.prototype,"commandConfig",void 0),Ad=hi([Xn({contrib:[_a,Fa]})],Ad);const Td=(e,t)=>{t.getCommandContributions().forEach((t=>{const{CommandHandler:n,command:i}=t;e({token:{token:ya,named:i.id},useClass:n})})),(e=>{e(pu),e(mu),e(vu),e(_u),e(wu),e(xu),e(Fu),e(Lu),e(Hu),e(Xu),e($u),e(Zu),e(Tu),e(ju),e(Nu),e(Du),e(Ku),e(Yu)})(e),(e=>{e(qc),e(Jc),e(Qc),e(tu),e(iu),e(ru),e(au),e(uu),e(lu)})(e),(e=>{e(td),e(id),e(rd),e(ad),e(ud),e(ld)})(e),(e=>{e(pd),e(vd),e(md),e(_d)})(e),(e=>{e(wd)})(e),e(Ad)},Sd=e=>ii((t=>{t(Pu),((e,t)=>{e({token:Wc,contrib:[Fa],lifecycle:xn.Lifecycle.singleton,useDynamic:()=>t})})(t,e),Td(t,e),t(zc),t(ba,{useFactory:e=>(t,n,i)=>{const o=e.container.createChild(),r=o.get(zc);o.register(ma,{useDynamic:()=>()=>r});const s=o.getNamed(ya,t);return r.setArgs(n,i),r.handlerInstance=s,s}})})),Nd=e=>{const t=Ja(),n=u.default.useMemo((()=>e.config?e.config:new Wc),[]);return u.default.useEffect((()=>{t.addCoreModule({config:n,createModule:Sd})}),[]),null},Pd=Symbol("IToolbarService"),Id=xn.defineToken("IToolbarContribution");var kd=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Md="object"==typeof h&&h&&h.Object===Object&&h,Dd=Md,Rd="object"==typeof self&&self&&self.Object===Object&&self,jd=Dd||Rd||Function("return this")(),Gd=jd,Fd=function(){return Gd.Date.now()},Ud=/\s/;var Ld=function(e){for(var t=e.length;t--&&Ud.test(e.charAt(t)););return t},Bd=/^\s+/;var Hd=function(e){return e?e.slice(0,Ld(e)+1).replace(Bd,""):e},Vd=jd.Symbol,Xd=Vd,zd=Object.prototype,Kd=zd.hasOwnProperty,Wd=zd.toString,Yd=Xd?Xd.toStringTag:void 0;var qd=function(e){var t=Kd.call(e,Yd),n=e[Yd];try{e[Yd]=void 0;var i=!0}catch(e){}var o=Wd.call(e);return i&&(t?e[Yd]=n:delete e[Yd]),o},$d=Object.prototype.toString;var Jd=qd,Zd=function(e){return $d.call(e)},Qd=Vd?Vd.toStringTag:void 0;var el=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Qd&&Qd in Object(e)?Jd(e):Zd(e)};var tl=function(e){return null!=e&&"object"==typeof e},nl=el,il=tl;var ol=Hd,rl=kd,sl=function(e){return"symbol"==typeof e||il(e)&&"[object Symbol]"==nl(e)},al=/^[-+]0x[0-9a-f]+$/i,cl=/^0b[01]+$/i,ul=/^0o[0-7]+$/i,dl=parseInt;var ll=kd,hl=Fd,fl=function(e){if("number"==typeof e)return e;if(sl(e))return NaN;if(rl(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=rl(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ol(e);var n=cl.test(e);return n||ul.test(e)?dl(e.slice(2),n?2:8):al.test(e)?NaN:+e},pl=Math.max,gl=Math.min;var vl=function(e,t,n){var i,o,r,s,a,c,u=0,d=!1,l=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=i,r=o;return i=o=void 0,u=t,s=e.apply(r,n)}function p(e){return u=e,a=setTimeout(v,t),d?f(e):s}function g(e){var n=e-c;return void 0===c||n>=t||n<0||l&&e-u>=r}function v(){var e=hl();if(g(e))return y(e);a=setTimeout(v,function(e){var n=t-(e-c);return l?gl(n,r-(e-u)):n}(e))}function y(e){return a=void 0,h&&i?f(e):(i=o=void 0,s)}function m(){var e=hl(),n=g(e);if(i=arguments,o=this,c=e,n){if(void 0===a)return p(c);if(l)return clearTimeout(a),a=setTimeout(v,t),f(c)}return void 0===a&&(a=setTimeout(v,t)),s}return t=fl(t)||0,ll(n)&&(d=!!n.leading,r=(l="maxWait"in n)?pl(fl(n.maxWait)||0,t):r,h="trailing"in n?!!n.trailing:h),m.cancel=function(){void 0!==a&&clearTimeout(a),u=0,i=c=o=a=void 0},m.flush=function(){return void 0===a?s:y(hl())},m};var yl=function(){this.__data__=[],this.size=0};var ml=function(e,t){return e===t||e!=e&&t!=t},bl=ml;var _l=function(e,t){for(var n=e.length;n--;)if(bl(e[n][0],t))return n;return-1},El=_l,Cl=Array.prototype.splice;var wl=_l;var Ol=_l;var xl=_l;var Al=yl,Tl=function(e){var t=this.__data__,n=El(t,e);return!(n<0)&&(n==t.length-1?t.pop():Cl.call(t,n,1),--this.size,!0)},Sl=function(e){var t=this.__data__,n=wl(t,e);return n<0?void 0:t[n][1]},Nl=function(e){return Ol(this.__data__,e)>-1},Pl=function(e,t){var n=this.__data__,i=xl(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function Il(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Il.prototype.clear=Al,Il.prototype.delete=Tl,Il.prototype.get=Sl,Il.prototype.has=Nl,Il.prototype.set=Pl;var kl=Il,Ml=kl;var Dl=function(){this.__data__=new Ml,this.size=0};var Rl=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var jl=function(e){return this.__data__.get(e)};var Gl=function(e){return this.__data__.has(e)},Fl=el,Ul=kd;var Ll,Bl=function(e){if(!Ul(e))return!1;var t=Fl(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Hl=jd["__core-js_shared__"],Vl=(Ll=/[^.]+$/.exec(Hl&&Hl.keys&&Hl.keys.IE_PROTO||""))?"Symbol(src)_1."+Ll:"";var Xl=function(e){return!!Vl&&Vl in e},zl=Function.prototype.toString;var Kl=function(e){if(null!=e){try{return zl.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Wl=Bl,Yl=Xl,ql=kd,$l=Kl,Jl=/^\[object .+?Constructor\]$/,Zl=Function.prototype,Ql=Object.prototype,eh=Zl.toString,th=Ql.hasOwnProperty,nh=RegExp("^"+eh.call(th).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ih=function(e){return!(!ql(e)||Yl(e))&&(Wl(e)?nh:Jl).test($l(e))},oh=function(e,t){return null==e?void 0:e[t]};var rh=function(e,t){var n=oh(e,t);return ih(n)?n:void 0},sh=rh(jd,"Map"),ah=rh(Object,"create"),ch=ah;var uh=function(){this.__data__=ch?ch(null):{},this.size=0};var dh=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},lh=ah,hh=Object.prototype.hasOwnProperty;var fh=function(e){var t=this.__data__;if(lh){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return hh.call(t,e)?t[e]:void 0},ph=ah,gh=Object.prototype.hasOwnProperty;var vh=ah;var yh=uh,mh=dh,bh=fh,_h=function(e){var t=this.__data__;return ph?void 0!==t[e]:gh.call(t,e)},Eh=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=vh&&void 0===t?"__lodash_hash_undefined__":t,this};function Ch(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Ch.prototype.clear=yh,Ch.prototype.delete=mh,Ch.prototype.get=bh,Ch.prototype.has=_h,Ch.prototype.set=Eh;var wh=Ch,Oh=kl,xh=sh;var Ah=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Th=function(e,t){var n=e.__data__;return Ah(t)?n["string"==typeof t?"string":"hash"]:n.map},Sh=Th;var Nh=Th;var Ph=Th;var Ih=Th;var kh=function(){this.size=0,this.__data__={hash:new wh,map:new(xh||Oh),string:new wh}},Mh=function(e){var t=Sh(this,e).delete(e);return this.size-=t?1:0,t},Dh=function(e){return Nh(this,e).get(e)},Rh=function(e){return Ph(this,e).has(e)},jh=function(e,t){var n=Ih(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function Gh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Gh.prototype.clear=kh,Gh.prototype.delete=Mh,Gh.prototype.get=Dh,Gh.prototype.has=Rh,Gh.prototype.set=jh;var Fh=kl,Uh=sh,Lh=Gh;var Bh=kl,Hh=Dl,Vh=Rl,Xh=jl,zh=Gl,Kh=function(e,t){var n=this.__data__;if(n instanceof Fh){var i=n.__data__;if(!Uh||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Lh(i)}return n.set(e,t),this.size=n.size,this};function Wh(e){var t=this.__data__=new Bh(e);this.size=t.size}Wh.prototype.clear=Hh,Wh.prototype.delete=Vh,Wh.prototype.get=Xh,Wh.prototype.has=zh,Wh.prototype.set=Kh;var Yh=Wh;var qh=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e},$h=rh,Jh=function(){try{var e=$h(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Zh=function(e,t,n){"__proto__"==t&&Jh?Jh(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Qh=Zh,ef=ml,tf=Object.prototype.hasOwnProperty;var nf=function(e,t,n){var i=e[t];tf.call(e,t)&&ef(i,n)&&(void 0!==n||t in e)||Qh(e,t,n)},of=nf,rf=Zh;var sf=function(e,t,n,i){var o=!n;n||(n={});for(var r=-1,s=t.length;++r<s;){var a=t[r],c=i?i(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),o?rf(n,a,c):of(n,a,c)}return n};var af=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i},cf=el,uf=tl;var df=function(e){return uf(e)&&"[object Arguments]"==cf(e)},lf=tl,hf=Object.prototype,ff=hf.hasOwnProperty,pf=hf.propertyIsEnumerable,gf=df(function(){return arguments}())?df:function(e){return lf(e)&&ff.call(e,"callee")&&!pf.call(e,"callee")},vf=gf,yf=Array.isArray,mf={exports:{}};var bf=function(){return!1};!function(e,t){var n=jd,i=bf,o=t&&!t.nodeType&&t,r=o&&e&&!e.nodeType&&e,s=r&&r.exports===o?n.Buffer:void 0,a=(s?s.isBuffer:void 0)||i;e.exports=a}(mf,mf.exports);var _f=/^(?:0|[1-9]\d*)$/;var Ef=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&_f.test(e))&&e>-1&&e%1==0&&e<t};var Cf=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},wf=el,Of=Cf,xf=tl,Af={};Af["[object Float32Array]"]=Af["[object Float64Array]"]=Af["[object Int8Array]"]=Af["[object Int16Array]"]=Af["[object Int32Array]"]=Af["[object Uint8Array]"]=Af["[object Uint8ClampedArray]"]=Af["[object Uint16Array]"]=Af["[object Uint32Array]"]=!0,Af["[object Arguments]"]=Af["[object Array]"]=Af["[object ArrayBuffer]"]=Af["[object Boolean]"]=Af["[object DataView]"]=Af["[object Date]"]=Af["[object Error]"]=Af["[object Function]"]=Af["[object Map]"]=Af["[object Number]"]=Af["[object Object]"]=Af["[object RegExp]"]=Af["[object Set]"]=Af["[object String]"]=Af["[object WeakMap]"]=!1;var Tf=function(e){return xf(e)&&Of(e.length)&&!!Af[wf(e)]};var Sf=function(e){return function(t){return e(t)}},Nf={exports:{}};!function(e,t){var n=Md,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,r=o&&o.exports===i&&n.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||r&&r.binding&&r.binding("util")}catch(e){}}();e.exports=s}(Nf,Nf.exports);var Pf=Tf,If=Sf,kf=Nf.exports,Mf=kf&&kf.isTypedArray,Df=Mf?If(Mf):Pf,Rf=af,jf=vf,Gf=yf,Ff=mf.exports,Uf=Ef,Lf=Df,Bf=Object.prototype.hasOwnProperty;var Hf=function(e,t){var n=Gf(e),i=!n&&jf(e),o=!n&&!i&&Ff(e),r=!n&&!i&&!o&&Lf(e),s=n||i||o||r,a=s?Rf(e.length,String):[],c=a.length;for(var u in e)!t&&!Bf.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Uf(u,c))||a.push(u);return a},Vf=Object.prototype;var Xf=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Vf)};var zf=function(e,t){return function(n){return e(t(n))}},Kf=zf(Object.keys,Object),Wf=Xf,Yf=Kf,qf=Object.prototype.hasOwnProperty;var $f=Bl,Jf=Cf;var Zf=function(e){return null!=e&&Jf(e.length)&&!$f(e)},Qf=Hf,ep=function(e){if(!Wf(e))return Yf(e);var t=[];for(var n in Object(e))qf.call(e,n)&&"constructor"!=n&&t.push(n);return t},tp=Zf;var np=function(e){return tp(e)?Qf(e):ep(e)},ip=sf,op=np;var rp=function(e,t){return e&&ip(t,op(t),e)};var sp=kd,ap=Xf,cp=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},up=Object.prototype.hasOwnProperty;var dp=Hf,lp=function(e){if(!sp(e))return cp(e);var t=ap(e),n=[];for(var i in e)("constructor"!=i||!t&&up.call(e,i))&&n.push(i);return n},hp=Zf;var fp=function(e){return hp(e)?dp(e,!0):lp(e)},pp=sf,gp=fp;var vp=function(e,t){return e&&pp(t,gp(t),e)},yp={exports:{}};!function(e,t){var n=jd,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,r=o&&o.exports===i?n.Buffer:void 0,s=r?r.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,i=s?s(n):new e.constructor(n);return e.copy(i),i}}(yp,yp.exports);var mp=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t};var bp=function(){return[]},_p=function(e,t){for(var n=-1,i=null==e?0:e.length,o=0,r=[];++n<i;){var s=e[n];t(s,n,e)&&(r[o++]=s)}return r},Ep=bp,Cp=Object.prototype.propertyIsEnumerable,wp=Object.getOwnPropertySymbols,Op=wp?function(e){return null==e?[]:(e=Object(e),_p(wp(e),(function(t){return Cp.call(e,t)})))}:Ep,xp=sf,Ap=Op;var Tp=function(e,t){return xp(e,Ap(e),t)};var Sp=function(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e},Np=zf(Object.getPrototypeOf,Object),Pp=Sp,Ip=Np,kp=Op,Mp=bp,Dp=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Pp(t,kp(e)),e=Ip(e);return t}:Mp,Rp=sf,jp=Dp;var Gp=function(e,t){return Rp(e,jp(e),t)},Fp=Sp,Up=yf;var Lp=function(e,t,n){var i=t(e);return Up(e)?i:Fp(i,n(e))},Bp=Lp,Hp=Op,Vp=np;var Xp=function(e){return Bp(e,Vp,Hp)},zp=Lp,Kp=Dp,Wp=fp;var Yp=function(e){return zp(e,Wp,Kp)},qp=rh(jd,"DataView"),$p=sh,Jp=rh(jd,"Promise"),Zp=rh(jd,"Set"),Qp=rh(jd,"WeakMap"),eg=el,tg=Kl,ng="[object Map]",ig="[object Promise]",og="[object Set]",rg="[object WeakMap]",sg="[object DataView]",ag=tg(qp),cg=tg($p),ug=tg(Jp),dg=tg(Zp),lg=tg(Qp),hg=eg;(qp&&hg(new qp(new ArrayBuffer(1)))!=sg||$p&&hg(new $p)!=ng||Jp&&hg(Jp.resolve())!=ig||Zp&&hg(new Zp)!=og||Qp&&hg(new Qp)!=rg)&&(hg=function(e){var t=eg(e),n="[object Object]"==t?e.constructor:void 0,i=n?tg(n):"";if(i)switch(i){case ag:return sg;case cg:return ng;case ug:return ig;case dg:return og;case lg:return rg}return t});var fg=hg,pg=Object.prototype.hasOwnProperty;var gg=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&pg.call(e,"index")&&(n.index=e.index,n.input=e.input),n},vg=jd.Uint8Array;var yg=function(e){var t=new e.constructor(e.byteLength);return new vg(t).set(new vg(e)),t},mg=yg;var bg=function(e,t){var n=t?mg(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},_g=/\w*$/;var Eg=function(e){var t=new e.constructor(e.source,_g.exec(e));return t.lastIndex=e.lastIndex,t},Cg=Vd?Vd.prototype:void 0,wg=Cg?Cg.valueOf:void 0;var Og=yg;var xg=yg,Ag=bg,Tg=Eg,Sg=function(e){return wg?Object(wg.call(e)):{}},Ng=function(e,t){var n=t?Og(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Pg=function(e,t,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return xg(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return Ag(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ng(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return Tg(e);case"[object Symbol]":return Sg(e)}},Ig=kd,kg=Object.create,Mg=function(){function e(){}return function(t){if(!Ig(t))return{};if(kg)return kg(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Dg=Np,Rg=Xf;var jg=function(e){return"function"!=typeof e.constructor||Rg(e)?{}:Mg(Dg(e))},Gg=fg,Fg=tl;var Ug=function(e){return Fg(e)&&"[object Map]"==Gg(e)},Lg=Sf,Bg=Nf.exports,Hg=Bg&&Bg.isMap,Vg=Hg?Lg(Hg):Ug,Xg=fg,zg=tl;var Kg=function(e){return zg(e)&&"[object Set]"==Xg(e)},Wg=Sf,Yg=Nf.exports,qg=Yg&&Yg.isSet,$g=qg?Wg(qg):Kg,Jg=Yh,Zg=qh,Qg=nf,ev=rp,tv=vp,nv=yp.exports,iv=mp,ov=Tp,rv=Gp,sv=Xp,av=Yp,cv=fg,uv=gg,dv=Pg,lv=jg,hv=yf,fv=mf.exports,pv=Vg,gv=kd,vv=$g,yv=np,mv=fp,bv="[object Arguments]",_v="[object Function]",Ev="[object Object]",Cv={};Cv[bv]=Cv["[object Array]"]=Cv["[object ArrayBuffer]"]=Cv["[object DataView]"]=Cv["[object Boolean]"]=Cv["[object Date]"]=Cv["[object Float32Array]"]=Cv["[object Float64Array]"]=Cv["[object Int8Array]"]=Cv["[object Int16Array]"]=Cv["[object Int32Array]"]=Cv["[object Map]"]=Cv["[object Number]"]=Cv[Ev]=Cv["[object RegExp]"]=Cv["[object Set]"]=Cv["[object String]"]=Cv["[object Symbol]"]=Cv["[object Uint8Array]"]=Cv["[object Uint8ClampedArray]"]=Cv["[object Uint16Array]"]=Cv["[object Uint32Array]"]=!0,Cv["[object Error]"]=Cv[_v]=Cv["[object WeakMap]"]=!1;var wv=function e(t,n,i,o,r,s){var a,c=1&n,u=2&n,d=4&n;if(i&&(a=r?i(t,o,r,s):i(t)),void 0!==a)return a;if(!gv(t))return t;var l=hv(t);if(l){if(a=uv(t),!c)return iv(t,a)}else{var h=cv(t),f=h==_v||"[object GeneratorFunction]"==h;if(fv(t))return nv(t,c);if(h==Ev||h==bv||f&&!r){if(a=u||f?{}:lv(t),!c)return u?rv(t,tv(a,t)):ov(t,ev(a,t))}else{if(!Cv[h])return r?t:{};a=dv(t,h,c)}}s||(s=new Jg);var p=s.get(t);if(p)return p;s.set(t,a),vv(t)?t.forEach((function(o){a.add(e(o,n,i,o,t,s))})):pv(t)&&t.forEach((function(o,r){a.set(r,e(o,n,i,r,t,s))}));var g=l?void 0:(d?u?av:sv:u?mv:yv)(t);return Zg(g||t,(function(o,r){g&&(o=t[r=o]),Qg(a,r,e(o,n,i,r,t,s))})),a},Ov=wv;var xv=function(e){return Ov(e,5)},Av=el,Tv=tl;var Sv=function(e){return!0===e||!1===e||Tv(e)&&"[object Boolean]"==Av(e)};let Nv=class{constructor(){this.toDispose=new Ii,this.toolbarItems=new Map,this.onDidChangeEvent=new pa(null),this.onDidChange=this.onDidChangeEvent.watch,this.fireOnDidChange=vl((()=>this.onDidChangeEvent.setValue(void 0)),16),this.registerDisposableToolbar=e=>{const t=new Ii,n={registerToolbarItem:e=>{const n=this.registerItem(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t},this.getToolbarModel=e=>{const{layout:t,mainGroups:n=[],extraGroups:i=[]}=e;return new pa({layout:t,mainGroups:this.createToolbarGroupModel(n),extraGroups:this.createToolbarGroupModel(i)})},this.createToolbarGroupModel=e=>{const t=e.map((e=>{const{items:t=[]}=e;return Object.assign(Object.assign({},e),{items:t.map((e=>this.createToolbarModel({id:e.id}))).filter((e=>!!e))})}));return t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerToolbarItems(this)}onStop(){this.toDispose.dispose()}registerItem(t){this.toolbarItems.has(t.id)&&console.warn(`ToolbarRegistry ${t.id} is duplicated, in`,t),this.toolbarItems.set(t.id,t),this.fireOnDidChange();return new Ii(e.Disposable.create((()=>this.fireOnDidChange())),e.Disposable.create((()=>this.toolbarItems.delete(t.id))))}createToolbarModel(e){const t=xv(this.toolbarItems.get(e.id)),n=!Sv(t.isEnabled)||t.isEnabled,i=!Sv(t.isVisible)||t.isVisible;return Object.assign(Object.assign({},t),{isEnabled:n,isVisible:i,iconName:t.iconName,text:t.text})}};hi([zn(va),fi("design:type",Object)],Nv.prototype,"commandService",void 0),hi([zn(xa),fi("design:type",Object)],Nv.prototype,"modelService",void 0),hi([ri(Id),fi("design:type",Object)],Nv.prototype,"contributionProvider",void 0),Nv=hi([Xn({contrib:[ga,Pd]})],Nv);const Pv=()=>ii((e=>{oi.register(e,Id),e(Nv)})),Iv=e=>{const t=Ja();return u.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"ToolbarRegistry",getConfig:()=>pi(void 0,void 0,void 0,(function*(){}))},createModule:Pv});return()=>{e.dispose()}}),[t]),null};Iv.defaultProps={XFlowModuleType:"ToolbarRegistry"};const kv=Symbol("IMenuService"),Mv=xn.defineToken("IMenuContribution");var Dv;e.MenuItemType=void 0,(Dv=e.MenuItemType||(e.MenuItemType={})).Separator="separator",Dv.Submenu="submenu",Dv.Root="root",Dv.Leaf="leaf";let Rv=class{constructor(){this.toDispose=new Ii,this.menuMap=new Map,this.getMenu=e=>this.menuMap.get(e),this.registerDisposableMenu=e=>{const t=new Ii,n={registerMenu:e=>{const n=this.registerMenu(e);return t.push(n),n}};return e(n),this.toDispose.push(t),t}}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerMenu(this)}onStop(){this.toDispose.dispose()}registerMenu(t){return this.menuMap.set(t.id,t),e.Disposable.create((()=>this.menuMap.delete(t.id)))}};hi([ri(Mv),fi("design:type",Object)],Rv.prototype,"contributionProvider",void 0),Rv=hi([Xn({contrib:[ga,kv]})],Rv);const jv=()=>ii((e=>{oi.register(e,Mv),e(Rv)})),Gv=e=>{const t=Ja();return u.default.useEffect((()=>{const e=t.addCoreModule({config:{CONFIG_TYPE:"MenuRegistry",getConfig:()=>pi(void 0,void 0,void 0,(function*(){}))},createModule:jv});return()=>{e.dispose()}}),[]),null};Gv.defaultProps={XFlowModuleType:"MenuRegistry"};const Fv=t=>{const{meta:n,graphConfig:i,graphData:o,graphLayout:r,onLoad:s,isAutoCenter:a,hookConfig:c,modelServiceConfig:d,commandConfig:l,onAppConfigReady:h,onAppDestroy:f,children:p=[],className:g}=t,[v,y]=u.default.useState(),m=u.default.useMemo((()=>new qa),[]);u.default.useEffect((()=>{h&&h(m);const t=(t=>{const n=t.getAllExtensions(),i=new qn,o=n.map((e=>{const{createModule:t,config:n}=e;return t(n)}));return i.load(Uc),i.load(Oa),i.load(Rc),o.forEach((e=>{i.load(e)})),i.get(e.IApplication)})(m);t.start().then((()=>pi(void 0,void 0,void 0,(function*(){y(t),n&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})),s&&s(t,m),o&&(r&&(yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:o},r))),yield t.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:o}))}))));return()=>{pi(void 0,void 0,void 0,(function*(){f&&f(t)}))}}),[]),u.default.useEffect((()=>{v&&v.commandService.executeCommand(e.XFlowGraphCommands.LOAD_META.id,{meta:n})}),[n]),u.default.useEffect((()=>{pi(void 0,void 0,void 0,(function*(){v&&(o&&r&&(yield v.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_LAYOUT.id,Object.assign({graphData:o},r))),yield v.commandService.executeCommand(e.XFlowGraphCommands.GRAPH_RENDER.id,{graphData:o}),a)&&(yield v.getGraphInstance()).centerContent()}))}),[o]);const b=bi("xflow-app-workspace",g,...m.getContainerClassNames()),_=(Array.isArray(p)?p:[p]).some((e=>e&&e.props.isXFlowCanvas));return u.default.createElement(_r,{app:v},u.default.createElement($a.Provider,{value:m},u.default.createElement("div",{className:b,id:m.getInstaceId()},!_&&u.default.createElement(Xc,{config:i,position:{top:0,bottom:0,left:0,right:0}}),p,u.default.createElement(Gc,{config:d}),u.default.createElement(Nd,{config:l}),u.default.createElement(Za,{config:c}),u.default.createElement(Iv,null),u.default.createElement(Gv,null))))};Fv.defaultProps={};const Uv=()=>{const e=u.default.useRef({isMounted:!0});return u.default.useEffect((()=>()=>{e.current.isMounted=!1}),[]),e},Lv=t=>{const n=Uv(),[i,o]=u.default.useState(t.getValue());u.default.useEffect((()=>{const e=t.watch((e=>{(e=>e&&e.current&&e.current.isMounted)(n)&&o(e)}));return()=>{e.dispose()}}),[o]);const r=i,s=e.NsModel.isValidValue(r);return[r,u.default.useCallback((e=>t.setValue(e)),[t]),s]},Bv=Symbol("IKeyBindingService"),Hv=xn.defineToken("IKeyBindingContribution"),Vv=Symbol("IKeyBindingOptionProvider");let Xv=class{constructor(){this.toDispose=new Ii,this.keyBindingMap=new Map,this.enabledKeyBindingMap=new Map,this.registerExternalKeybindings=()=>pi(this,void 0,void 0,(function*(){const{registerKeybindingFunc:e}=yield this.optionProvider.getOption();return e(this)})),this.registerKeybinding=(t=[])=>{const n=new Ii;return t.forEach((t=>{this.keyBindingMap.set(t.id,t),this.enableKeyBindings(t.id).then((i=>{n.push(e.Disposable.create((()=>{i.dispose(),this.keyBindingMap.delete(t.id)})))}))})),this.toDispose.push(n),n},this.enableKeyBindings=t=>pi(this,void 0,void 0,(function*(){this.disableKeyBindings([t]);const n=this.keyBindingMap.get(t),i=yield this.getX6Graph(),o=this.runCommand(n);i.bindKey(n.keybinding,o);const r=e.Disposable.create((()=>{i.unbindKey(n.keybinding),this.enabledKeyBindingMap.delete(n.id)}));return this.enabledKeyBindingMap.set(n.id,r),r})),this.disableKeyBindings=e=>{e.forEach((e=>{const t=this.enabledKeyBindingMap.get(e);t&&t.dispose()}))},this.runCommand=e=>t=>pi(this,void 0,void 0,(function*(){yield e.callback(e,this.modelService,this.commandService,t)})),this.getX6Graph=()=>pi(this,void 0,void 0,(function*(){return yield this.graphProvider.getGraphInstance()}))}onStart(){const e=this.contributionProvider.getContributions();for(const t of e)t.registerKeybinding(this);this.registerExternalKeybindings()}onStop(){this.toDispose.dispose()}};hi([zn(Vv),fi("design:type",Object)],Xv.prototype,"optionProvider",void 0),hi([zn(va),fi("design:type",Object)],Xv.prototype,"commandService",void 0),hi([zn(xa),fi("design:type",Object)],Xv.prototype,"modelService",void 0),hi([ri(Hv),fi("design:type",Object)],Xv.prototype,"contributionProvider",void 0),hi([zn(tc),fi("design:type",Object)],Xv.prototype,"graphProvider",void 0),Xv=hi([Xn({contrib:[ga,Bv]})],Xv);const zv=e=>ii((t=>{((e,t)=>{e(Vv,{useDynamic:()=>({getOption:()=>pi(void 0,void 0,void 0,(function*(){return t.getConfig()}))}),lifecycle:xn.Lifecycle.singleton})})(t,e),oi.register(t,Hv),t(Xv)}));var Kv;!function(e){e.CONFIG_TYPE="CONTEXT_CONFIG"}(Kv||(Kv={}));const Wv=()=>e.Disposable.create((()=>{}));class Yv{constructor(){this.CONFIG_TYPE=Kv.CONFIG_TYPE,this.keybindingFunc=Wv,this.isMounted=new ki,this.setKeybindingFunc=e=>{this.keybindingFunc=e},this.setMountState=()=>{this.isMounted.resolve(!0)},this.getConfig=()=>pi(this,void 0,void 0,(function*(){return yield this.isMounted.promise,{CONFIG_TYPE:this.CONFIG_TYPE,registerKeybindingFunc:this.keybindingFunc}})),this.dispose=()=>{this.keybindingFunc=Wv,this.isMounted=new ki}}}const qv=new class{constructor(){this.map=new Map([["default",fr],["QuestionCircleOutlined",fr]]),this.map.set("default",fr),this.map.set("QuestionCircleOutlined",fr)}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t)}has(e){return this.map.has(e)}};e.AppContext=Qa,e.Deferred=ki,e.DisposableCollection=Ii,e.ExtensionRegistryContext=$a,e.IApplicationContribution=ga,e.ICommandContextProvider=ma,e.ICommandHandler=ya,e.IGraphCommandContribution=_a,e.IGraphCommandFactory=ba,e.IGraphCommandService=va,e.IGraphProvider=tc,e.IHookContribution=Fa,e.IHookService=Ga,e.IKeyBindingContribution=Hv,e.IMenuContribution=Mv,e.IMenuService=kv,e.IModelContribution=Aa,e.IModelService=xa,e.IToolbarContribution=Id,e.IToolbarService=Pd,e.IconStore=qv,e.KeyBindings=e=>{const{config:t}=e,n=Ja(),i=u.default.useMemo((()=>t||new Yv),[t]);return u.default.useEffect((()=>{const e=n.addCoreModule({config:i,createModule:zv});return i.setMountState(),()=>{e.dispose(),i.dispose()}}),[n,i]),null},e.KeybindingConfig=Yv,e.MODELS=Ic,e.ManaSyringe=ui,e.MenuRegistry=Gv,e.RxModel=pa,e.ToolbarRegistry=Iv,e.XFlow=Fv,e.XFlowAppContext=yr,e.XFlowAppExtensionMoudle=function(e){const{createModule:t,children:n}=e,i=Ja(),o=u.default.useMemo((()=>e.config||{CONFIG_TYPE:"",getConfig:()=>pi(this,void 0,void 0,(function*(){return{}}))}),[]);return u.default.useEffect((()=>{const e=i.addExtension({config:o,createModule:t});return()=>{e.dispose()}}),[]),Array.isArray(n)||u.default.isValidElement(n)?u.default.createElement(u.default.Fragment,null," ",n," "):null},e.XFlowAppProvider=Er,e.XFlowCanvas=Xc,e.XFlowConfigProviderContext=Lc,e.XFlowConstants=Li,e.commandRegistryModule=Oa,e.createCmdConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Wc;return e(t,n),t}),[n]);return i},e.createComponentModel=e=>{const t=u.default.useMemo((()=>new pa(e)),[]),[n,i,o]=Lv(t);return u.default.useEffect((()=>()=>{t.dispose()}),[t]),[n,i,t,o]},e.createGraphConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Sr;return e(t,n),t}),[n]);return i},e.createHookConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Ba;return e(t,n),t}),[n]);return i},e.createKeybindingConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new Yv;return e(t,n),t}),[n]);return i},e.createModelServiceConfig=e=>t=>{const n=u.default.useMemo((()=>({getValue:()=>({})})),[]);n.getValue=()=>t;const i=u.default.useMemo((()=>{const t=new ac;return e(t,n),t}),[n]);return i},e.delay=function(e){return new Promise((t=>setTimeout((()=>t(!0)),e)))},e.getNodeReactComponent=ec,e.insertCss=e=>{const t=document.createElement("style");return t.setAttribute("type","text/css"),document.head.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),t},e.useAppContext=()=>u.default.useContext(Qa),e.useExtensionRegistry=Ja,e.useIsMountedRef=Uv,e.useModel=Lv,e.useModelAsync=e=>{const{getModel:t,initialState:n}=e,i=Uv(),o=u.default.useRef(),[r,s]=u.default.useState(n);return u.default.useEffect((()=>{let e;return t().then((t=>pi(void 0,void 0,void 0,(function*(){o.current=t;const n=yield t.getValidValue();i.current.isMounted&&(s(n),e=t.watch((e=>{i.current.isMounted&&s(e)})))})))),()=>{e&&e.dispose&&e.dispose()}}),[]),[r,s,o.current]},e.usePositionStyle=Hc,e.useXFlowApp=mr,e.useXflowPrefixCls=Bc,e.uuidv4=Bi,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
